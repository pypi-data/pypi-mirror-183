0010        NAM  BATS  
0020        DEF  RUNTIM
0030        DEF  TOKS  
0040 PARSE  DEF  PARSE 
0050        DEF  ERMSG 
0060        DEF  INIT  
0070 RUNTIM BSZ  2
0080        DEF  BATS. 
0090        DEF  .   
0100 RUN    DEF  DELAY 
0110        DEF  MOVE  
0120        DEF  DROP-B
0130        DEF  GOSUB 
0140        DEF  RETURN
0150        DEF  CREATE
0160        DEF  GOTO  
0170        DEF  START 
0180        DEF  WAIT  
0190        DEF  ERASE 
0200 PARSES BYT  377,377
0210 TOKS   ASP  "BATS"
0220        ASP  ""
0230 ERMSG  BYT  377
0240 INIT   BIN  
0250        LDBD R34,=ROMFL 
0260        DCB  R34
0270        JZR  SCRAT!
0275        RTN  
0280 TAKHOK LDMD R34,=BINTAB
0290        LDM  R36,=KEYSER
0300        ADMD R36,=BINTAB
0310        STM  R36,R45
0320        CLM  R36
0330        STMD R36,X34,BUFPTR
0340        LDB  R47,=236
0350        LDB  R44,=316
0360 STO    STMD R#,=KYIDLE
0370        RTN  
0400 SCRAT! LDM  R45,=236,236,236
0410        JMP  STO   
0480 ! ************************
0490        BYT  0,56
0500 .    LDM  R44,=16,0
0510        DEF  DATE  
0520        ADMD R46,=BINTAB
0530        PUMD R44,+R12
0540        RTN  
0550 DATE   ASC  "MAY   26, 1981"
0560 ! ************************
0570 ONEB   DAD  56113
0580 SOUNDF BSZ  1
0590        BYT  40,55
0600 BATS.  LDMD R14,=BINTAB
0610        JSB  =ONEB  
0620        STBD R46,X14,TOUGHF
0630        JSB  =ONEB  
0640        STBD R46,X14,SOUNDF
0645        JSB  X14,TAKHOK
0650        LDMD R20,=TOS   
0660        STMD R20,X14,SAVTOS
0670        LDMD R20,=CRTBYT
0680        STMD R20,X14,SAVCRT
0690        STMD R12,=TOS   
0700        JSB  =GCLR. 
0710        LDM  R65,=0,20C,0
0720        STMD R65,=XAPRIM
0730        CLM  R40
0740        LDM  R30,=SHOT1 
0750        ADM  R30,R14
0760        LDB  R32,=30
0770 LOOP0  PUMD R40,+R30
0780        DCB  R32
0790        JNZ  LOOP0 
0800        JSB  X14,FRAME 
0810        LDM  R20,=INPBUF
0820        STMD R20,X14,BUFPTR
0830        LDB  R75,=3
0840        STBD R75,X14,SHIPCO
0850 PUTSHI JSB  X14,ADDSHI
0860        DCB  R75
0870        JNZ  PUTSHI
0880        CLM  R46
0890 PUTLO  DCM  R46
0900        DCM  R46
0910        JNZ  PUTLO 
0920        JSB  X14,KEY&& 
0930        CLM  R46
0940 PUTHI  DCM  R46
0950        DCM  R46
0960        JNZ  PUTHI 
0970        LDM  R24,=PATLST
0980        ADM  R24,R14
0990        LDB  R72,=7
1000 PATLOP POMD R26,+R24
1010        CLM  R32
1020        LDB  R32,R72
1030        DCM  R32
1040        LLM  R32
1050        LLM  R32
1060        ADM  R32,R14
1070        LDBD R40,X14,TOUGHF
1080        JZR  PPPPPP
1090        DCB  R40
1100        STBD R40,X14,TOUGHF
1110        LDM  R26,=HIDDEN
1120 PPPPPP ADM  R26,R14
1130        STM  R26,R56
1140        STMD R54,X32,BRDPTR
1150        DCB  R72
1160        JNZ  PATLOP
1170        JSB  X14,BRDMOV
1180 ! ************************
1190 ! * R20-1 = KEY BUFFER PT
1200 ! ************************
1210 EXEC   JSB  X14,SHOTMO
1220        JSB  X14,BOMBMO
1230        JSB  X14,SHOTMO
1240        JSB  X14,KEYS? 
1250        JEN  OVER  
1260        JSB  X14,BRDMOV
1270        JSB  X14,SHOTMO
1280        JSB  X14,BOMBMO
1290        JSB  X14,SHOTMO
1300        JSB  X14,KEYS? 
1310        JEZ  EXEC  
1320 OVER   LDMD R45,X14,SCORE 
1330        LDB  R44,=377
1340        PUMD R40,+R12
1350        JSB  =EOJ2  
1360 NOEOJ  CLM  R30
1370        STMD R30,X14,BUFPTR
1380        LDMD R30,X14,SAVTOS
1390        STMD R30,=TOS   
1400        LDMD R30,X14,SAVCRT
1410        STMD R30,=CRTBYT
1415        JSB  X14,SCRAT!
1420        RTN  
1430 ! ************************
1440 ! * AT ENTRY:             
1450 ! *   R34-5=CRT ADDRESS   
1460 ! *   R56-7=OBJECT ADDRESS
1470 ! *             (RELATIVE)
1480 ! ************************
1490 OUT8   BSZ  0
1500        ADM  R56,R14
1510        LDB  R40,=10
1520 WAIT1+ DRP  R30
1530 WAIT1  LDBD R#,=CRTSTS
1540        JNG  WAIT1 
1550        STMD R34,=CRTBAD
1560        POBD R73,+R56
1570        DRP  R30
1580 WAIT2  LDBD R#,=CRTSTS
1590        JNG  WAIT2 
1600        STBD R73,=CRTDAT
1610        ADM  R34,=100,0
1620        DCB  R40
1630        JNZ  WAIT1+
1640        RTN  
1650 ! ***********************
1660 ! * KEYBOARD INTERRUPT   
1670 ! *   SERVICE ROUTINE    
1680 ! ***********************
1690 KEYSER STBD R32,=GINTDS
1700        BIN  
1710        PUMD R40,+R6
1720        LDM  R40,R30
1730        LDMD R30,=BINTAB
1740        LDMD R34,X30,BUFPTR
1750        JZR  RTNKEY
1760        CMM  R34,=INPEND
1770        JZR  RTNKEY
1780        LDBD R32,=KEYCOD
1790        CMB  R32,=200
1800        JNC  RTNEKY
1810        CMB  R32,=216
1820        JNZ  NOTPAU
1830        PUBD R32,+R34
1840        STMD R34,X30,BUFPTR
1850        JMP  RTNKEY
1860 NOTPAU CMB  R#,=226
1870        JZR  TAKIT 
1880        CMB  R32,=204
1890        JCY  RTNEKY
1900 TAKIT  PUBD R32,+R34
1910        STMD R34,X30,BUFPTR
1920 RTNEKY LDB  R32,=1
1930        STBD R32,=KEYCOD
1940        STM  R40,R30
1950        POMD R40,-R6
1960        SBM  R6,=4,0
1970 TAKIT2 STBD R#,=GINTEN
1980        PAD  
1990        RTN  
2000 RTNKEY STM  R40,R30
2010        POMD R40,-R6
2020        RTN  
2030 ! ***********************
2040 ! * SOFTKEY HANDLING     
2050 ! ***********************
2060 KEYS?  CLE  
2070        LDB  R70,=3
2080        LDMD R20,X14,BUFPTR
2090 KEYLOP CMM  R20,=INPBUF
2100        JZR  KEYDON
2110        LDM  R30,=INPBUF
2120        STM  R30,R34
2130        POBD R32,+R30
2140 LOOP1  POBD R33,+R30
2150        PUBD R33,+R34
2160        CMM  R30,R20
2170        JNC  LOOP1 
2180        DCM  R20
2190        STMD R20,X14,BUFPTR
2200        CMB  R32,=200
2210        JNZ  ?201  
2220        CLB  R32
2230        DCB  R32
2240 MOVCOM STBD R#,X14,DIRFLG
2250        JMP  KEYCOM
2260 ?201   CMB  R#,=201
2270        JNZ  ?202  
2280        CLB  R#
2290        ICB  R#
2300        JMP  MOVCOM
2310 ?202   CMB  R#,=202
2320        JNZ  ?203  
2330        JSB  X14,WARP  
2340        JMP  KEYCOM
2350 ?203   CMB  R#,=203
2360        JNZ  ?226+ 
2370        JSB  X14,FIRE  
2380 KEYCOM DCB  R70
2390        JZR  KEYDON
2400        JEZ  KEYLOP
2410 KEYDON LDMD R32,X14,MYLOC 
2420        JNZ  KEYDO 
2430        LDBD R46,X14,MOVFLG
2440        JZR  KEY&&+
2450 &&RTN  RTN  
2460 KEY&&+ JSB  X14,KEY&&-
2470        JNZ  &&RTN 
2480 KEY&&  LDBD R75,X14,SHIPCO
2490        JNZ  NOTOVR
2500        CLE  
2510        ICE  
2520        RTN  
2530 ?226+  JMP  ?226  
2540 KEYCO+ JMP  KEYCOM
2550 NOTOVR CMB  R#,=7
2560        JCY  NOSUB 
2570        JSB  X14,SUBSHI
2580 NOSUB  DCB  R75
2590        STBD R75,X14,SHIPCO
2600        CLB  R75
2610        STBD R75,X14,WARPFL
2620        LDM  R34,=MYSTRT
2630        LDM  R56,=SHIP  
2640        JSB  X14,OUT8  
2650        SBM  R34,=0,2
2660        STMD R34,X14,MYLOC 
2670        LDB  R53,=7
2680        LDM  R56,=BRDPTR
2690        ADM  R56,R14
2700 KLOOP  LDMD R64,R56
2710        LDM  R66,R64
2720        PUMD R64,+R56
2730        DCB  R53
2740        JNZ  KLOOP 
2750        LDM  R56,=WARASC
2760        LDM  R34,=44,76
2770        LDB  R46,=4
2780 KEYL2  JSB  X14,OUT8  
2790        SBM  R56,R14
2800        SBM  R34,=376,1
2810        DCB  R46
2820        JNZ  KEYL2 
2830 KEYDO  LDBD R32,X14,DIRFLG
2840        JZR  DONE  
2850        JNG  LEFSHI
2860        JSB  X14,RITSHI
2870        RTN  
2880 ?226   CMB  R#,=226
2890        JNZ  PAUSE!
2900        CLB  R#
2910        STBD R#,X14,DIRFLG
2920 JMP123 JMP  KEYCO+
2930 PAUSE! ICE  
2940        STBD R#,=KEYHIT
2950 DONE!  RTN  
2960 DONE   LDBD R#,X#,WARPFL
2970        DCB  R#
2980        JNG  DONE! 
2990        LDMD R34,X14,MYLOC 
3000        LDM  R56,=BLANKS
3010        JSB  X14,OUT8  
3020        LDMD R46,X14,MYLOC 
3030        JMP  OUTSHI
3040 LEFSHI LDMD R34,X14,MYLOC 
3050        LDM  R56,=BLANKS
3060        JSB  X14,OUT8  
3070        LDMD R46,X14,MYLOC 
3080        STM  R46,R56
3090        ANM  R56,=77,0
3100        CMB  R56,=3
3110        JZR  OUTSHI
3120        CMB  R56,=25
3130        JCY  NO-UP 
3140        SBM  R46,=200,0
3150        JMP  LEF   
3160 NO-UP  CMB  R#,=54
3170        JNC  LEF   
3180        ADM  R46,=200,0
3190 LEF    DCM  R46
3200 !       DCM R4
3210 OUTSHI LDBD R55,X14,WARPFL
3220        JZR  OUT-  
3230        JNG  OUT-  
3240        DCB  R55
3250        JZR  IN    
3260        LDBD R55,X14,WARPCO
3270        DCB  R55
3280        STBD R55,X14,WARPCO
3290        JNZ  OUT-- 
3300        DCB  R55
3310        STBD R55,X14,WARPFL
3320        JMP  OUT-- 
3330 IN     SBM  R46,=200,0
3340 OUT-   CMM  R46,=100,23
3350        JCY  OUT-- 
3360        ANM  R46,=77,0
3370        STM  R46,R56
3380        ADM  R46,=0,72
3390 LOOP10 CMB  R56,=25
3400        JCY  OK1   
3410        SBM  R46,=200,0
3420        ICB  R56
3430        JMP  LOOP10
3440 OK1    CMB  R56,=55
3450        JNC  OUT---
3460        SBM  R46,=200,0
3470        DCB  R56
3480        JMP  OK1   
3490 OUT--- CLB  R56
3500        ICB  R56
3510        ICB  R56
3520        STBD R56,X14,WARPFL
3530 OUT--  STMD R46,X14,MYLOC 
3540        LDM  R56,=SHIP  
3550        LDBD R55,X14,WARPFL
3560        DCB  R55
3570        JNG  SPT   
3580        LDM  R56,=WARSHP
3590 SPT    STM  R46,R34
3600        JSB  X14,OUT8  
3610        LDBD R56,X14,WARPFL
3620        DCB  R56
3630        JNG  OUTRTN
3640        JSB  X14,WCRASH
3650 OUTRTN RTN  
3660 RITSHI LDMD R46,X14,MYLOC 
3670        LDM  R56,=BLANKS
3680        STM  R46,R34
3690        JSB  X14,OUT8  
3700        LDMD R46,X14,MYLOC 
3710        STM  R46,R56
3720        ANM  R56,=77,0
3730        CMB  R56,=73
3740        JCY  OUTJMP
3750        CMB  R56,=53
3760        JNC  NO-UP2
3770        SBM  R46,=200,0
3780        JMP  RIT   
3790 NO-UP2 CMB  R#,=24
3800        JCY  RIT   
3810        ADM  R46,=200,0
3820 RIT    ICM  R46
3830 OUTJMP LDM  R56,=OUTSHI
3840        ADM  R56,R14
3850        DCM  R56
3860        STM  R56,R4
3870 ! ************************
3880 WCRASH LDM  R36,=7,0
3890 WCLOP  LDM  R24,R36
3900        DCM  R24
3910        LLM  R24
3920        LLM  R24
3930        ADM  R24,R14
3940        LDMD R54,X24,BIRDS 
3950        LDMD R22,X14,MYLOC 
3960        ADM  R22,=300,1
3970        SBM  R22,R56
3980        JNG  WCRTN 
3990        CMB  R55,=10
4000        JNZ  W20?  
4010        CMM  R22,=300,3
4020        JCY  WCRTN 
4030        ANM  R22,=77,0
4040        JZR  WC!   
4050        DCB  R22
4060        JZR  WC!   
4070        CMB  R22,=76
4080        JNZ  WCRTN 
4090 WC!    LDB  R54,=10
4100        STMD R54,X24,BIRDS 
4110 WCRTN  DCM  R36
4120        JNZ  WCLOP 
4130        RTN  
4140 W20?   CMB  R#,=20
4150        JNZ  W40   
4160        CMM  R22,=300,3
4170 W20+   JCY  WCRTN 
4180        ANM  R22,=77,0
4190        JZR  WC!   
4200        CMB  R22,=77
4210        JZR  WC!   
4220        CMB  R22,=4
4230        JNC  WC!   
4240        JMP  WCRTN 
4250 W40    CMM  R22,=300,5
4260        JMP  W20+  
4270 ! ***********************
4280 WARP   LDBD R36,X14,WARPFL
4290        JNZ  WRTN  
4300        ICB  R36
4310        STBD R36,X14,WARPFL
4320        LDB  R36,=50
4330        STBD R36,X14,WARPCO
4340        LDB  R46,=4
4350        LDM  R56,=BLANKS
4360        LDM  R34,=44,76
4370 KEYL3  JSB  X14,OUT8  
4380        SBM  R56,R14
4390        SBM  R34,=376,1
4400        DCB  R46
4410        JNZ  KEYL3 
4420 WRTN   RTN  
4430 ! ***********************
4440 FIRE   LDMD R76,X14,MYLOC 
4450        JZR  FIRRTN
4460        LDM  R75,=4
4470        DEF  SHOT1 
4480        ADM  R76,R14
4490 FIRE?  POMD R66,+R76
4500        JZR  FIRE! 
4510        DCB  R75
4520        JNZ  FIRE? 
4530 FIRRTN RTN  
4540 FIRE!  DCM  R76
4550        DCM  R76
4560        LDMD R46,X14,MYLOC 
4570        ICM  R46
4580        SBM  R46,=100,0
4590        STMD R46,R76
4600        DRP  R30
4610 WAIT5  LDBD R#,=CRTSTS
4620        JNG  WAIT5 
4630        STMD R46,=CRTBAD
4640        DRP  R30
4650        LDBD R#,=CRTWRS
4660        ICB  R#
4670        STBD R#,=CRTSTS
4680 WAIT4  LDBD R#,=CRTSTS
4690        JEV  WAIT4 
4700        LDBD R#,=CRTDAT
4710        JNZ  HIT?  
4720        ADB  R#,=200
4730        DRP  R71
4740 WAIT6  LDBD R#,=CRTSTS
4750        JNG  WAIT6 
4760        STMD R46,=CRTBAD
4770        STBD R30,=CRTDAT
4780        RTN  
4790 HIT?   RTN  
4800 ! ************************
4810 BOMBMO LDM  R75,=12D
4820        DEF  BOMB1 
4830        ADM  R76,R14
4840 BOMLOP LDMD R64,R76
4850        JZR  NXTBOM
4860        DRP  R30
4870 WAIT70 LDBD R#,=CRTSTS
4880        JNG  WAIT70
4890        STMD R66,=CRTBAD
4900        DRP  R31
4910 WAIT80 LDBD R#,=CRTSTS
4920        JNG  WAIT80
4930        LDBD R#,=CRTWRS
4940        ICB  R#
4950        STBD R#,=CRTSTS
4960 WAIT90 LDBD R#,=CRTSTS
4970        JEV  WAIT90
4980        LDBD R#,=CRTDAT
4990        ANM  R#,=357
5000        DRP  R30
5010 WAIT30 LDBD R#,=CRTSTS
5020        JNG  WAIT30
5030        STMD R66,=CRTBAD
5040        STBD R31,=CRTDAT
5050        ADM  R66,R64
5060        CMM  R66,=300,75
5070        JCY  NXTBO+
5080        DRP  R30
5090 WAIT31 LDBD R#,=CRTSTS
5100        JNG  WAIT31
5110        STMD R66,=CRTBAD
5120        STMD R64,R76
5130        DRP  R31
5140 WAIT32 LDBD R#,=CRTSTS
5150        JNG  WAIT32
5160        LDBD R#,=CRTWRS
5170        ICB  R#
5180        STBD R#,=CRTSTS
5190 WAIT33 LDBD R#,=CRTSTS
5200        JEV  WAIT33
5210        LDBD R#,=CRTDAT
5220        JNZ  SOMEB 
5230 EMPTYB LDB  R71,=20
5240        ORB  R71,R31
5250        DRP  R30
5260 WAIT34 LDBD R#,=CRTSTS
5270        JNG  WAIT34
5280        STMD R66,=CRTBAD
5290        STBD R71,=CRTDAT
5300        JMP  NXTBOM
5310 NXTBO+ CLM  R64
5320        STMD R64,R76
5330 NXTBOM ADM  R76,=4,0
5340        DCB  R75
5350        JZR  SOBRTN
5360        LDM  R66,=BOMLOP
5370        ADM  R66,R14
5380        DCM  R66
5390        STM  R66,R4
5400 SOMEB  LDBD R36,X14,WARPFL
5410        DCB  R36
5420        JPS  SOBRTN
5430        LDB  R36,R31
5440        ANM  R36,=20,0
5450        JZR  SOBRTN
5460        LDMD R34,X14,MYLOC 
5470        LDM  R22,R66
5480        SBM  R22,R34
5490        JNG  SOBRTN
5500        CMM  R22,=200,1
5510        JCY  SOBRTN
5520        ANM  R22,=77,0
5530        JZR  BOMHIT
5540        DCB  R22
5550        JNZ  SOBRTN
5560 BOMHIT LDM  R56,=BLSTSH
5570        JSB  X14,OUT8  
5580        JSB  X14,BOOP  
5590        LDMD R34,X14,MYLOC 
5600        LDM  R56,=BLANKS
5610        JSB  X14,OUT8  
5620        CLM  R56
5630        STMD R56,X14,MYLOC 
5640 SOBRTN RTN  
5650 ! ***********************
5660 SHOTMO LDM  R75,=4
5670        DEF  SHOT1 
5680        ADM  R76,R14
5690 SHOLOP LDMD R66,R76
5700        JZR  NXTSHO
5710        DRP  R30
5720 WAIT7  LDBD R#,=CRTSTS
5730        JNG  WAIT7 
5740        STMD R66,=CRTBAD
5750        DRP  R31
5760 WAIT8  LDBD R#,=CRTSTS
5770        JNG  WAIT8 
5780        LDBD R#,=CRTWRS
5790        ICB  R#
5800        STBD R#,=CRTSTS
5810 WAIT9  LDBD R#,=CRTSTS
5820        JEV  WAIT9 
5830        LDBD R#,=CRTDAT
5840        ANM  R#,=177
5850        DRP  R30
5860 WAIT10 LDBD R#,=CRTSTS
5870        JNG  WAIT10
5880        STMD R66,=CRTBAD
5890        STBD R31,=CRTDAT
5900        SBM  R66,=0,1
5910        CMM  R66,=100,23
5920        JNC  NXTSH+
5930        DRP  R30
5940 WAIT11 LDBD R#,=CRTSTS
5950        JNG  WAIT11
5960        STMD R66,=CRTBAD
5970        STMD R66,R76
5980        DRP  R31
5990 WAIT12 LDBD R#,=CRTSTS
6000        JNG  WAIT12
6010        LDBD R#,=CRTWRS
6020        ICB  R#
6030        STBD R#,=CRTSTS
6040 WAIT13 LDBD R#,=CRTSTS
6050        JEV  WAIT13
6060        LDBD R#,=CRTDAT
6070        JLN  SOME  
6080 EMPTY  ADB  R31,=200
6090        DRP  R30
6100 WAIT14 LDBD R#,=CRTSTS
6110        JNG  WAIT14
6120        STMD R66,=CRTBAD
6130        STBD R31,=CRTDAT
6140        JMP  NXTSHO
6150 NXTSH+ CLM  R66
6160        STMD R66,R76
6170 NXTSHO ICM  R76
6180        ICM  R76
6190        DCB  R75
6200        JNZ  SHOLOP
6210        RTN  
6220 ! ************************
6230 SOME   LDM  R36,=7,0
6240 SOMLOP LDM  R22,R36
6250        DCM  R22
6260        LLM  R22
6270        LLM  R22
6280        ADM  R22,R14
6290        LDMD R54,X22,BIRDS 
6300        JZR  NXTB  
6310        LDM  R24,R66
6320        SBM  R24,R56
6330        JNG  NXTB  
6340        CMB  R55,=11
6350        JCY  >10   
6360        CMM  R24,=302,1
6370        JCY  NXTB  
6380        ANM  R24,=77,00
6390 OK10   JZR  HIT10 
6400        DCM  R24
6410        JNZ  NXTB  
6420 HIT10  ICB  R54
6430        STMD R54,X22,BIRDS 
6440        JMP  NXTSH+
6450 >10    CMB  R55,=20
6460        JNZ  >20   
6470        CMM  R24,=304,1
6480 CMMCOM JCY  NXTB  
6490        ANM  R24,=77,0
6500 OK20   JZR  HIT10 
6510        DCM  R24
6520        JZR  HIT10 
6530        DCM  R24
6540        JZR  HIT10 
6550        DCM  R24
6560        JZR  HIT10 
6570 NXTB   DCM  R36
6580        JNZ  SOMLOP
6590        JMP  EMPTY 
6600 >20    CMM  R24,=304,3
6610        JMP  CMMCOM
6620 ! ************************
6630 FRAME  LDM  R32,=1,200
6640        LDM  R36,=76,20
6650 WAI190 LDBD R30,=CRTSTS
6660        JNG  WAI190
6670        STMD R36,=CRTBAD
6680 WAIT91 LDBD R30,=CRTSTS
6690        JNG  WAIT91
6700        STBD R32,=CRTDAT
6710 WAIT92 LDBD R30,=CRTSTS
6720        JNG  WAIT92
6730        STBD R33,=CRTDAT
6740        ADM  R36,=100,0
6750        CMM  R36,=300,75
6760        JNC  WAI190
6770        JMP  HORIZ 
6780 WAIT93 LDBD R30,=CRTSTS
6790        JNG  WAIT93
6800        STMD R36,=CRTBAD
6810        LDB  R36,=32D
6820 WAIT94 LDBD R30,=CRTSTS
6830        JNG  WAIT94
6840        STBD R32,=CRTDAT
6850        DCB  R36
6860        JNZ  WAIT94
6870        RTN  
6880 HORIZ  LDM  R36,=0,20
6890        LDB  R32,=377
6900        JSB  X14,WAIT93
6910        LDM  R36,=0,23
6920        JSB  X14,WAIT93
6930        LDM  R36,=300,75
6940        JSB  X14,WAIT93
6950        LDM  R36,=140,20
6960        LDB  R32,=200
6970 WAIT99 LDBD R30,=CRTSTS
6980        JNG  WAIT99
6990        STMD R36,=CRTBAD
7000        STBD R32,=CRTDAT
7010        ADM  R36,=100,0
7020        CMM  R36,=0,23
7030        JNC  WAIT99
7040        LDM  R36,=301,20
7050        LDB  R31,=7
7060        LDM  R34,=ASCSCR
7070        ADM  R34,R14
7080 FRAM1  LDB  R33,=7
7090 FRAM2  LDBD R30,=CRTSTS
7100        JNG  FRAM2 
7110        STMD R36,=CRTBAD
7120 FRAM3  POBD R32,+R34
7130 FRAM4  LDBD R30,=CRTSTS
7140        JNG  FRAM4 
7150        STBD R32,=CRTDAT
7160        DCB  R33
7170        JNZ  FRAM3 
7180        ADM  R36,=100,0
7190        DCB  R31
7200        JNZ  FRAM1 
7210        LDM  R36,=341,20
7220        LDB  R31,=7
7230        LDM  R34,=ASCSHI
7240        ADM  R34,R14
7250 FRAM5  LDB  R33,=7
7260 FRAM6  LDBD R30,=CRTSTS
7270        JNG  FRAM6 
7280        STMD R36,=CRTBAD
7290 FRAM7  POBD R32,+R34
7300 FRAM8  LDBD R30,=CRTSTS
7310        JNG  FRAM8 
7320        STBD R32,=CRTDAT
7330        DCB  R33
7340        JNZ  FRAM7 
7350        ADM  R36,=100,0
7360        DCB  R31
7370        JNZ  FRAM5 
7380        LDB  R46,=30D
7390        LDM  R56,=KEYLAS
7400        LDM  R34,=0,76
7410 KEYL   JSB  X14,OUT8  
7420        SBM  R56,R14
7430        SBM  R34,=376,1
7440        DCB  R46
7450        JNZ  KEYL  
7460        RTN  
7470 ASCSCR BYT  160,160,160,360,370,0,0,210,210,210,210,200,0,0
7480        BYT  200,200,210,210,200,0,40,160,200,210,360,360,0,0
7490        BYT  10,200,210,240,200,0,40,210,210,210,220,200,0,0
7500        BYT  160,160,160,210,370,0,0
7510 ASCSHI BYT  160,210,160,360,160,0,0,210,210,40,210,210,0,0
7520        BYT  200,210,40,210,200,0,40,160,370,40,360,160,0,0
7530        BYT  10,210,40,200,10,0,40,210,210,40,200,210,0,0
7540        BYT  160,210,160,200,160,0,0
7550 KEYLAS BSZ  10
7560        BYT  0,200,200,200,200,200,200,370,0,370,200,200,360,200,200,370,0,370,200,200,360
7570        BYT  200,200,200,0,370,40,40,40,40,40,40
7580        BSZ  32D
7590        BYT  0,360,210,210,360,240,220,210,0,160,40,40,40,40,40,160,0,160,210,200,230,210,210,160
7600        BYT  0,210,210,210,370,210,210,210,0,370,40,40,40,40,40,40
7610        BSZ  32D
7620 WARASC BYT  0,210,210,250,250,330,330,210,0,160,210,210,370,210,210,210,0,360,210,210,360,240
7630        BYT  220,210,0,360,210,210,360,200,200,200
7640        BSZ  32D
7650        BYT  0,370,200,200,360,200,200,200,0,160,40,40,40,40,40,160,0,360,210,210,360,240,220,210
7660        BYT  0,370,200,200,360,200,200,370
7670 ! ************************
7680 UPSCOR LDMD R65,X14,SCORE 
7690        BCD  
7700        ADM  R65,R55
7710        STMD R65,X14,SCORE 
7720        SBMD R65,=XAPRIM
7730        BIN  
7740        JNC  FIN++ 
7750        LDBD R75,X14,SHIPCO
7760        ICB  R75
7770        STBD R75,X14,SHIPCO
7780        CMB  R75,=7
7790        JCY  NOSHIP
7800        JSB  X14,ADDSHI
7810 NOSHIP LDMD R65,=XAPRIM
7820        BCD  
7830        ADM  R65,=0,20C,0
7840        STMD R65,=XAPRIM
7850 FIN++  LDM  R75,=6,323,20
7860        LDMD R65,X14,SCORE 
7861        TSB  R67
7862        JLZ  FIND-D
7863        BCD  
7864        LLB  R67
7865        LRB  R67
7866        LDM  R55,=0,20C,0
7867        STMD R55,=XAPRIM
7868        STMD R65,X14,SCORE 
7870 FIND-D BCD  
7880        LDM  R34,R76
7890        LDM  R56,=BLANKS
7900        LLM  R65
7910        JEN  FIRSTD
7920        BIN  
7930        JSB  X14,OUT8  
7940        ADM  R76,=2,0
7950        DCB  R75
7960        JNZ  FIND-D
7970        RTN  
7980 FIRST+ BCD  
7990        LDM  R34,R76
8000        LLM  R65
8010 FIRSTD CLM  R56
8020        ELB  R56
8030        BIN  
8040        LLM  R56
8050        LLM  R56
8060        LLM  R56
8070        ADM  R56,=DIGITS
8080        JSB  X14,OUT8  
8090        ADM  R76,=2,0
8100        DCB  R75
8110        JNZ  FIRST+
8120        RTN  
8130 DIGITS BYT  160,210,210,210,210,210,160,0
8140        BYT  40,140,40,40,40,40,160,0
8150        BYT  160,210,10,60,100,200,370,0
8160        BYT  370,10,20,60,10,210,160,0
8170        BYT  20,60,120,220,370,20,20,0
8180        BYT  370,200,360,10,10,210,160,0
8190        BYT  70,100,200,360,210,210,160,0
8200        BYT  370,10,20,40,100,100,100,0
8210        BYT  160,210,210,160,210,210,160,0
8220        BYT  160,210,210,170,10,20,340,0
8230 SUBSHI LDM  R56,=BLANKS
8240        JMP  SHICOM
8250 ADDSHI LDM  R56,=SHIP  
8260 SHICOM CLM  R34
8270        LDB  R34,R75
8280        DCB  R34
8290        STM  R34,R24
8300        LLM  R34
8310        ADM  R34,R24
8320        ADM  R34,=357,20
8330        JSB  X14,OUT8  
8340        RTN  
8350 XAPRIM DAD  101740
8360 TOUGHF BSZ  1
8370 HIDDEN BYT  7
8380        DEF  HIDDEN
8390        DEF  HIDDEN
8400 HIDD+  BYT  10,10,377,6
8410        DEF  HIDD+ 
8420 ! ***********************
8430 KEY&&- BSZ  0
8440        LDM  R46,=BOMB1 
8450        ADM  R46,R14
8460        LDB  R45,=12D
8470 KEY&&L POMD R74,+R46
8480        JNZ  &&&TN 
8490        DCB  R45
8500        JNZ  KEY&&L
8510 &&&TN  RTN  
8520        LNK  BATS2.asm
