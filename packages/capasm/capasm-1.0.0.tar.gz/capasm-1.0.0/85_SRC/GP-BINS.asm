0010        NAM  GP-BIN
0020        DEF  RUNTIM
0030        DEF  ASCII 
0040        DEF  PARSE 
0050        DEF  DUMMY 
0060        DEF  INIT  
0070 RUNTIM BSZ  2
0080        DEF  CPRNT.
0090        DEF  CLINE.
0100        DEF  CCURS.
0110        DEF  CCLR. 
0120        DEF  CWRT. 
0130        DEF  CDISP.
0140        DEF  ONKBD.
0150        DEF  OFFK. 
0160        DEF  ONCOD.
0170        DEF  OFFC. 
0180        DEF  CLPOS.
0190        DEF  CCPOS.
0200        DEF  CCHR$.
0210        DEF  KBD$. 
0220        DEF  FIND. 
0230        DEF  KCNVP.
0240        DEF  KCNVI.
0250        DEF  KCNV. 
0260        DEF  SGCLR.
0270        DEF  MSUS$.
0275        DEF  UDL?$.
0276        DEF  SCRTB.
0280 PARSE  BSZ  2
0290        DEF  STM_S 
0300        DEF  STM_N 
0310        DEF  STM_N 
0320        DEF  STM   
0330        DEF  STM_S 
0340        DEF  STM_S 
0350        DEF  ONKBD 
0360        DEF  STM   
0370        DEF  ONKBD 
0380        DEF  STM   
0390        DEF  DUMMY 
0400        DEF  DUMMY 
0410        DEF  DUMMY 
0420        DEF  DUMMY 
0430        DEF  DUMMY 
0440        DEF  STM_S 
0450        DEF  STM_S 
0460        DEF  STM   
0470        DEF  SGCLR 
0471        DEF  DUMMY 
0472        DEF  DUMMY 
0475        DEF  STM   
0480 SVC_R  DEF  EOLSVC
0490 KBD_R  DEF  KBDISR
0500 JMPTBL DEF  CD_LP 
0510        DEF  CD_CC 
0520        DEF  CD_CC 
0530        DEF  CD_CC 
0540        DEF  CD_CC 
0550        DEF  CD_CC 
0560        DEF  CD_CC 
0570        DEF  CD_BL 
0580        DEF  CD_BS 
0590        DEF  CD_CC 
0600        DEF  CD_LF 
0610        DEF  CD_CC 
0620        DEF  CD_FF 
0630        DEF  CD_CR 
0640 PRTTBL DEF  CP_LP 
0650        DEF  CP_CC 
0660        DEF  CP_CC 
0670        DEF  CP_CC 
0680        DEF  CP_CC 
0690        DEF  CP_CC 
0700        DEF  CP_CC 
0710        DEF  CP_BL 
0720        DEF  CP_BS 
0730        DEF  CP_CC 
0740        DEF  CP_LF 
0750        DEF  CP_CC 
0760        DEF  CP_FF 
0770        DEF  CP_CR 
0780        BYT  377,377
0790 INCHR  DAD  35244
0800 CHKSTS DAD  36335
0810 PADKBD DAD  34662
0820 ALPHA. DAD  36105
0830 RETRHI DAD  35771
0840 TRA?   DAD  1523
0850 CLKHIT DAD  507
0860 CHREDT DAD  364
0870 XCBIT3 DAD  274
0880 PRDVR1 DAD  75767
0890 IPHERE DAD  101042
0900 ASCII  ASP  "CPRINT"
0910        ASP  "CLINE"
0920        ASP  "CCURSOR"
0930        ASP  "CCLEAR"
0940        ASP  "CWRITE"
0950        ASP  "CDISP"
0960        ASP  "ON KBD"
0970        ASP  "OFF KBD"
0980        ASP  "ON CCODE"
0990        ASP  "OFF CCODE"
1000        ASP  "CLPOS"
1010        ASP  "CCPOS"
1020        ASP  "CCHR$"
1030        ASP  "KBD$"
1040        ASP  "FIND"
1050        ASP  "CONVERT KBD PAIRS; "
1060        ASP  "CONVERT KBD INDEX; "
1070        ASP  "CONVERT KBD"
1080        ASP  "SGCLEAR"
1090        ASP  "MSUS$"
1095        ASP  "UDL?$"
1096        ASP  "SCRATCHBIN"
1100        BYT  377
1110 SGCLR  LDB  R35,=4
1120        JMP  STM_X 
1130 STM    LDM  R56,=371,0
1140        PUMD R56,+R12
1150        PUBD R43,+R12
1160        JSB  =SCAN  
1170 DUMMY  RTN  
1180 STM_N  LDB  R35,=1
1190 STM_X  PUBD R43,+R6
1200        LDB  R14,=371
1210        JSB  =GETPAR
1220        POBD R53,-R6
1230        PUBD R53,+R12
1240        PUBD R53,+R12
1250        RTN  
1260 STM_S  PUBD R43,+R6
1270        JSB  =SCAN  
1280        JSB  =STRREF
1290        POBD R2,-R6
1300        DCE  
1310        JEN  SYNERR
1320        LDM  R56,=371,0
1330        PUMD R56,+R12
1340        PUBD R2,+R12
1350        RTN  
1360 ONKBD  LDM  R56,=371,0
1370        PUMD R56,+R12
1380        PUBD R43,+R12
1390        JSB  =SCAN  
1400        CMB  R47,=210
1410        JZR  ONK_OK
1420 SYNERR JSB  =ERROR+
1430        BYT  92D
1440        RTN  
1450 ONK_OK JSB  =GOTOSU
1460        RTN  
1470 INIT   LDMD R22,=BINTAB
1480        LDBD R20,=ROMFL 
1490        CMB  R20,=2
1500        JZR  UNINIT
1510        CMB  R20,=5
1520        JZR  UNINIT
1530        CMB  R20,=4
1540        JZR  INIT_2
1550        CMB  R20,=1
1560        JZR  INIT_2
1570        CMB  R20,=7
1580        JZR  INIT_2
1590        CMB  R20,=8D
1600        JCY  INITDN
1610        JMP  INIT_3
1620 INIT_2 JSB  X22,OFFK. 
1630        JSB  X22,OFFC. 
1640        JSB  X22,KCNV. 
1650 INIT_3 LDMD R41,=IOSP  
1660        LDM  R54,R41
1670        LDMD R66,X22,SVC_R 
1680        STMD R66,X22,SVCADR
1690        LDMD R64,X22,MY_SVC
1700        CMM  R64,R54
1710        JZR  INITDN
1720        LDMD R74,X22,SVCERR
1730        CMM  R74,R54
1740        JNZ  SAVOLD
1750        LDB  R41,=236
1760 SAVOLD STMD R41,X22,OLDSVC
1770        STMD R64,=IOSP  
1780 INITDN LDB  R20,=377
1790        STBD R20,=IPHERE
1800        RTN  
1810 UNINIT LDB  R40,=236
1820        STBD R40,=KYIDLE
1830        LDMD R41,X22,OLDSVC
1840        CMB  R41,R40
1850        JNZ  WASSVC
1860        LDMD R41,X22,SVCERR
1870 WASSVC STMD R41,=IOSP  
1880 UN_DN  CLB  R20
1890        STBD R20,=IPHERE
1900        RTN  
1910        BYT  241
1920 ONKBD. LDMD R22,=BINTAB
1930        BIN  
1940        STMD R10,X22,KEYEOL
1950        ADM  R10,=3,0
1960        LDMD R46,X22,KBD_R 
1970        STMD R46,X22,KBDADR
1980        LDMD R46,X22,KEYRPT
1990 HOLDLP LDMD R20,=KEYSTS
2000        LRB  R20
2010        JEV  NOHOLD
2020        TSM  R46
2030        JZR  HOLDDN
2040        DCM  R46
2050        JMP  HOLDLP
2060 HOLDDN LDM  R46,=377,2
2070        STMD R46,X22,KEYRPT
2080        LDBD R26,X22,OLDKEY
2090        STBD R#,=GINTDS
2100        JSB  X22,LOGKEY
2110 NOHOLD STBD R#,=GINTDS
2120        LDB  R46,=TRUE  
2130        STBD R46,X22,KEYSVC
2140        LDMD R46,X22,KBDCNT
2150        JZR  SETISR
2160        JSB  X22,LOGONK
2170 SETISR LDMD R44,X22,NEWKEY
2180        STMD R44,=KYIDLE
2190        STBD R#,=GINTEN
2200        RTN  
2210        BYT  241
2220 OFFK.  LDMD R22,=BINTAB
2230        CLM  R46
2240        STMD R46,X22,KEYEOL
2250        STMD R46,X22,KBDCNT
2260        LDB  R46,=236
2270        STBD R46,=KYIDLE
2280        RTN  
2290        BYT  0,56
2300 KBD$.  LDMD R22,=BINTAB
2310        BIN  
2320        LDMD R20,X22,K_CNV 
2330        STM  R20,R70
2340        LDM  R56,=120,0
2350        JSB  =RSMEM-
2360        JEN  CANT+ 
2370        STM  R26,R30
2380        STBD R#,=GINTDS
2390        LDMD R76,X22,KBDCNT
2400        STM  R76,R34
2410        JZR  K_NOCH
2420        LDM  R36,=KBDSAV
2430        ADM  R36,R22
2440 K_LOOP POBD R32,+R36
2450        JSB  X22,CNVCHR
2460        PUBD R32,+R26
2470        DCM  R34
2480        JNZ  K_LOOP
2490 K_NOCH PUMD R76,+R12
2500        PUMD R30,+R12
2510        STMD R34,X22,KBDCNT
2520        STBD R#,=GINTEN
2530        RTN  
2540 CANT+  JSB  =ERROR 
2550        BYT  19D
2560        BYT  30,55
2570 FIND.  LDMD R22,=BINTAB
2580        BIN  
2590        POMD R32,-R12
2600        POMD R34,-R12
2610        JZR  F_NONE
2620        CLM  R46
2630 FND_LP ICM  R46
2640        POBD R20,+R32
2650        JNG  F_FND 
2660        DCM  R34
2670        JNZ  FND_LP
2680 F_NONE CLM  R46
2690 F_FND  JSB  X22,FNCRTN
2700        RTN  
2710        BYT  241
2720 KCNVP. CLM  R20
2730        JMP  KC_COM
2740        BYT  241
2750 KCNVI. LDM  R20,=0,200
2760 KC_COM POMD R42,-R12
2770        DCM  R46
2780        DCM  R46
2790        ANM  R46,=377,177
2800        ORM  R46,R20
2810 STRCOM LDMD R22,=BINTAB
2820        STMD R46,X22,K_CNV 
2830        RTN  
2840        BYT  241
2850 KCNV.  CLM  R46
2860        JMP  STRCOM
2870 P.ERR  LDB  R30,=0
2880        JSB  =ERROR+
2890        BYT  89D
2900        BYT  241
2910 SGCLR. LDMD R22,=BINTAB
2920        JSB  =GRAPH.
2930        JSB  =ONEB  
2940        STM  R46,R26
2950        JNG  P.ERR 
2960        JSB  =ONEB  
2970        STM  R46,R24
2980        JNG  P.ERR 
2990        JSB  =ONEB  
3000        STM  R46,R32
3010        JNG  P.ERR 
3020        JSB  =ONEB  
3030        STM  R46,R30
3040        JNG  P.ERR 
3050        BIN  
3060        LDBD R21,=PLOTSY
3070        NCM  R21
3080        CMM  R32,R30
3090        JNC  P.ERR 
3100        CMM  R32,=0,1
3110        JCY  P.ERR 
3120        CMM  R26,R24
3130        JNC  P.ERR 
3140        CMM  R26,=300,0
3150        JCY  P.ERR 
3160        LRM  R30
3170        LRM  R30
3180        LRM  R32
3190        LRM  R32
3200        ICM  R24
3210        ICM  R26
3220 SG.L.Y LDM  R46,=300,0
3230        SBM  R46,R24
3240        LLM  R46
3250        LLM  R46
3260        BCD  
3270        LLM  R46
3280        BIN  
3290        ADM  R46,R30
3300        ADM  R46,=0,20
3310 SGWAIT LDBD R20,=CRTSTS
3320        JNG  SGWAIT
3330        STMD R46,=CRTBAD
3340        LDM  R34,R30
3350 SG.L.X LDBD R20,=CRTSTS
3360        JNG  SG.L.X
3370        STBD R21,=CRTDAT
3380        ICM  R34
3390        ICM  R34
3400        CMM  R34,R32
3410        JNC  SG.L.X
3420        ICM  R24
3430        CMM  R24,R26
3440        JNC  SG.L.Y
3450        RTN  
3460 NEWKEY BYT  316
3470 KBDADR DEF  KBDISR
3480        RTN  
3490 KBDISR STBD R#,=GINTDS
3500        BIN  
3510        CMB  R16,=002
3520        JZR  KBD_GO
3530        CMB  R16,=007
3540        JZR  KBD_GO
3550        JMP  KBDE  
3560 KBD_GO PUMD R2,+R6
3570        PUMD R40,+R6
3580        LDM  R40,R20
3590        PUMD R40,+R6
3600        BCD  
3610        ELB  R47
3620        BIN  
3630        CMM  R6,=R6LIM2
3640        JNC  R6_OK 
3650        JSB  =ERROR 
3660        BYT  15D
3670 R6_OK  LDMD R22,=BINTAB
3680        LDM  R26,=377,57
3690        STMD R26,X22,KEYRPT
3700        LDBD R26,=KEYCOD
3710        STBD R26,X22,OLDKEY
3720        JSB  X22,LOGKEY
3730 STARTK LDBD R20,=KRPET1
3740        STBD R20,=KEYCNT
3750        LDB  R20,=1
3760        STBD R20,=KEYCOD
3770        LDM  R20,R6
3780        SBM  R20,=26,0
3790        LDM  R26,=PADKBD
3800        STMD R26,R20
3810        BCD  
3820        ERB  R47
3830        POMD R40,-R6
3840        STM  R40,R20
3850        POMD R40,-R6
3860        POMD R2,-R6
3870 KBDE   STBD R#,=GINTEN
3880        RTN  
3890 LOGCCD LDB  R40,=200
3900        JMP  COMLOG
3910 LOGONK CLB  R40
3920        STBD R40,X22,KEYSVC
3930        LDB  R40,=1
3940 COMLOG JSB  X22,D_SERV
3950        LDBD R41,X22,IPSVC 
3960        ORB  R41,R40
3970        STBD R41,X22,IPSVC 
3980        RTN  
3990 D_SERV LDB  R45,=2
4000        LDBD R44,=SVCWRD
4010        ORB  R44,R45
4020        STBD R44,=SVCWRD
4030        LDB  R44,=20
4040        ORB  R17,R44
4050        RTN  
4060 LOGKEY LDMD R24,X22,KBDCNT
4070        CMB  R24,=80D
4080        JCY  KEYOVF
4090        STM  R24,R20
4100        ADM  R24,R22
4110        STBD R26,X24,KBDSAV
4120        LDBD R27,X22,KEYSVC
4130        JZR  NOKLOG
4140        JSB  X22,LOGONK
4150 NOKLOG ICM  R20
4160        STMD R20,X22,KBDCNT
4170        RTN  
4180 KEYOVF JSB  =BEEP  
4190        JSB  X22,OFFK. 
4200        RTN  
4210 MY_SVC BYT  316
4220 SVCADR DEF  EOLSVC
4230        RTN  
4240 SVCERR JSB  =ERROR+
4250        BYT  25
4260 EOLSVC STBD R#,=GINTDS
4270        BIN  
4280        LDMD R22,=BINTAB
4290        CMB  R16,=2
4300        JNZ  TRYINP
4310        CMMD R10,=PCR   
4320        JNZ  TRYINP
4330 E_CHK  LDBD R30,X22,IPSVC 
4340        JZR  CHK_EX
4350        JOD  KBDSVC
4360 CCDSVC ANM  R#,=177,377
4370        STBD R#,X22,IPSVC 
4380        LDMD R20,X22,CCDEOL
4390        JZR  CHK_EX
4400        JMP  JAM_PC
4410 KBDSVC ANM  R#,=376,377
4420        STBD R#,X22,IPSVC 
4430        LDMD R20,X22,KEYEOL
4440        JZR  SVC_EX
4450 JAM_PC JSB  =SETTR1
4460        STMD R10,=ONFLAG
4470        LDM  R10,R20
4480        LDB  R16,=7
4490 CHK_EX LDB  R32,=375
4500        JSB  =CLRBIT
4510 SVC_EX BSZ  0
4520        JSB  X22,OLDSVC
4530        BIN  
4540        LDMD R22,=BINTAB
4550        LDBD R20,X22,IPSVC 
4560        JZR  SKPSVC
4570        JSB  X22,D_SERV
4580 SKPSVC STBD R#,=GINTEN
4590        RTN  
4600 TRYINP LDM  R20,R6
4610        SBM  R20,=4,0
4620        LDM  R46,=CLKHIT
4630        ANM  R32,=376,377
4640        TSB  R32
4650        JNZ  CNDHIT
4660        LDM  R46,=CHREDT
4670        LDBD R45,=SVCWRD
4680        JOD  CNDHIT
4690        LDM  R46,=XCBIT3
4700 CNDHIT STMD R46,R20
4710        DRP  R32
4720        JMP  SKPSVC
4730 OLDSVC RTN  
4740        RTN  
4750        RTN  
4760        RTN  
4770        RTN  
4780        RTN  
4790        RTN  
4800        RTN  
4810        RTN  
4820        BYT  241
4830 ONCOD. LDMD R22,=BINTAB
4840        BIN  
4850        STMD R10,X22,CCDEOL
4860        ADM  R10,=3,0
4870        LDB  R46,=TRUE  
4880        STBD R46,X22,CCD?  
4890        RTN  
4900        BYT  241
4910 OFFC.  LDMD R22,=BINTAB
4920        BIN  
4930        CLB  R46
4940        STBD R46,X22,CCD?  
4950        RTN  
4960        BYT  241
4970 CLINE. LDMD R22,=BINTAB
4980        JSB  =ALPHA.
4990        JSB  =ONEB  
5000        BCD  
5010        LLM  R46
5020        BIN  
5030        LLM  R46
5040        LLM  R46
5050        JSB  X22,STORAM
5060        RTN  
5070        BYT  241
5080 CCURS. LDMD R22,=BINTAB
5090        JSB  =ALPHA.
5100        JSB  X22,CLRCUR
5110        JSB  =ONEB  
5120        BIN  
5130        LLM  R46
5140        JSB  X22,STOBYT
5150        RTN  
5160        BYT  241
5170 CCLR.  LDMD R22,=BINTAB
5180        JSB  =CRTWPO
5190        BIN  
5200        JSB  =ALPHA.
5210        CLM  R46
5220        JSB  X22,STOBYT
5230        JSB  X22,STORAM
5240        LDM  R46,=0,10
5250        LDB  R32,=15
5260 CL_LP  JSB  =CHKSTS
5270        STBD R32,=CRTDAT
5280        DCM  R46
5290        JNZ  CL_LP 
5300        JSB  X22,STORAM
5310        JSB  X22,STOBYT
5320        JSB  =CRTUNW
5330        RTN  
5340        BYT  0,55
5350 CCPOS. LDMD R22,=BINTAB
5360        LDMD R46,=CRTBYT
5370        BIN  
5380        LRM  R47
5390 FNCRTN LDM  R36,R46
5400        JSB  =CONBIN
5410        PUMD R40,+R12
5420        RTN  
5430        BYT  0,55
5440 CLPOS. LDMD R22,=BINTAB
5450        LDMD R46,=CRTRAM
5460        BCD  
5470        LRM  R47
5480        BIN  
5490        LRM  R47
5500        LRM  R47
5510        JMP  FNCRTN
5520        BYT  40,56
5530 CCHR$. JSB  =TWOB  
5540        BIN  
5550        LDMD R22,=BINTAB
5560        LDM  R46,R56
5570        STM  R26,R56
5580        JZR  NULLST
5590        JNG  BADPRM
5600        ANM  R46,=377,7
5610        LLM  R46
5620        JSB  =ALPHA.
5630        JSB  =RSMEM-
5640        JEN  CANTDO
5650        PUMD R56,+R12
5660        PUMD R26,+R12
5670        JSB  X22,STOCRT
5680 CHR_LP JSB  =INCHR 
5690        PUBD R32,+R26
5700        DCM  R56
5710        JNZ  CHR_LP
5720        LDMD R46,=CRTBYT
5730        JSB  X22,STOBYT
5740        RTN  
5750 CANTDO JSB  =ERROR 
5760        BYT  19D
5770 NULLST CLM  R54
5780        PUMD R54,+R12
5790        RTN  
5800 BADPRM JSB  =ERROR 
5810        BYT  89D
5820        BYT  241
5830 CWRT.  LDMD R22,=BINTAB
5840        JSB  X22,FNDSTR
5850 CW_LP  JSB  X22,GETCHR
5860        JEZ  CW_EX 
5870        JSB  X22,PUTCHR
5880        JMP  CW_LP 
5890 CW_EX  BSZ  0
5900        RTN  
5910        BYT  241
5920 CDISP. LDMD R22,=BINTAB
5930        JSB  X22,FNDSTR
5940 CD_LP  JSB  X22,GETCHR
5950        JEN  CDCONT
5960 CD_EX  JSB  X22,SETCUR
5970        RTN  
5980 CDCONT CMB  R32,=40
5990        JNC  CNTRL 
6000        JSB  X22,PUTCHR
6010        JSB  X22,TRYEOS
6020        JMP  CD_LP 
6030 CNTRL  PUBD R32,+R6
6040        JSB  X22,CLRCUR
6050        POBD R32,-R6
6060        CMB  R32,=16
6070        JCY  CD_CC 
6080        CLB  R33
6090        LLB  R32
6100        ADM  R32,R22
6110        LDMD R32,X32,JMPTBL
6120        DCM  R32
6130        LDM  R4,R32
6140 CD_CC  TSB  R74
6150        JZR  CD_LP 
6160        STBD R#,=GINTDS
6170        JSB  X22,LOGCCD
6180        TSB  R75
6190        JZR  CD_EX2
6200        DCM  R26
6210        STMD R26,R36
6220 CD_EX2 STBD R#,=GINTEN
6230        JMP  CD_EX 
6240 CD_BL  JSB  =BEEP  
6250        JMP  CD_LP 
6260 CD_BS  CMM  R46,R56
6270        JZR  NO_BS 
6280        DCM  R46
6290        DCM  R46
6300        JSB  X22,STOBYT
6310 NO_BS  JMP  CD_LP 
6320 CD_LF  ADM  R46,=100,0
6330        JSB  X22,STOBYT
6340        JSB  X22,CLRLIN
6350        SBM  R46,=100,0
6360        JSB  X22,STOBYT
6370        JSB  X22,TRYEOS
6380 CD_LP2 JMP  CD_LP 
6390 CD_FF  ADM  R46,=100,0
6400        JSB  X22,STORAM
6410        JSB  X22,STOBYT
6420        LDB  R0,=20
6430 FF_LP  JSB  X22,CLRLIN
6440        DCB  R0
6450        JNZ  FF_LP 
6460        LDM  R46,R56
6470        JSB  X22,STOBYT
6480        JMP  CD_LP2
6490 CD_CR  ANM  R46,=300,17
6500        JSB  X22,STOBYT
6510        JMP  CD_LP2
6520        BYT  241
6530 CPRNT. LDMD R22,=BINTAB
6540        JSB  X22,FNDSTP
6550        LDMD R46,X22,PRTPTR
6560 CP_LP  JSB  X22,GETCHR
6570        JEN  CPCONT
6580 CP_EX  STMD R46,X22,PRTPTR
6590        RTN  
6600 CPCONT CMB  R32,=40
6610        JNC  CNTRLP
6620        JSB  X22,PRTCHR
6630        JMP  CP_LP 
6640 CNTRLP CMB  R32,=16
6650        JCY  CP_CC 
6660        CLB  R33
6670        LLB  R32
6680        ADM  R32,R22
6690        LDMD R32,X32,PRTTBL
6700        DCM  R32
6710        LDM  R4,R32
6720 CP_CC  TSB  R74
6730        JZR  CP_LP 
6740        STBD R#,=GINTDS
6750        JSB  X22,LOGCCD
6760        TSB  R75
6770        JZR  CP_EX2
6780        DCM  R26
6790        STMD R26,R36
6800 CP_EX2 STBD R#,=GINTEN
6810        JMP  CP_EX 
6820 CP_BL  JSB  =BEEP  
6830        JMP  CP_LP 
6840 CP_BS  TSM  R46
6850        JZR  NO_BSP
6860        DCM  R46
6870 NO_BSP JMP  CP_LP 
6880 CP_LF  JSB  X22,DMPPRT
6890        JMP  CP_LP 
6900 CP_FF  JSB  X22,DMPPRT
6910        CLM  R46
6920        LDB  R54,=4
6930 FF_LPP JSB  X22,DMPPRT
6940        DCB  R54
6950        JNZ  FF_LPP
6960        JMP  CP_LP 
6970 CP_CR  CLM  R46
6980        JMP  CP_LP 
6990 CLRLIN LDB  R20,=15
7000        LDB  R21,=41
7010 CLN_LP JSB  =CHKSTS
7020        STBD R20,=CRTDAT
7030        DCB  R21
7040        JNZ  CLN_LP
7050        ADM  R46,=100,0
7060        JSB  X22,STOBYT
7070        RTN  
7080 SETCUR JSB  =INCHR 
7090        LDB  R33,=200
7100        ORB  R32,R33
7110 CURCOM LDMD R46,=CRTBYT
7120        JSB  X22,STOBYT
7130        JSB  =CHKSTS
7140        STBD R32,=CRTDAT
7150        JSB  X22,STOBYT
7160        RTN  
7170 CLRCUR JSB  =INCHR 
7180        ANM  R32,=177,377
7190        JMP  CURCOM
7200 TRYEOS CMM  R46,R56
7210        JZR  EOS_EX
7220        JCY  EOSNRM
7230        LDM  R66,=0,20
7240        SBM  R66,R56
7250        ADM  R66,R46
7260        CMM  R66,=377,3
7270        JNC  EOS_EX
7280        JMP  DO_EOS
7290 EOSNRM LDM  R66,R56
7300        ADM  R66,=377,3
7310        SBM  R66,R46
7320        JCY  EOS_EX
7330 DO_EOS ADM  R56,=100,0
7340        JSB  X22,STRAM2
7350        JSB  X22,CLRLIN
7360        SBM  R46,=100,0
7370        JSB  X22,STOBYT
7380 EOS_EX RTN  
7390 STOBYT ANM  R46,=377,17
7400        STMD R46,=CRTBYT
7410 STOCRT JSB  =CHKSTS
7420        STMD R46,=CRTBAD
7430        RTN  
7440 STORAM DRP  R46
7450 STRAM2 SAD  
7460        JSB  =RETRHI
7470        PAD  
7480        ANM  R#,=300,17
7490        STMD R#,=CRTRAM
7500        STMD R#,=CRTSAD
7510        STM  R#,R56
7520        RTN  
7530 PUTCHR JSB  =CHKSTS
7540        STBD R32,=CRTDAT
7550        ICM  R46
7560        ICM  R46
7570        JSB  X22,STOBYT
7580        RTN  
7660 DMPPRT PUMD R36,+R6
7670        LDM  R36,=32D,0
7680        LDM  R20,R22
7690        ADM  R20,=31D,0
7700 DMP_LP LDBD R32,X20,PRTBUF
7710        CMB  R32,=40
7720        JNZ  DO_DMP
7730        DCM  R20
7740        DCB  R36
7750        JNZ  DMP_LP
7760 DO_DMP BSZ  0
7770        PUMD R46,+R6
7780        LDM  R26,R22
7790        ADM  R26,=PRTBUF
7800        JSB  =PRDVR1
7810        POMD R46,-R6
7820        POMD R36,-R6
7830 CLRPRT LDM  R20,R22
7840        LDB  R0,=32D
7850        LDB  R32,=40
7860 CLR_LP STBD R32,X20,PRTBUF
7870        ICM  R20
7880        DCB  R0
7890        JNZ  CLR_LP
7900        RTN  
7910 PRTCHR ICM  R46
7920        LDM  R56,R22
7930        ADM  R56,R46
7940        DCM  R56
7950        STBD R32,X56,PRTBUF
7960        CMM  R46,=32D,0
7970        JNZ  PC_EX 
7980        JSB  X22,DMPPRT
7990        CLM  R46
8000 PC_EX  RTN  
8010 FNDSTR JSB  =ALPHA.
8020 FNDSTP BIN  
8030        POMD R62,-R12
8040        SBM  R66,=6,0
8050        POMD R72,+R66
8060        TSM  R76
8070        JPS  STR_OK
8080        CLM  R76
8090 STR_OK STM  R66,R14
8100        LDM  R36,R72
8110        CMM  R36,R74
8120        JZR  NOTBUF
8130        DCM  R66
8140        DCM  R66
8150        STM  R66,R34
8160        ADM  R36,R66
8170        DCM  R36
8180        DCM  R36
8190        LDMD R36,R36
8200        STM  R36,R70
8210        LDM  R36,R74
8220        ADM  R36,R66
8230        ICM  R36
8240        ICM  R36
8250        LDB  R75,=TRUE  
8260        DCM  R14
8270        JMP  FS_EX 
8280 NOTBUF CLB  R75
8290 FS_EX  LDMD R46,=CRTBYT
8300        LDMD R56,=CRTRAM
8310        LDBD R74,X22,CCD?  
8320        RTN  
8330 GETCHR CLE  
8340        TSB  R75
8350        JZR  GC_STR
8360        STBD R#,=GINTDS
8370        LDMD R24,R34
8380        LDMD R26,R36
8390        CMM  R24,R26
8400        JCY  GC_BOK
8410        CLM  R20
8420        STMD R20,R34
8430        ICM  R20
8440        STMD R20,R36
8450        JMP  RB_EX 
8460 GC_BOK ADM  R26,R14
8470        POBD R32,+R26
8480        SBM  R26,R14
8490        STMD R26,R36
8500        ICE  
8510 RB_EX  STBD R#,=GINTEN
8520        JSB  X22,CNVCHR
8530        JMP  GC_EX 
8540 GC_STR TSM  R76
8550        JZR  GC_EX 
8560        DCM  R76
8570        POBD R32,+R14
8580        ICE  
8590 GC_EX  RTN  
8600 CNVCHR LDM  R20,R70
8610        JNZ  CEXIST
8620 CC_EX  RTN  
8630 CEXIST JPS  CC_PRS
8640        POMD R2,+R20
8650        TSB  R3
8660        JNZ  CC_IND
8670        CMB  R2,R32
8680        JNC  CC_EX 
8690 CC_IND CLM  R2
8700        LDB  R2,R32
8710        ADM  R2,R20
8720        LDBD R32,R2
8730        RTN  
8740 CC_PRS LDB  R2,=200
8750        ORB  R21,R2
8760        POMD R2,+R20
8770        JEV  CC_OK 
8780 CC_OK+ DCM  R#
8790 CC_OK  JZR  CC_EX 
8800        POMD R0,+R20
8810        CMB  R0,R32
8820        JZR  CC_FND
8830        DCM  R2
8840        JMP  CC_OK+
8850 CC_FND LDM  R2,R0
8860        STB  R3,R32
8870 ANYRTN RTN  
8880        BYT  30,56
8890 MSUS$. JSB  =ROMJSB
8900        DEF  MSIN  
8910        VAL  MSROM#
8920        BIN  
8930        LDM  R30,R6
8940        ADM  R30,=7,0
8950        STMD R30,=SAVER6
8960        LDB  R40,=2
8970        JSB  =ROMJSB
8980        DEF  DECODE
8990        VAL  MSROM#
9000        TSB  R17
9010        JNG  ANYRTN
9020        LDMD R44,X14,ACTMSU
9030        CLB  R44
9040        LDM  R20,=6,0
9050        BIN  
9060        ADB  R45,=3
9070        JNC  <4    
9080        ICB  R44
9090        JMP  GOT-IT
9100 <4     DCB  R20
9110        LDM  R44,R45
9120 GOT-IT ADM  R#,=60,60,60,60
9130        LDMD R14,=BINTAB
9140        STMD R44,X14,STUFF-
9150        PUMD R20,+R12
9160        LDM  R20,=STUFF 
9170        ADM  R20,R14
9180        PUMD R20,+R12
9190        RTN  
9200 STUFF  ASC  ":D"
9210 STUFF- BSZ  4
9220 MSIN   DAD  70253
9230 ACTMSU EQU  135
9240 SAVER6 DAD  101174
9250 ROMJSB DAD  4776
9260 MSROM# EQU  320
9270 DECODE DAD  70501
9280 KEYSVC BSZ  1
9290 KEYEOL BSZ  2
9300 KBDCNT BSZ  2
9310 KBDSAV BSZ  80D
9320 K_CNV  BSZ  2
9330 OLDKEY BSZ  1
9340 KEYRPT BSZ  2
9350 CCDEOL BSZ  2
9360 CCD?   BSZ  1
9370 IPSVC  BSZ  1
9380 PRTPTR BSZ  2
9390 PRTBUF ASC  "                                "
9400 DO_SVC BSZ  1
9410 TRUE   EQU  377
9430 LENGTH BSZ  0
9440 SCAN   DAD  11262
9450 GETPAR DAD  14342
9460 STRREF DAD  13753
9470 ERROR+ DAD  6611
9480 ERROR  DAD  6615
9490 GOTOSU DAD  17435
9500 BINTAB DAD  101233
9510 ROMFL  DAD  101231
9520 IOSP   DAD  102407
9530 KYIDLE DAD  102425
9540 KEYSTS DAD  177402
9550 KEYCOD DAD  177403
9560 KRPET1 DAD  100121
9570 KEYCNT DAD  100120
9580 GINTDS DAD  177401
9590 GINTEN DAD  177400
9600 RSMEM- DAD  37453
9610 GRAPH. DAD  36147
9620 ONEB   DAD  56113
9630 PLOTSY DAD  100116
9640 CRTSTS DAD  177406
9650 CRTBAD DAD  177405
9660 CRTDAT DAD  177407
9670 CRTBYT DAD  100176
9680 R6LIM2 DAD  101720
9690 SVCWRD DAD  100151
9700 PCR    DAD  100642
9710 SETTR1 DAD  2323
9720 ONFLAG DAD  100040
9730 CLRBIT DAD  546
9740 CRTWPO DAD  35661
9750 CRTUNW DAD  36067
9760 CRTRAM DAD  100200
9770 CONBIN DAD  3572
9780 CRTSAD DAD  177404
9790 TWOB   DAD  56176
9795 BEEP   DAD  7017
9800        LNK  GP-BINS2.asm
