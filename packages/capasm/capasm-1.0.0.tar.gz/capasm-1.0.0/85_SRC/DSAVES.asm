0010        NAM  DSAVE 
0020        DEF  RUNTIM
0030        DEF  ASCIIS
0040        DEF  PARSE 
0050        DEF  ERMSG 
0060        DEF  INIT  
0070 RUNTIM BSZ  2
0080        DEF  DSAVE.
0090        DEF  DGET. 
0100        DEF  SCRTB.
0110        DEF  .   
0120 PARSE  BSZ  2
0130        DEF  DSAVEP
0140        DEF  DGETP 
0150        DEF  SCRATP
0160        BYT  377,377
0170 ASCIIS ASP  "DSAVE"
0180        ASP  "DGET"
0190        ASP  "SCRATCHBIN"
0200        ASP  ""
0210 ERMSG  BYT  377
0220 DGETP  PUBD R43,+R6
0230        JSB  =STREX+
0240        JEZ  ERROR!
0250        JMP  PRSDON
0260 DSAVEP PUBD R43,+R6
0270        JSB  =STREX+
0280        JEZ  ERROR!
0290        CMB  R14,=54
0300        JNZ  PRSDON
0310        JSB  =SEQ#  
0320        JEZ  ERROR!
0330        JSB  =PUSH32
0340        CMB  R14,=54
0350        JNZ  PRSDON
0360        JSB  =SEQ#  
0370        JEZ  ERROR!
0380        JSB  =PUSH32
0390 PRSDON POBD R47,-R6
0400 PRSDN1 LDB  R45,=371
0410        PUMD R45,+R12
0420        JSB  =SCAN  
0430 INIT   RTN  
0440 ERROR! POBD R43,-R6
0450        JSB  =ERROR+
0460        BYT  130
0470 SCRATP LDB  R47,R43
0480        JMP  PRSDN1
0490        BYT  0,56
0500 .    BIN  
0510        LDM  R44,=8D,0
0520        DEF  DATE  
0530        ADMD R46,=BINTAB
0540        PUMD R44,+R12
0550        RTN  
0560 DATE   ASC  "10/20/80"
0570        BYT  241
0580 SCRTB. STBD R#,=GINTDS
0590        BIN  
0600        LDMD R24,=BINTAB
0610        DCM  R24
0620        LDMD R26,=LWAMEM
0630        STM  R26,R22
0640        SBM  R22,R24
0650        LDB  R20,=4
0660        LDM  R32,=LAVAIL
0670 SCRTB1 LDMD R36,R32
0680        ADM  R36,R22
0690        PUMD R36,+R32
0700        DCB  R20
0710        JNZ  SCRTB1
0720        LDMD R36,R32
0730        CMMD R36,=LWAMEM
0740        JZR  SCRTB2
0750        ADM  R36,R22
0760        STMD R36,R32
0770 SCRTB2 CLM  R#
0780        STMD R#,=BINTAB
0790        LDM  R#,=12
0800        LDM  R41,=316
0810        DEF  MOVDN 
0820        STBD R#,=GINTEN
0830        RTN  
0840        STMD R41,R36
0850        DCM  R36
0860        LDM  R4,R36
0870        BYT  141
0880 DSAVE. BIN  
0890        LDMD R0,=BINTAB
0900        LDMD R71,=IOTRFC
0910        STMD R71,X0,MYTRFC
0920        LDMD R70,=SCTEMP
0930        STMD R70,X0,MYSC  
0940        CLB  R74
0950        STBD R74,X0,DFLAG 
0960        LDM  R74,=231,231,0,0
0970        STM  R74,R24
0980        LDM  R20,R12
0990        SBM  R20,=4,0
1000        CMMD R20,=TOS   
1010        JZR  DSAVE1
1020        JSB  =ONEI  
1030        LDM  R26,R45
1040        LDM  R20,R12
1050        SBM  R20,=4,0
1060        CMMD R20,=TOS   
1070        JZR  DSAVE1
1080        JSB  =ONEI  
1090        STM  R26,R24
1100        LDM  R26,R45
1110 DSAVE1 LDM  R74,R24
1120        STMD R74,=LLDCOM
1130        POMD R44,-R12
1140        PUMD R44,+R12
1150        PUMD R44,+R6
1160        LDMD R0,=BINTAB
1170        JSB  X0,MSROM?
1180        CMB  R17,=300
1190        JNC  DSAVED
1200        POMD R44,-R6
1210        RTN  
1220 DSAVED JEN  DSAVET
1230        LDMD R0,=BINTAB
1240        LDMD R14,=MSBASE
1250        CLB  R77
1260        ICB  R77
1270        STBD R77,X0,DFLAG 
1280        JSB  X0,DSAVC1
1290        JSB  =ROMJSB
1300        DEF  DIRSCN
1310        VAL  MSROM#
1320        JEN  DSAVD2
1330        JSB  =ROMJSB
1340        DEF  GETTYP
1350        VAL  MSROM#
1360        CMB  R30,=20
1370        JZR  DSAVD1
1380        POMD R44,-R6
1390        JSB  =TAPEXT
1400        JSB  =ERROR+
1410        BYT  68D
1420        RTN  
1430 DSAVD1 JSB  =ROMJSB
1440        DEF  TYPOK2
1450        VAL  MSROM#
1460        JMP  DSAVD3
1470 DSAVET JMP  SAVET1
1480 DSAVD2 LDMD R0,=BINTAB
1490        JSB  X0,CALCSZ
1500        POMD R44,-R6
1510        PUMD R44,+R6
1520        PUMD R44,+R12
1530        LDMD R0,=BINTAB
1540        JSB  X0,CRFIL 
1550        JSB  =ROMJSB
1560        DEF  MSCRE.
1570        VAL  MSROM#
1580        JMP  ASINIT
1590 DSAVD3 LDMD R0,=BINTAB
1600        STMD R36,X0,CURSIZ
1610        JSB  X0,CALCSZ
1620        LDBD R67,=R60K  
1630        PUBD R67,+R6
1640        LDB  R67,=320
1650        STBD R67,=RSELEC
1660        LDMD R36,=BINTAB
1670        LDMD R36,X36,CURSIZ
1680        DRP  R34
1690        JSB  =LDRECS
1700        POBD R67,-R6
1710        STBD R67,=RSELEC
1720        SBM  R34,R32
1730        JCY  ASINIT
1740        POMD R44,-R6
1750        PUMD R44,+R6
1760        PUMD R44,+R12
1770        JSB  =ROMJSB
1780        DEF  MSPUR.
1790        VAL  MSROM#
1800        JMP  DSAVD2
1810 ASINIT LDMD R0,=BINTAB
1820        JSB  X0,ASNPRT
1830        LDMD R0,=BINTAB
1840        JSB  X0,PRNTIT
1850        JSB  =ROMJSB
1860        DEF  PREOL.
1870        VAL  MSROM#
1880        JSB  =ROMJSB
1890        DEF  ASSIG.
1900        VAL  MSROM#
1910        JMP  CONFI1
1920 TAPERR POMD R44,-R6
1930        RTN  
1940 SAVET1 LDMD R0,=BINTAB
1950        JSB  X0,DSAVC1
1960        BIN  
1970        LDM  R0,R6
1980        ICM  R0
1990        ICM  R0
2000        STMD R0,=SAVER6
2010        JSB  =GETNAM
2020        JSB  =TAPINT
2030        CMB  R17,=300
2040        JCY  TAPERR
2050        JSB  =WPR?  
2060        CMB  R17,=300
2070        JCY  TAPERR
2080        JSB  =DSCAN 
2090        LDMD R0,=BINTAB
2100        JEZ  GOTNAM
2110 SAVET2 JSB  X0,CALCSZ
2120        POMD R44,-R6
2130        PUMD R44,+R6
2140        PUMD R44,+R12
2150        LDMD R0,=BINTAB
2160        JSB  X0,CRFIL 
2170        JSB  =CREAT.
2180        JSB  =DSCAN 
2190        STMD R36,=AVAILP
2200        LDMD R36,X36,D.#R/F
2210        STMD R36,=R/FILE
2220        JMP  TASIGN
2230 CONFI1 JMP  COMFIN
2240 GOTNAM POMD R44,-R6
2250        PUMD R44,+R6
2260        STMD R36,=AVAILP
2270        JSB  X0,CALCSZ
2280        LDMD R36,=AVAILP
2290        LDMD R36,X36,D.#R/F
2300        STMD R36,=R/FILE
2310        CMM  R36,R32
2320        JCY  TASIGN
2330        POMD R44,-R6
2340        PUMD R44,+R6
2350        PUMD R44,+R12
2360        JSB  =PURGE.
2370        JMP  SAVET2
2380 TASIGN POMD R44,-R6
2390        STMD R6,=SAVER6
2400        CLM  R40
2410        LDB  R47,=20
2420        PUMD R40,+R12
2430        LDM  R46,=6,0
2440        PUMD R46,+R12
2450        LDM  R46,=SAVNAM
2460        PUMD R46,+R12
2470        JSB  =ASIGN.
2480        CLM  R40
2490        LDB  R47,=20
2500        PUMD R40,+R12
2510        JSB  =PRNT#.
2520        LDMD R0,=BINTAB
2530        JSB  X0,PRNTIT
2540        JSB  =PRLINE
2550        JSB  =ASIGN.
2560 COMFIN LDMD R0,=BINTAB
2570        LDMD R71,X0,MYTRFC
2580        STMD R71,=IOTRFC
2590        LDMD R70,X0,MYSC  
2600        STMD R70,=SCTEMP
2610        JSB  X0,OUTMES
2620        RTN  
2630 DSAVC1 LDB  R0,=1
2640        JSB  =SECUR?
2650        JEZ  DSAVC2
2660        POMD R42,-R6
2670 DSAVC2 RTN  
2680 CALCSZ CLM  R40
2690        STMD R40,=SCTEMP
2700        STMD R46,=NXTDAT
2710        LDM  R46,=COUNTS
2720        BIN  
2730        ADMD R46,=BINTAB
2740        STM  R46,R45
2750        LDB  R47,=236
2760        LDB  R44,=316
2770        STMD R44,=IOTRFC
2780        PUMD R16,+R6
2790        LDB  R16,=2
2800        JSB  =LSSET 
2810        POMD R16,-R6
2820        CLB  R34
2830        LDMD R32,=NXTDAT
2840        JZR  CALCS1
2850        ADM  R32,R33
2860        ADM  R32,R33
2870        ADM  R32,R33
2880        ADM  R32,=3,0
2890        JSB  =GETCN+
2900 CALCS1 RTN  
2910 COUNTS BIN  
2920        ADM  R36,=4,0
2930        LDMD R46,=NXTDAT
2940        JNZ  COUNT1
2950        LDMD R44,=LLDCOM
2960        STMD R44,=LSTDAT
2970        CLM  R46
2980 COUNT1 ADM  R#,R36
2990        STMD R#,=NXTDAT
3000        RTN  
3010 CRFIL  LDM  R36,R32
3020        JSB  =CONBIN
3030        PUMD R40,+R12
3040        CLM  R50
3050        LDB  R54,=377
3060        LDM  R55,=56C,2C,0
3070        PUMD R50,+R12
3080        RTN  
3090 PRNTIT LDMD R44,=LSTDAT
3100        STMD R44,=LLDCOM
3110        LDM  R36,=SAVREC
3120        BIN  
3130        ADMD R36,=BINTAB
3140        STM  R36,R45
3150        LDB  R47,=236
3160        LDB  R44,=316
3170        STMD R44,=IOTRFC
3180        PUMD R16,+R6
3190        LDB  R16,=2
3200        JSB  =LSSET 
3210        POMD R16,-R6
3220 CLOSE  CLM  R40
3230        LDB  R47,=20
3240        PUMD R40,+R12
3250        LDM  R46,=1,0
3260        PUMD R46,+R12
3270        LDM  R46,=STAR  
3280        PUMD R46,+R12
3290        RTN  
3300 SAVREC STM  R36,R44
3310        STM  R26,R46
3320        LDMD R0,=BINTAB
3330        LDBD R0,X0,DFLAG 
3340        JZR  SAVTAP
3350        PUMD R44,+R12
3360        JSB  =ROMJSB
3370        DEF  PRSTR.
3380        VAL  MSROM#
3390        RTN  
3400 SAVTAP JSB  =PRNT#$
3410        RTN  
3420        BYT  141
3430 DGET.  BIN  
3440        LDMD R0,=BINTAB
3450        CLB  R44
3460        STBD R44,X0,DFLAG 
3470        POMD R44,-R12
3480        PUMD R44,+R12
3490        PUMD R44,+R6
3500        JSB  X0,MSROM?
3510        JSB  X0,ERROR?
3520        JEN  DGETT 
3530        CLB  R44
3540        ICB  R44
3550        STBD R44,X0,DFLAG 
3560        POMD R44,-R12
3570        JSB  X0,ASNPRT
3580 DGETD1 LDMD R0,=BINTAB
3590        JSB  X0,GETLIN
3600        LDBD R77,=ERRORS
3610        JNZ  GETDON
3620        LDMD R0,=BINTAB
3630        JSB  X0,READIT
3640        LDB  R16,=1
3650 DGET0  JMP  DGETD1
3660 GETDON JSB  X0,CLOSIT
3670        LDB  R40,=107
3680        CMBD R40,=ERNUM#
3690        JZR  EOFERR
3700        LDB  R40,=110
3710        CMBD R40,=ERNUM#
3720        JNZ  BADERR
3730 EOFERR CLM  R40
3740        STMD R40,=ERLIN#
3750        ANM  R17,=77
3760 BADERR JSB  =SET240
3770        LDMD R12,=NXTMEM
3780        STMD R12,=STSIZE
3790        STMD R12,=TOS   
3800        JSB  =TAPEXT
3810        CLB  R16
3820 OUTMES LDM  R26,=MESAGE
3830        ADMD R26,=BINTAB
3840        LDM  R36,=4,0
3850        JSB  =OUTSTR
3860        RTN  
3870 MESAGE ASC  "DONE"
3880 DGETT  POMD R44,-R12
3890        STMD R12,=TOS   
3900        CLM  R50
3910        LDB  R57,=20
3920        PUMD R50,+R12
3930        POMD R44,-R6
3940        PUMD R44,+R12
3950        JSB  =ASIGN.
3960        LDMD R0,=BINTAB
3970        JSB  X0,ERROR?
3980        CLM  R40
3990        LDB  R47,=20
4000        PUMD R40,+R12
4010        JSB  =PRNT#.
4020        JMP  DGET0 
4030 CLOSIT JSB  X0,CLOSE 
4040        LDBD R20,X0,DFLAG 
4050        JZR  TAPCLO
4060        JSB  =ROMJSB
4070        DEF  ASSIG.
4080        VAL  MSROM#
4090        RTN  
4100 TAPCLO JSB  =ASIGN.
4110        RTN  
4120 ERROR? CMB  R17,=300
4130        JNC  ERRRTN
4140        POMD R20,-R6
4150 ERRRTN RTN  
4160 MSROM? CLE  
4170        ICE  
4180        LDM  R20,=ROMTAB
4190 MSROM1 POMD R24,+R20
4200        CMB  R24,=377
4210        JZR  MSRTN 
4220        CMB  R24,=320
4230        JNZ  MSROM1
4240        CLE  
4250        JSB  =ROMJSB
4260        DEF  MSIN  
4270        VAL  MSROM#
4280        LDM  R30,R6
4290        ADM  R30,=7,0
4300        STMD R30,=SAVER6
4310        JSB  =ROMJSB
4320        DEF  TAPDS-
4330        VAL  MSROM#
4340        JEZ  MSRTN 
4350        POMD R56,-R6
4360        POMD R44,-R6
4370        POMD R44,-R12
4380        PUMD R44,+R12
4390        PUMD R44,+R6
4400        PUMD R56,+R6
4410 MSRTN  RTN  
4420 ASNPRT STMD R12,=TOS   
4430        CLM  R50
4440        LDB  R57,=20
4450        PUMD R50,+R12
4460        POMD R76,-R6
4470        POMD R44,-R6
4480        PUMD R44,+R12
4490        STMD R6,=SAVER6
4500        PUMD R76,+R6
4510        JSB  =ROMJSB
4520        DEF  ASSIG.
4530        VAL  MSROM#
4540        CLM  R40
4550        LDB  R47,=20
4560        PUMD R40,+R12
4570        JSB  =ROMJSB
4580        DEF  PRINT.
4590        VAL  MSROM#
4600        RTN  
4610 GETLIN LDM  R26,=BUFFER
4620        BIN  
4630        ADM  R26,R0
4640        PUMD R26,+R12
4650        LDM  R24,=212,1
4660        PUMD R24,+R26
4670        CLB  R24
4680        PUMD R24,+R12
4690        PUMD R24,+R26
4700        PUMD R24,+R26
4710        CLM  R24
4720        PUMD R24,+R26
4730        PUMD R26,+R12
4740        STMD R26,X0,BUFADR
4750        LDBD R26,X0,DFLAG 
4760        JZR  TAPRED
4770        JSB  =ROMJSB
4780        DEF  RDSTR.
4790        VAL  MSROM#
4800        RTN  
4810 TAPRED JSB  =READ#$
4820        RTN  
4830 READIT LDMD R0,=BINTAB
4840        LDMD R26,X0,BUFADR
4850        BIN  
4860        POMD R24,-R26
4870        STMD R24,X0,BUFLEN
4880        PUMD R24,+R26
4890        LDM  R30,=INPBUF
4900        LDB  R32,=BLANK 
4910        PUBD R32,+R30
4920 READ1  POBD R32,+R26
4930        PUBD R32,+R30
4940        DCM  R24
4950        JNZ  READ1 
4960        LDB  R24,=CR    
4970        PUBD R24,+R30
4980        CLB  R24
4990        PUBD R24,+R6
5000 PRSIT1 LDM  R10,=INPBUF
5010        STMD R10,=SAVR10
5020        JSB  =GCHAR 
5030        JSB  =INTEGR
5040        BIN  
5050        JEN  GOTLN#
5060 BADLIN LDMD R0,=BINTAB
5070        JSB  X0,PRNTLN
5080 LINDON BIN  
5090        DCM  R6
5100        RTN  
5110 GOTLN# CMB  R20,=CR    
5120        JZR  BADLIN
5130        CLB  R16
5140        JSB  =P.PARS
5150        LDB  R16,=1
5160        TSB  R17
5170        JPS  LINDON
5180        POBD R36,-R6
5190        ICB  R36
5200        PUBD R36,+R6
5210        JEV  LINDON
5220        ANM  R17,=77
5230        CLM  R40
5240        STMD R40,=ERLIN#
5250        LDM  R10,=INPBUF
5260        LDM  R36,R10
5270        ICM  R36
5280 MOVE-1 POBD R20,+R36
5290        PUBD R20,+R10
5300        CMB  R20,=BLANK 
5310        JZR  MOVE-1
5320        JSB  =DIGIT 
5330        JEN  MOVE-1
5340        LDB  R20,=BANG  
5350        PUBD R20,-R10
5360        LDMD R0,=BINTAB
5370        JSB  X0,PRNTLN
5380        JMP  PRSIT1
5390 PRNTLN JSB  =PRINTP
5400        LDMD R36,X0,BUFLEN
5410        LDMD R26,X0,BUFADR
5420        JSB  =DRV12.
5430        RTN  
5440 DFLAG  BSZ  1
5450 CURSIZ BSZ  2
5460 MYTRFC BSZ  7
5470 MYSC   BSZ  10
5480 BUFFER BSZ  300
5490 BUFADR BSZ  2
5500 BUFLEN BSZ  2
5510 OUTSTR DAD  35052
5520 STREX+ DAD  13623
5530 PRLINE DAD  70402
5540 PREOL. DAD  70073
5550 PRINT. DAD  66312
5560 SEQ#   DAD  17473
5570 PUSH32 DAD  14277
5580 ERROR+ DAD  6611
5590 BINTAB DAD  101233
5600 PRINTP DAD  70067
5610 CREAT. DAD  26561
5620 STAR   DAD  24470
5630 LLDCOM DAD  100025
5640 PRNT#$ DAD  30577
5650 ASIGN. DAD  27056
5660 SAVER6 DAD  101174
5670 GETNAM DAD  26511
5680 TAPINT DAD  24466
5690 WPR?   DAD  20325
5700 DSCAN  DAD  22516
5710 AVAILP DAD  100160
5720 D.#R/F EQU  10
5730 R/FILE DAD  101040
5740 SCTEMP DAD  101110
5750 ONEI   DAD  56154
5760 TOS    DAD  101132
5770 NXTDAT DAD  101010
5780 IOTRFC DAD  102400
5790 SECUR? DAD  37602
5800 LSSET  DAD  5224
5810 TAPEXT DAD  22000
5820 CONBIN DAD  3572
5830 SAVNAM DAD  101120
5840 LSTDAT DAD  101012
5850 GINTDS DAD  177401
5860 GINTEN DAD  177400
5870 ROMJSB DAD  4776
5880 LWAMEM DAD  100022
5890 LAVAIL DAD  100010
5900 MOVDN  DAD  37324
5910 MSBASE DAD  102540
5920 R60K   DAD  60000
5930 RSELEC DAD  177430
5940 SCAN   DAD  11262
5950 NXTMEM DAD  100006
5960 STSIZE DAD  101130
5970 SET240 DAD  11243
5980 ERNUM# DAD  100064
5990 ERLIN# DAD  100062
6000 STBEEP DAD  7017
6010 ROMTAB DAD  101235
6020 MSIN   DAD  70253
6030 MSROM# EQU  320
6040 TAPDS- DAD  70740
6050 DIRSCN DAD  63143
6060 GETTYP DAD  61716
6070 TYPOK2 DAD  64157
6080 MSCRE. DAD  65256
6090 LDRECS DAD  63574
6100 MSPUR. DAD  64461
6110 ASSIG. DAD  65571
6120 PRST+  DAD  66762
6130 PRSTR. DAD  66753
6140 PURGE. DAD  26013
6150 PRNT#. DAD  30055
6160 GETCN+ DAD  23416
6170 RSMEM- DAD  37453
6180 RDSTR. DAD  67446
6190 READ#$ DAD  31335
6200 INPBUF DAD  100310
6210 BLANK  EQU  40
6220 CR     EQU  15
6230 RELMEM DAD  37534
6240 SAVR10 DAD  101227
6250 GCHAR  DAD  11755
6260 INTEGR DAD  11447
6270 DRV12. DAD  5462
6280 P.PARS DAD  10646
6290 DIGIT  DAD  12027
6300 BANG   EQU  41
6310 ERRORS DAD  100070
6320        FIN  
