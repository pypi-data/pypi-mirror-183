0010        NAM  PIVOT 
0020        DEF  RUNTIM
0030        DEF  TOKENS
0040        DEF  BASIC 
0050        DEF  ERMSG 
0060        DEF  INIT  
0070 RUNTIM BYT  0,0
0080        DEF  PIVOT.
0090        DEF  UNL.  
0100 BASIC  BYT  0,0
0110        DEF  PIVOTP
0120        DEF  UNLPRS
0130        BYT  377,377
0140 TOKENS ASP  "PIVOT"
0150        ASP  "UNLOADBP"
0160        BYT  377
0170 ERMSG  BYT  200
0180        BYT  241
0190 PIVOT. JSB  =ONEB  
0200        LDMD R14,=BINTAB
0210        STMD R46,X14,I     
0220        JSB  =ONEB  
0230        STMD R46,X14,B     
0240        JSB  =ONEB  
0250        STMD R46,X14,C     
0260        JSB  =ONEB  
0270        STMD R46,X14,R     
0280        POMD R44,-R12
0290        POMD R52,+R44
0300        LDM  R32,R44
0310        STM  R32,R24
0320        LLM  R56
0330        LLM  R56
0340        LLM  R56
0350        STM  R56,R20
0360        LDMD R30,X14,I     
0370 MAIN   LDMD R34,X#,R     
0380        CMM  R34,R30
0390        JZR  AJMP  
0400        LDMD R34,X14,C     
0410        JSB  X14,FETCH 
0420        LDMD R40,R32
0430        STMD R40,X14,V     
0440        STMD R32,X14,AI.C  
0450        LDMD R30,X14,I     
0460        LDMD R34,X14,B     
0470        JSB  X14,FETCH 
0480        STMD R#,X14,AI.B  
0490        LDMD R30,X14,R     
0500        JSB  X14,FETCH+
0510        STMD R#,X14,AR.B  
0520        LDMD R26,X14,B     
0530 LOOPJ  LDMD R36,X#,C     
0540        CMM  R26,R36
0550        JZR  BETA  
0560        LDMD R54,X14,AI.B  
0570        LDMD R40,R54
0580        PUMD R40,+R12
0590        LDMD R40,R56
0600        PUMD R40,+R12
0610        LDMD R40,X14,V     
0620        PUMD R40,+R12
0630        BCD  
0640        JSB  =MPYROI
0650        JSB  =SUBROI
0660        POMD R40,-R12
0670        JZR  CLMR40
0680        BIN  
0690        CMB  R44,=377
0700        JNZ  NOTINT
0710        TSM  R45
0720        JZR  CLMR40
0730        JMP  STORE 
0740 AJMP   JMP  ALPHA 
0750 MJMP   JMP  MAIN  
0760 NOTINT BCD  
0770        LDM  R30,R40
0780        LRB  R31
0790        CMB  R31,=5
0800        JNC  STORE 
0810        CMM  R30,=94C,9C
0820        JCY  STORE 
0830 CLMR40 CLM  R40
0840 STORE  BIN  
0850        LDMD R14,=BINTAB
0860        LDMD R30,X14,AI.B  
0870        STMD R40,R30
0880 BETA   DCM  R26
0890        JZR  QUIT  
0900        LDMD R44,X14,AI.B  
0910        SBM  R44,=10,0,10,0
0920        STMD R44,X14,AI.B  
0930        JMP  LOOPJ 
0940 QUIT   CLM  R40
0950        LDMD R34,X14,AI.C  
0960        STMD R40,R34
0970 ALPHA  LDMD R30,X14,I     
0980        DCM  R30
0990        JZR  END   
1000        STMD R30,X14,I     
1010        JMP  MJMP  
1020 END    RTN  
1030 FETCH  DCM  R#
1040        LLM  R#
1050        LLM  R#
1060        LLM  R#
1070 FETCH+ LDM  R32,R34
1080 DCMR30 DCM  R30
1090        JZR  FETCHV
1100        ADM  R32,R20
1110        JMP  DCMR30
1120 FETCHV ADM  R32,R24
1130 INIT   RTN  
1150 PIVOTP JSB  =SCAN  
1160        JSB  =FORMAR
1170        JEZ  NOARRY
1180        JSB  =GET4N 
1190        POBD R30,-R12
1200        LDM  R45,=371,0,1
1210        PUMD R45,+R12
1220 NOARRY RTN  
1230 ! ************************
1240 UNLPRS LDM  R45,=371,0,2
1250        PUMD R45,+R12
1260        JSB  =SCAN  
1270        RTN  
1280 ! ************************
1290 I      BYT  0,0
1300 B      BYT  0,0
1310 C      BYT  0,0
1320 R      BYT  0,0
1330 BASE   BYT  0,0
1340 COL    BYT  0,0
1350 AI.B   BYT  0,0
1360 AR.B   BYT  0,0
1370 AI.C   BYT  0,0
1380 J      BYT  0,0
1390 V      BYT  0,0,0,0,0,0,0,0
1400 ! ************************
1410        BYT  241
1420 UNL.   BIN  
1430        STBD R#,=GINTDS
1440        LDMD R24,=BINTAB
1450        DCM  R24
1460        LDMD R26,=LWAMEM
1470        STM  R26,R22
1480        SBM  R22,R24
1490        LDB  R20,=4
1500        LDM  R32,=LAVAIL
1510 UNLOOP LDMD R36,R32
1520        ADM  R36,R22
1530        PUMD R36,+R32
1540        DCB  R20
1550        JNZ  UNLOOP
1560        LDMD R36,R32
1570        CMMD R36,=LWAMEM
1580        JZR  UNLLLL
1590        ADM  R36,R22
1600        STMD R36,R32
1610 UNLLLL CLM  R#
1620        STMD R#,=BINTAB
1630        LDM  R#,R12
1640        LDM  R41,=316
1650        DEF  MOVDN 
1660        STBD R#,=GINTEN
1670        RTN  
1680        STMD R#,R36
1690        DCM  R36
1700        LDM  R4,R36
1710 BINTAB DAD  101233
1720 ONEB   DAD  56113
1730 LWAMEM DAD  100022
1740 LAVAIL DAD  100010
1750 GINTEN DAD  177400
1760 GINTDS DAD  177401
1770 MOVDN  DAD  37324
1780 SCAN   DAD  11262
1790 MPYROI DAD  52722
1800 SUBROI DAD  52127
1810 GET4N  DAD  14414
1820 FORMAR DAD  16317
9990        FIN  
