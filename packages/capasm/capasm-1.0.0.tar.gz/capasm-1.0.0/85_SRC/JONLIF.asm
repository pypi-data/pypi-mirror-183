0010        NAM  LIFE  
0020        DEF  RUNTIM
0030        DEF  ASCIIS
0040        DEF  PARSE 
0050        DEF  ERMSG 
0060        DEF  INIT  
0070 PARSE  OCT  0,0
0080        DEF  GENP  
0090        DEF  GENP  
0100        DEF  GENP  
0110 RUNTIM OCT  0,0
0120        DEF  RGEN  
0130        DEF  NGEN  
0140        DEF  WGEN  
0150        OCT  377,377
0160 ASCIIS ASP  "RGEN"
0170        ASP  "NGEN"
0180        ASP  "WGEN"
0190        OCT  377
0200 GENP   LDB  R36,=371
0210        PUBD R36,+R12
0220        PUBD R43,+R12
0230        PUBD R43,+R12
0240        JSB  =SCAN  
0250        RTN  
0260 ERMSG  OCT  200
0270 INIT   RTN  
0280 INCHR  DAD  35244
0290 SCAN   DAD  11262
0300 CHKSTS DAD  36335
0310 CRTBAD DAD  177405
0320 CRTDAT DAD  177407
0330 BINTAB DAD  101233
0340        OCT  241
0350 RGEN   BIN  
0360        LDMD R36,=BINTAB
0370        LDM  R20,=DATA  
0380        ADM  R20,R36
0390        LDM  R24,=0,20
0400        LDB  R26,=300
0410 NR     LDB  R27,=40
0420 NN     JSB  =CHKSTS
0430        STMD R24,=CRTBAD
0440        JSB  =INCHR 
0450        ICM  R24
0460        ICM  R24
0470        STMD R32,R20
0480        ICM  R20
0490        DCB  R27
0500        JNZ  NN    
0510        ICM  R24
0520        DCB  R26
0530        JNZ  NR    
0540        JMP  P1    
0550        OCT  241
0560 NGEN   BIN  
0570        LDMD R36,=BINTAB
0580        LDM  R20,=DATA  
0590        ADM  R20,R36
0600        LDM  R22,=ACCUM1
0610        ADM  R22,R36
0620 NEXT3R LDM  R30,=2,1
0630        CLB  R32
0640        STM  R22,R34
0650 MORE   PUBD R32,+R34
0660        DCM  R30
0670        JNZ  MORE  
0680        LDB  R26,=3
0690 NEXTR  LDB  R27,=40
0700 NEXTD  POBD R32,+R20
0710        LDMD R34,R22
0720        ADM  R22,=2,0
0730        LDMD R40,R22
0740        TSB  R32
0750        JZR  NOT0  
0760        LLB  R32
0770        JNC  NOT7  
0780        ICB  R34
0790        ICB  R35
0800        ICB  R40
0810 NOT7   LLB  R32
0820        JNC  NOT6  
0830        ICB  R35
0840        ICB  R40
0850        ICB  R41
0860 NOT6   LLB  R32
0870        JNC  NOT5  
0880        ICB  R40
0890        ICB  R41
0900        ICB  R42
0910 NOT5   LLB  R32
0920        JNC  NOT4  
0930        ICB  R41
0940        ICB  R42
0950        ICB  R43
0960 NOT4   LLB  R32
0970        JNC  NOT3  
0980        ICB  R42
0990        ICB  R43
1000        ICB  R44
1010 NOT3   LLB  R32
1020        JNC  NOT2  
1030        ICB  R43
1040        ICB  R44
1050        ICB  R45
1060 NOT2   LLB  R32
1070        JNC  NOT1  
1080        ICB  R44
1090        ICB  R45
1100        ICB  R46
1110 NOT1   LLB  R32
1120        JNC  NOT0  
1130        ICB  R45
1140        ICB  R46
1150        ICB  R47
1160        JMP  NOT0  
1170 P1     JMP  P2    
1180 PASS2  JMP  NEXT3R
1190 NOT0   PUMD R40,+R22
1200        SBM  R22,=12,0
1210        PUMD R34,+R22
1220        ADM  R22,=6,0
1230        DCB  R27
1240        JNZ  NEXTD 
1250        SBM  R22,=0,1
1260        DCB  R26
1270        JNZ  NEXTR 
1280        JMP  SKIP  
1290 P2     JMP  CLEAN 
1300 SKIP   ADM  R22,=2,1
1310        LDM  R34,=ACCUM2
1320        ADM  R34,R36
1330        CMM  R34,R22
1340        JZR  OUTNEW
1350        SBM  R22,=4,2
1360 OUTNEW SBM  R20,=140,0
1370        ICM  R22
1380        LDB  R26,=40
1390 NEXTW  LDB  R27,=10
1400        LDB  R34,=200
1410        LDB  R35,=177
1420        POBD R33,+R20
1430 NEXTB  POBD R32,+R22
1440        CMB  R32,=3
1450        JNZ  NO3   
1460        ORB  R33,R34
1470        JMP  CONT  
1480 PASS1  JMP  PASS2 
1490 NO3    CMB  R32,=4
1500        JZR  CONT  
1510        ANM  R33,R35
1520 CONT   LRB  R34
1530        LRB  R35
1540        ADB  R35,=200
1550        DCB  R27
1560        JNZ  NEXTB 
1570        PUBD R33,-R20
1580        ICM  R20
1590        DCB  R26
1600        JNZ  NEXTW 
1610        SBM  R22,=1,1
1620        LDM  R34,=DATA  
1630        ADM  R34,R36
1640        ADM  R34,=340,27
1650        CMM  R34,R20
1660        JNZ  PASS1 
1670        LDM  R22,=ACCUM1
1680        ADM  R22,R36
1690        LDM  R30,=4,2
1700        CLB  R32
1710 CACCS  PUBD R32,+R22
1720        DCB  R30
1730        JNZ  CACCS 
1740 CLEAN  LDM  R20,=DATA  
1750        ADM  R20,R36
1760        CLB  R32
1770        LDB  R27,=40
1780 CFRW   PUBD R32,+R20
1790        DCB  R27
1800        JNZ  CFRW  
1810        ADM  R20,=276,0
1820        LDB  R27,=40
1830 CLRW   PUBD R32,+R20
1840        DCB  R27
1850        JNZ  CLRW  
1860        SBM  R20,=340,27
1870        LDB  R27,=276
1880 CLCL   PUBD R32,+R20
1890        ADM  R20,=37,0
1900        DCB  R27
1910        JNZ  CLCL  
1920        SBM  R20,=301,27
1930        LDB  R27,=276
1940 CRCL   PUBD R32,+R20
1950        ADM  R20,=37,0
1960        DCB  R27
1970        JNZ  CRCL  
1980        RTN  
1990        OCT  241
2000 WGEN   LDMD R36,=BINTAB
2010        LDM  R20,=DATA  
2020        ADM  R20,R36
2030        ADM  R20,=41,0
2040        LDM  R24,=102,20
2050        LDB  R26,=276
2060 OUTROW LDB  R27,=36
2070        JSB  =CHKSTS
2080        STMD R24,=CRTBAD
2090 OUTBYT POBD R33,+R20
2100        JSB  =CHKSTS
2110        STBD R33,=CRTDAT
2120        ADM  R24,=2,0
2130        DCB  R27
2140        JNZ  OUTBYT
2150        ADM  R24,=4,0
2160        ADM  R20,=2,0
2170        DCB  R26
2180        JNZ  OUTROW
2190        RTN  
2200 ACCUM1 BSZ  402
2210 ACCUM2 BSZ  402
2220 DATA   BSZ  14000
2230        FIN  
