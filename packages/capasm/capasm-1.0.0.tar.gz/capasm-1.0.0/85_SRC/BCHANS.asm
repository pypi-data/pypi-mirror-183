0010        NAM  BCHAIN
0020        DEF  RUNTIM
0030        DEF  ASCIIS
0040        DEF  PARSE 
0050        DEF  ERMSG 
0060 RUNTIM DEF  INIT  
0070        DEF  BCHAN.
0080 PARSE  DEF  SCRTB.
0090        DEF  BCHANP
0100        DEF  SCRTBP
0110        BYT  377,377
0120 ASCIIS ASP  "BCHAIN"
0130        ASP  "SCRATCHBIN"
0140 ERMSG  BYT  377,377
0150 BCHANP PUBD R43,+R6
0160        JSB  =STREX+
0170        JEZ  ERROR!
0180        POBD R47,-R6
0190        LDB  R45,=371
0200        PUMD R45,+R12
0210 INIT   RTN  
0220 ERROR! POBD R43,-R6
0230        JSB  =ERROR+
0240        BYT  130
0250 SCRTBP LDB  R47,R43
0260        LDB  R45,=371
0270        PUMD R45,+R12
0280        JSB  =SCAN  
0290        RTN  
0300 !  ***********************
0310        BYT  241
0320 BCHAN. BIN  
0330        JSB  =SETTR1
0340        LDMD R56,=FWPRGM
0350        STMD R56,=FWCURR
0360        LDM  R20,=ROMTAB
0370 ROMLOP POMD R24,+R20
0380        CMB  R24,=377
0390        JZR  BCHANT
0400        CMB  R24,=320
0410        JNZ  ROMLOP
0420        CLE  
0430        JSB  =ROMJSB
0440        DEF  MSIN  
0450        BYT  320
0460        LDM  R30,R6
0470        ADM  R30,=7,0
0480        STMD R30,=SAVER6
0490        JSB  =ROMJSB
0500        DEF  TAPDS-
0510        BYT  320
0520        JEN  BCHANT
0530        JSB  =ROMJSB
0540        DEF  MCALTP
0550        BYT  320
0560        JMP  CHAIN+
0570 BCHANT JSB  =GETNAM
0580        JSB  =CALTAP
0590 CHAIN+ BSZ  0
0600        CMB  R17,=300
0610        JCY  CHNRTN
0620        PUBD R16,+R6
0630        CLB  R16
0640        JSB  =ALLOC 
0650        STMD R12,=TOS   
0660        POBD R16,-R6
0670        JEN  CHNRTN
0680        LDMD R36,=FWPRGM
0690        LDBD R34,X36,P.TYPE
0700        JEV  MAIN  
0710        JSB  =ERROR+
0720        BYT  31D
0730 MAIN   LDMD R56,X36,P.COM 
0740        SBM  R36,R56
0750        CMMD R36,=FWUSER
0760        JZR  MAIN1 
0770        JSB  =ERROR+
0780        BYT  32D
0790 MAIN1  JSB  =INIVAR
0800        LDBD R22,=TRCFL2
0810        JZR  MAIN1A
0820        JSB  =TRVRBL
0830 MAIN1A LDB  R36,=7
0840        STBD R36,=ROMFL 
0850        JSB  =ROMINI
0860        JSB  =RSETG-
0870        STBD R40,=CONTOK
0880        LDMD R34,=FWBIN 
0890        STMD R34,=NXTRTN
0900        JSB  =ASIGNL
0910        STMD R22,=LAVAIL
0920        STMD R22,=CALVRB
0930        JSB  =CUROPT
0940        ADM  R36,=P.GO  
0950        STMD R36,=OLDPCR
0960        STMD R36,=PCR   
0970        STM  R36,R10
0980        LDB  R16,=2
0990        ANM  R17,=376
1000        ADM  R10,=3,0
1010 CHNRTN RTN  
1020 !  ***********************
1030        BYT  241
1040 SCRTB. STBD R#,=GINTDS
1050        BIN  
1060        LDMD R24,=BINTAB
1070        DCM  R24
1080        LDMD R26,=LWAMEM
1090        STM  R26,R22
1100        SBM  R22,R24
1110        LDB  R20,=4
1120        LDM  R32,=LAVAIL
1130 SCRTB1 LDMD R36,R32
1140        ADM  R36,R22
1150        PUMD R36,+R32
1160        DCB  R20
1170        JNZ  SCRTB1
1180        LDMD R36,R32
1190        CMMD R36,=LWAMEM
1200        JZR  SCRTB2
1210        ADM  R36,R22
1220        STMD R36,R32
1230 SCRTB2 CLM  R#
1240        STMD R#,=BINTAB
1250        LDM  R#,R12
1260        LDM  R41,=316
1270        DEF  MOVDN 
1280        STBD R#,=GINTEN
1290        RTN  
1300        STMD R41,R36
1310        DCM  R36
1320        LDM  R4,R36
1330 !  I WON'T BE BAC
1340 STREX+ DAD  13623
1350 ERROR+ DAD  6611
1360 SCAN   DAD  11262
1370 SETTR1 DAD  2323
1380 GETNAM DAD  26511
1390 FWPRGM DAD  100002
1400 FWCURR DAD  100004
1410 CALTAP DAD  24170
1420 TOS    DAD  101132
1430 P.TYPE EQU  6
1440 P.COM  EQU  11
1450 FWUSER DAD  100000
1460 INIVAR DAD  43670
1470 TRCFL2 DAD  100032
1480 TRVRBL DAD  2224
1490 ROMFL  DAD  101231
1500 ROMINI DAD  4650
1510 RSETG- DAD  4554
1520 CONTOK DAD  100024
1530 FWBIN  DAD  100020
1540 NXTRTN DAD  100016
1550 ASIGNL DAD  27406
1560 LAVAIL DAD  100010
1570 CALVRB DAD  100012
1580 CUROPT DAD  44500
1590 P.GO   EQU  30
1600 OLDPCR DAD  101020
1610 PCR    DAD  100642
1620 ALLOC  DAD  40034
1630 GINTDS DAD  177401
1640 BINTAB DAD  101233
1650 LWAMEM DAD  100022
1660 MOVDN  DAD  37324
1670 GINTEN DAD  177400
1680 ROMTAB DAD  101235
1690 MSIN   DAD  70253
1700 TAPDS- DAD  70740
1710 MCALTP DAD  63741
1720 SAVER6 DAD  101174
1730 ROMJSB DAD  4776
1740        FIN  
