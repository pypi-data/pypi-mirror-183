0005        LST  
0010        NAM  EKFILL
0020        DEF  RUNTIM
0030        DEF  TOKS  
0040        DEF  BASIC 
0050        DEF  ERMSG 
0060        DEF  INIT  
0070 RUNTIM OCT  0,0
0080        DEF  FILL  
0090        DEF  CURSR.
0100 BASIC  OCT  0,0
0110        DEF  FILPRS
0120        OCT  377,377
0130 TOKS   ASC  3,FILL
0140        OCT  314
0150        ASC  3,BIT
0160        OCT  240
0170 ERMSG  OCT  377
0180 INIT   RTN  
0190        OCT  40,55
0200 CURSR. JSB  =MOVE. 
0210        CLM  R45
0220        JEN  PUSH46
0230        JSB  =INCHR 
0240        BCD  
0250        LRB  R75
0260        BIN  
0270        LRB  R75
0280        LRB  R75
0290        JZR  TSBR32
0300 SHFR32 LLB  R32
0310        DCB  R75
0320        JNZ  SHFR32
0330 TSBR32 TSB  R32
0340        JPS  PUSH46
0350        ICM  R45
0360 PUSH46 LDB  R44,=377
0370        PUMD R40,+R12
0380 SOMRTN RTN  
0390 ! ***********************
0400 FILPRS PUMD R40,+R6
0410        JSB  =SCAN  
0420        JSB  =STRREF
0430        JEZ  ERR82 
0440        JSB  =GETCMA
0450        JSB  =NUMVAL
0460        JEZ  ERR82 
0470        POMD R40,-R6
0480        LDB  R42,=371
0490        PUBD R42,+R12
0500        PUBD R43,+R12
0510        PUBD R43,+R12
0520        RTN  
0530 ERR82  POMD R40,-R6
0540        JSB  =ERROR+
0550        OCT  121
0560 ! ***********************
0570        OCT  241
0580 FILL   JSB  =GRAF? 
0590        JSB  =ONEB  
0600        STM  R46,R44
0610        POMD R34,-R12
0615        POMD R22,-R12
0620        JZR  UNW1  
0630        LDBD R40,=PRMODE
0640        LRB  R40
0650        JEV  NOWPOT
0660        JSB  =CRTWPO
0670 NOWPOT LDMD R76,=XMAP  
0680 NXTB   CMM  R76,=374,277
0690        JCY  UNW   
0700        STMD R76,=XMAP  
0710        JSB  =DRAW1 
0720        LDM  R46,R44
0730 NXTFIL TSB  R40
0740        JEV  DISABL
0750        JSB  =INCHR-
0760        JMP  GOTBYT
0770 DISABL JSB  =INCHR 
0780 GOTBYT LDMD R76,=CRTGBA
0790        ADM  R76,=10,0
0800        STMD R76,=CRTGBA
0810        PUBD R32,+R34
0820        DCM  R22
0830        JNZ  CONTU 
0840        LDMD R76,=XMAP  
0850        ICB  R77
0860        CMM  R76,=0,300
0870        JCY  UNW   
0880        STMD R76,=XMAP  
0890 UNW    TSB  R40
0900        JEV  UNW1  
0910        JSB  =CRTUNW
0920 UNW1   POMD R66,-R12
0930        LDM  R36,R34
0940        JSB  =FETSVA
0950        LDMD R24,X34,FOUR  
0960        JPS  JMPP  
0970        CLM  R24
0980        STMD R24,X34,FOUR  
0990 JMPP   LDM  R26,=6,0
1000        ADM  R26,R34
1010        SBM  R36,R26
1020        CMM  R36,R24
1030        JNC  RTN   
1040        STMD R36,X34,FOUR  
1050 RTN    RTN  
1060 CONTU  DCM  R46
1070        JNZ  NXTFIL
1080        LDMD R76,=XMAP  
1090        ICB  R77
1100        JMP  NXTB  
1110 STRREF DAD  13753
1120 GETCMA DAD  13414
1130 NUMVAL DAD  12412
1140 ERROR+ DAD  6611
1150 GRAF?  DAD  32005
1160 ONEB   DAD  56113
1170 PRMODE DAD  100153
1180 CRTWPO DAD  35661
1190 XMAP   DAD  100262
1200 DRAW1  DAD  31757
1210 INCHR- DAD  35220
1220 INCHR  DAD  35244
1230 CRTGBA DAD  101104
1240 CRTUNW DAD  36067
1250 SCAN   DAD  11262
1260 FOUR   EQU  4
1270 FETSVA DAD  44556
1280 MOVE.  DAD  31703
1290        FIN  
