10 RESDAT   DAD 101026
20 CONBIN   DAD 612
30 ROUTE    DAD 101315
40 CHSROI   DAD 33660
50 NFR      DAD 35252
60 ROU10    DAD 36270
70 SEP10    DAD 36343
80 AXBUF    DAD 101022
90 RSMEM-   DAD 22037
100 DIV2     DAD 33553
110 AXINDX   DAD 101015
120 AXFLAG   DAD 101017
130 ERRBUF   DAD 100741
140 FORMN+   DAD 171543
150 DIV10    DAD 33556
160 GR.      DAD 47045
170 SUBROI   DAD 33712
180 REM10.   DAD 73377
190 MELJSB   DAD 43141
200 SYSJSB   DAD 43155
210 ROMJSB   DAD 43224
220 ATICNT   DAD 101020
230 STOP?    DAD 3046
240 ONEB     DAD 37213
250 ERR1+    DAD 46254
260 TWOR     DAD 36402
270 TWOB     DAD 37276
280 HANDLD   DAD 101565
290 S20-47   DAD 164020
300 EVIL     DAD 57360
310 PRNTLN   DAD 101314
320 PRLINE   DAD 162056
330 PRINT.   DAD 161630
340 STOSV    DAD 52630
350 ADDROI   DAD 33724
360 ERROM#   DAD 101575
370 ERRORS   DAD 101573
380 ATN2.    DAD 72364
390 COS10    DAD 34745
400 SIN10    DAD 34735
410 TOS      DAD 101127
420 SUBPNT   DAD 102212
430 ONEHUND  DAD 100D
440 SVCWRD   DAD 101204
450 ONER     DAD 37315
460 ERROR    DAD 46221
470 MOD10.   DAD 73405
480 TAN10    DAD 34755
490 SKPCHK   DAD 57212
500 TADREP   DAD 166017
510 SETUP    EQU 5
520 CHKEND   DAD 57215
530 THERE!   DAD 57175
540 UNLREP   DAD 165766
550 LADDEV   DAD 42776
560 UNTREP   DAD 166012
570 DATSD-   DAD 70012
580 NOATTN   DAD 102113
590 RDYSND   DAD 165430
600 NRD      EQU 41240
610 SDA      EQU 60240
620 V.REC    EQU 126D
630 V.RAST   EQU 127D
640 COPY     DAD 21347
650 LT.      DAD 47074
660 ONEI     DAD 37254
670 CVNUM    DAD 171532
680 SHRONF   DAD 35244
690 MPYROI   DAD 34475
700 STBEEP   DAD 177312
710 VAL.     DAD 176365
720 INFR4    DAD 35121
730 UT210    DAD 36413
740 SHF10    DAD 33611
750 ROUND    DAD 54501
760 HANDI0   DAD 52114
770 DEVOK    DAD 74060
780 FAST!    DAD 101306
790 DATREP   DAD 166044
800 V.SEND   EQU 125D
810 FOPEN    DAD 22240
820 PRINT    DAD 14276
830 REFNUM   DAD 13274
840 G1$OR*   DAD 55577
850 GETPAR   DAD 11144
860 SCAN     DAD 6243
870 NUMVA+   DAD 7155
880 FCRALO   DAD 20021
890 TYSYSM   DAD 0
900 V.ENDL   EQU 57D
910 V.CHAR   EQU 56D
920 V.VOLT   EQU 62D
930 V.COLD   EQU 0D
940 V.WARM   EQU 1D
950 RELMAR   DAD 177777
960 ZRO      DAD 0
970 TYNROM   EQU 82D
980 TYTOK?   EQU 1
990 RMHEAD   DAD 16343
1000 MYROM    DAD 60067
1010 ETE      EQU 40640
1020 ETO      EQU 40240
1030 ACTIVE   EQU 0
1040 GFLAG    EQU 1
1050 GP1X     EQU 3
1060 GP1Y     EQU 13
1070 GP2X     EQU 23
1080 GP2Y     EQU 33
1090 GXBGDU   EQU 43
1100 GYBGDU   EQU 53
1110 GXAGDU   EQU 63
1120 GYAGDU   EQU 73
1130 GXBUSR   EQU 103
1140 GYBUSR   EQU 113
1150 GXAUSR   EQU 123
1160 GYAUSR   EQU 133
1170 GPXLOC   EQU 143
1180 GPYLOC   EQU 153
1190 GOXLOC   EQU 163
1200 GOYLOC   EQU 173
1210 GSINPD   EQU 203
1220 GCOSPD   EQU 213
1230 GXHCL+   EQU 223
1240 GYHCL+   EQU 233
1250 GXHCL-   EQU 243
1260 GYHCL-   EQU 253
1270 GXSCL+   EQU 263
1280 GYSCL+   EQU 273
1290 GXSCL-   EQU 303
1300 GYSCL-   EQU 313
1310 GCHITE   EQU 323
1320 GCWIDE   EQU 333
1330 GSLANT   EQU 343
1340 GSINLD   EQU 353
1350 GCOSLD   EQU 363
1360 GXCURS   EQU 373
1370 GYCURS   EQU 403
1380 GNPUS    EQU 413
1390 GLBLFL   EQU 423
1400 GLBADD   EQU 424
1410 GLBLEN   EQU 426
1420 LAXNY    EQU 430
1430 LAXN     EQU 431
1440 TRASH    EQU 432
1450 PLTMP1   EQU 433
1460 PLTMP2   EQU 443
1470 PLTMP3   EQU 453
1480 PLTMP4   EQU 463
1490 PLTMP5   EQU 473
1500 PLTMP6   EQU 503
1510 PLTMP7   EQU 513
1520 LBLBUF   EQU 520
1530 CLPAB    EQU 523
1540 PCNTRL   EQU 525
1550 AXTIC1   EQU 0
1560 AXEND    EQU 10
1570 AXSPAC   EQU 20
1580 AXSTRT   EQU 30
1590 AYINTR   EQU 40
1600 AXSIZE   EQU 50
1610 AXMAJR   EQU 60
1620 AYTIC1   EQU 62
1630 AYEND    EQU 72
1640 AYSPAC   EQU 102
1650 AYSTRT   EQU 112
1660 AXINTR   EQU 122
1670 AYMAJR   EQU 142
1680 AX       EQU 144
1690 AY       EQU 154
1700 YINDX    EQU 62
1710          ABS 60000
1720          DEF RMHEAD             !
1730          DEF PLTROM             !
1740          BYT 356,32             !
1750          VAL TYTOK?             !
1760          VAL TYNROM             !
1770          BYT 234,40,12,300      !
1780          ASC "PLOTTERS"         !
1790          DEF ZRO                !
1800 PLTROM   DEF MYROM              !
1810          DEF RUNTAB             !
1820          DEF ASCTAB             !
1830          DEF PARTAB             !
1840          DEF ERRTAB             !
1850 RUNTAB   DEF PLTINI             ! not really run table
1860          DEF PLIS.              ! PLOTTER IS (token 1)
1870          DEF AXES.              !
1880          DEF CLIP.              !
1890          DEF CSIZE.             !
1900          DEF CURSR.             !
1910          DEF DIGIT.             !
1920          DEF DRAW.              !
1930          DEF FRAME.             !
1940          DEF FXD.               !
1950          DEF GCLER.             !
1960          DEF GRID.              !
1970          DEF IDRAW.             !
1980          DEF IMOVE.             !
1990          DEF IPLOT.             !
2000          DEF LABEL.             !
2010          DEF LAXES.             !
2020          DEF LDIR.              !
2030          DEF LGRID.             !
2040          DEF LIMIT.             !
2050          DEF LINET.             !
2060          DEF LOCAT.             !
2070          DEF LORG.              !
2080          DEF MSCAL.             !
2090          DEF MOVE.              !
2100          DEF PDIR.              !
2110          DEF PENUP.             !
2120          DEF PEN.               !
2130          DEF PLOT.              !
2140          DEF RPLOT.             !
2150          DEF SCALE.             !
2160          DEF SETGU.             !
2170          DEF SETUU.             !
2180          DEF SHOW.              !
2190          DEF UNCLP.             !
2200          DEF VELO.              !
2210          DEF WHERE.             !
2220          DEF XAXIS.             !
2230          DEF YAXIS.             !
2240          DEF RATIO.             !
2250 PARTAB   DEF LBEOL.             ! not parse table
2260          DEF PLIS#              ! PLOTTER IS (token 1) parse
2270          DEF G2467              !
2280          DEF G0-4N              !
2290          DEF G1-3N              !
2300          DEF WHCRDG             !
2310          DEF WHCRDG             !
2320          DEF G2N                !
2330          DEF PUSH+S             !
2340          DEF G1-2N              !
2350          DEF PUSH+S             !
2360          DEF G2467              !
2370          DEF G2N                !
2380          DEF G2N                !
2390          DEF G2-3N              !
2400          DEF LABEL              !
2410          DEF G2467              !
2420          DEF G1-2N              !
2430          DEF G2467              !
2440          DEF G0-4N              !
2450          DEF G1-2N              !
2460          DEF G0-4N              !
2470          DEF G1N                !
2480          DEF G2-3N              !
2490          DEF G2N                !
2500          DEF G1-2N              !
2510          DEF PUSH+S             !
2520          DEF G1N                !
2530          DEF G2-3N              !
2540          DEF G2-3N              !
2550          DEF G4N                !
2560          DEF PUSH+S             !
2570          DEF PUSH+S             !
2580          DEF G4N                !
2590          DEF PUSH+S             !
2600          DEF G0-1N              !
2610          DEF WHCRDG             !
2620          DEF G124               !
2630          DEF G124               !
2640          DEF RELMAR             !
2650 ASCTAB   ASP "PLOTTER IS"       !
2660          ASP "AXES"             !
2670          ASP "CLIP"             !
2680          ASP "CSIZE"            !
2690          ASP "CURSOR"           !
2700          ASP "DIGITIZE"         !
2710          ASP "DRAW"             !
2720          ASP "FRAME"            !
2730          ASP "FXD"              !
2740          ASP "GCLEAR"           !
2750          ASP "GRID"             !
2760          ASP "IDRAW"            !
2770          ASP "IMOVE"            !
2780          ASP "IPLOT"            !
2790          ASP "LABEL"            !
2800          ASP "LAXES"            !
2810          ASP "LDIR"             !
2820          ASP "LGRID"            !
2830          ASP "LIMIT"            !
2840          ASP "LINETYPE"         !
2850          ASP "LOCATE"           !
2860          ASP "LORG"             !
2870          ASP "MSCALE"           !
2880          ASP "MOVE"             !
2890          ASP "PDIR"             !
2900          ASP "PENUP"            !
2910          ASP "PEN"              !
2920          ASP "PLOT"             !
2930          ASP "RPLOT"            !
2940          ASP "SCALE"            !
2950          ASP "SETGU"            !
2960          ASP "SETUU"            !
2970          ASP "SHOW"             !
2980          ASP "UNCLIP"           !
2990          ASP "VELOCITY"         !
3000          ASP "WHERE"            !
3010          ASP "XAXIS"            !
3020          ASP "YAXIS"            !
3030          ASP "RATIO"            !
3040          BYT 377                !
3050 !
3060 ERRTAB   BYT 201D               ! dummy entry
3070          ASP "digitize"         !
3080          ASP "no plotter"       !
3090          ASP "plotter data file missing" !
3100          BYT 377                !
3110 !
3120          BYT 141                ! Rev 'a' -- 1st release
3130          BYT 2                  ! ROM only (because of GTO's)
3140 !
3150 PLTINI   CMB R0,=V.WARM         !
3160          JZR GTOCRT             !
3170          CMB R0,=V.COLD         !
3180          JNZ L61C3              !
3190 GTOCRT   JMP CRTFIL             !
3200 !
3210 L61C3    CMB R#,=V.VOLT         !
3220          JNZ L61D3              !
3230          CMMD R40,=FILNAME      !
3240          JNZ L61D3              !
3250          CLB R2                 !
3260          STBD R2,=HANDLD        !
3270 L61D2    RTN                    !
3280 L61D3    LDBD R2,=ROUTE         !
3290          CMB R2,=3              !
3300          JNZ L61D2              !
3310          CMB R0,=V.CHAR         !
3320          JNZ LBL                !
3330          GTO LBLTRP             !
3340 !
3350 LBL      CMB R0,=V.ENDL         !
3360          JNZ L61D2              !
3370          GTO LBTRP1             !
3380 !
3390 CRTFIL   BYT 140,251            ! LDM R40,=
3400 FILNAME  ASC ".plotfil"         !
3410 !
3420          LDM R32,=140,1         !
3430          LDM R20,=TYSYSM        !
3440          JSB =FCRALO            !
3450          JEN L61D2              !
3460          LDMD R30,R30           !
3470          CLB R40                !
3480          STBD R40,R30           !
3490          RTN                    !
3500 G0-1N    JSB =GET???            !
3510          TSB R#                 !
3520          JZR PTOKEN             !
3530          CMB R#,=1              !
3540          JZR PTOKEN             !
3550          JMP PERROR             !
3560 !
3570 G1N      PUBD R43,+R6           !
3580          JSB =SYSJSB            !
3590          DEF NUMVA+             !
3600          POBD R53,-R6           !
3610          JEZ PERROR             !
3620          JMP PTOKEN             !
3630 !
3640 PTOKN+   LDB R53,R43            !
3650 PTOKEN   BYT 155,251            ! LDM R55,=
3660          BYT 264                !
3670          DEF MYROM              ! My ROM#
3680          PUMD R#,+R12           !
3690          PUBD R53,+R12          !
3700          RTN                    !
3710 !
3720 PUSH+S   JSB =PTOKN+            !
3730 RMSCAN   JSB =SYSJSB            !
3740          DEF SCAN               !
3750          RTN                    !
3760 !
3770 G0-4N    JSB =GET???            !
3780          TSB R#                 !
3790          JZR PTOKEN             !
3800          CMB R#,=4              !
3810          JZR PTOKEN             !
3820 !
3830 PERROR   JSB =ERR1+             !
3840          BYT 89D                !
3850 !
3860 POPUSH   POBD R53,-R12          !
3870 PTJP     JMP PTOKEN             !
3880 !
3890 G4N      LDB R35,=4             !
3900          JSB =PARGET            !
3910          JMP POPUSH             !
3920 !
3930 G2N      JSB =GET???            !
3940          CMB R#,=2              !
3950          JNZ PERROR             !
3960          JMP PTOKEN             !
3970 !
3980 G2-3N    JSB =GET???            !
3990          CMB R#,=2              !
4000 G3N+     JNC PERROR             !
4010 G<4      CMB R#,=4              !
4020          JCY PERROR             !
4030          JMP PTOKEN             !
4040 !
4050 G1-3N    JSB =GET???            !
4060          TSB R#                 !
4070          JZR PERROR             !
4080          JMP G<4                !
4090 !
4100 G1-2N    JSB =GET???            !
4110 G1-2N+   TSB R#                 !
4120          JZR PERROR             !
4130          CMB R#,=3              !
4140          JCY PERROR             !
4150          JMP PTOKEN             !
4160 !
4170 G0ERR    JMP PERROR             !
4180 !
4190 GET???   CLB R35                !
4200          JSB =PARGET            !
4210          POBD R53,-R12          !
4220          DRP R34                !
4230 DUMMY    RTN                    !
4240 !
4250 PARGET   JSB =SYSJSB            !
4260          DEF GETPAR             !
4270          RTN                    !
4280 !
4290 PLIS#    PUBD R43,+R6           !
4300          JSB =SYSJSB            !
4310          DEF G1$OR*             !
4320          POBD R36,-R12          !
4330          POBD R53,-R6           !
4340 PUSHJM   JMP PTOKEN             !
4350 !
4360 WHCRDG   STB R14,R36            !
4370          JSB =VITEM             !
4380 PJ       JEZ PERROR             !
4390          CMB R14,=54            !
4400          JNZ PERROR             !
4410          JSB =VITEM             !
4420          JEZ PJ                 !
4430          STB R#,R53             !
4440          CMB R14,=54            !
4450          JNZ PUSHJM             !
4460          JSB =VITEM             !
4470          STB R#,R53             !
4480          JMP PUSHJM             !
4490 !
4500 VITEM    JSB =RMSCAN            !
4510          CLE                    !
4520          PUBD R36,+R6           !
4530          JSB =SYSJSB            !
4540          DEF REFNUM             !
4550          POBD R36,-R6           !
4560          RTN                    !
4570 !
4580 G124     JSB =GET???            !
4590          CMB R#,=4              !
4600 PTX      JZR PUSHJM             !
4610          JMP G1-2N+             !
4620 !
4630 G2467    JSB =GET???            !
4640          CMB R#,=7              !
4650          JZR PTX                !
4660          JCY G0ERR              !
4670          JEV G0ERR              !
4680 G2467+   JMP PUSHJM             !
4690 !
4700 LABEL    JSB =PTOKN+            !
4710          POBD R14,-R12          !
4720          JSB =SYSJSB            !
4730          DEF PRINT              !
4740          POBD R53,-R12          !
4750          CMB R53,=242           !
4760          JZR REMOVT             !
4770          PUBD R53,+R12          !
4780 REMOVT   LDB R#,=50             !
4790          JMP G2467+             !
4800 !
4810 FILOPN   BYT 140,251            ! LDM R40,=
4820 FILNME   ASC ".plotfil"         !
4830 !
4840          JSB =FOPEN             !
4850          JEZ L6316              !
4860 FL1      POMD R44,-R6           !
4870          JSB =ERR1+             !
4880          BYT 203D               !
4890 L6316    LDMD R14,R30           !
4900          RTN                    !
4910 !
4920 PLRAST   JSB =HANDI0            !
4930          VAL V.SEND             !
4940 L631E    RTN                    !
4950 !
4960 PLSND    JSB =FILOPN            !
4970          LDBD R30,R14           !
4980          JNG PLRAST             !
4990          LDB R2,=1              !
5000          STBD R2,=NOATTN        !
5010          JSB =LADPLT            !
5020          POMD R30,-R12          !
5030          POBD R57,+R30          !
5040          BIN                    !
5050          POMD R36,-R12          !
5060          DCM R36                !
5070          LDB R2,=1              !
5080          STBD R2,=FAST!         !
5090          JSB =DATREP            !
5100          JSB =UNLREP            !
5110          CLB R2                 !
5120          STBD R2,=NOATTN        !
5130          STBD R2,=FAST!         !
5140          JEZ L631E              !
5150 BAIL     LDMD R6,=SUBPNT        !
5160          RTN                    !
5170 !
5180          BYT 241                !
5190 LIMIT.   JSB =BEGIN             !
5200          JSB =GFOUR             !
5210          BIN                    !
5220          JEN NOVARS             !
5230          LDM R40,=230,220,0,0,0,0,0,45 !
5240          STMD R40,X14,PLTMP7    !
5250          LDM R0,R14             !
5260          ADM R0,=PLTMP1         !
5270          JSB =MM+               !
5280          JSB =MM2NPU            !
5290          JSB =MM2NPU            !
5300          JSB =MM2NPU            !
5310          BIN                    !
5320 SELI1    JSB =P4                !
5330          JEN GPON3              !
5340 !
5350 JSBERR   JSB =ERR1+             !
5360          BYT 89D                !
5370 !
5380 NOVARS   DCE                    !
5390          JEZ SELI1              !
5400          RTN                    !
5410 !
5420 MM2NPU   LDMD R40,X14,PLTMP7    !
5430 MM+      LDMD R50,R0            !
5440          BCD                    !
5450          JSB =DIV10             !
5460          POMD R#,-R#            !
5470          PUMD R#,+R0            !
5480          RTN                    !
5490 !
5500          BYT 241                !
5510 PLIS.    JSB =BEGIN+            !
5520          LDM R74,=377,0,337,40  !
5530          POMD R44,-R12          !
5540          PUMD R44,+R12          !
5550          CLB R40                !
5560          STBD R40,R14           !
5570          LDM R30,R44            !
5580          CMM R30,=1,0           !
5590          JNZ L63BD              !
5600          JSB =MELJSB            !
5610          DEF DEVOK              !
5620 L63BC    RTN                    !
5630 !
5640 L63BD    CMM R#,=4,0            !
5650          JNC L63C6              !
5660 !
5670          JSB =ERR1+             !
5680          BYT 63D                !
5690 !
5700 L63C6    JSB =MELJSB            !
5710          DEF DEVOK              !
5720          JEN L63BC              !
5730          JSB =HANDI0            !
5740          VAL V.RAST             !
5750          JSB =P2                !
5760          JSB =CLEERR            !
5770          JSB =P0                !
5780 GPON3    JSB =FILOPN            !
5790          JSB =SETNPU            !
5800          BCD                    !
5810          ERB R70                !
5820          JSB =DIV10             !
5830          LLB R70                !
5840 L63E8    POMD R40,-R12          !
5850          ICB R40                !
5860          ICB R40                !
5870          JEZ Y>X                !
5880          STMD R40,X14,PLTMP3    !
5890          JSB =ONE.              !
5900          POMD R#,-R#            !
5910          ICB R#                 !
5920          ICB R#                 !
5930          STMD R#,X14,PLTMP4     !
5940          JMP PLOTR2             !
5950 !
5960 Y>X      STMD R40,X14,PLTMP4    !
5970          JSB =ONE.              !
5980          POMD R#,-R#            !
5990          ICB R#                 !
6000          ICB R#                 !
6010          STMD R40,X14,PLTMP3    !
6020 PLOTR2   CLB R#                 !
6030          STMD R#,X14,GCOSPD     !
6040          CLM R#                 !
6050          STMD R#,X14,PLTMP1     !
6060          STMD R#,X14,PLTMP2     !
6070          STMD R#,X14,GSINPD     !
6080          STMD R#,X14,LAXNY      !
6090          JSB =SCAL1             !
6100          BIN                    !
6110          LDM R34,R14            !
6120          ADM R34,=GXBUSR        !
6130          LDM R30,R14            !
6140          ADM R30,=GXBGDU        !
6150          JSB =FTT1              !
6160          JSB =P1TOT1            !
6170          JSB =SETSCL            !
6180          BIN                    !
6190          LDM R34,R14            !
6200          ADM R34,=GXSCL+        !
6210          LDM R30,R14            !
6220          ADM R30,=GXHCL+        !
6230          JSB =FTT1              !
6240          LDM R30,R14            !
6250          ADM R30,=GPXLOC        !
6260          JSB =MOVP1X            !
6270          LDM R30,R14            !
6280          ADM R30,=GOXLOC        !
6290          JSB =MOVP1X            !
6300          LDM R30,R14            !
6310          ADM R30,=GXCURS        !
6320          JSB =MOVP1X            !
6330          CLM R40                !
6340          LDB R47,=30C           !
6350          JSB =CSIZE2            !
6360          JSB =ONE.              !
6370          JSB =LINET             !
6380          JSB =PENUP             !
6390          JSB =ONE.              !
6400          JSB =PEN               !
6410          CLM R40                !
6420          PUMD R40,+R12          !
6430          JSB =LDIR              !
6440          JSB =LORG1             !
6450          JSB =FILOPN            !
6460          LDB R2,=1              !
6470          LDBD R40,R14           !
6480          ORB R40,R2             !
6490          STBD R40,R14           !
6500          RTN                    !
6510 !
6520 P2       JSB =GETBUF            !
6530 !
6540          BYT 141,251            ! LDM R41,=
6550          ASC "DF;IM36"          !
6560 !
6570          PUMD R#,+R30           !
6580          JMP OUTBF              !
6590 !
6600 P0       JSB =GETBUF            !
6610          LDM R46,=117,120       !
6620          PUMD R46,+R30          !
6630          JSB =OUTBF             !
6640          JSB =PLTINP            !
6650          PUMD R14,+R6           !
6660          JSB =GETCM             !
6670          POMD R14,-R6           !
6680          PUMD R14,+R6           !
6690          STMD R40,X14,GP1X      !
6700          JSB =GETCM             !
6710          POMD R14,-R6           !
6720          PUMD R14,+R6           !
6730          STMD R40,X14,GP1Y      !
6740          JSB =GETCM             !
6750          POMD R14,-R6           !
6760          PUMD R14,+R6           !
6770          STMD R40,X14,GP2X      !
6780          JSB =GETLST            !
6790          POMD R14,-R6           !
6800          STMD R40,X14,GP2Y      !
6810          JSB =P1TOT1            !
6820 SENDIW   JSB =ORDER             !
6830          LDM R76,=111,127       !
6840          JSB =HPILLM            !
6850 OUTBF    LDB R47,=73            !
6860          PUBD R47,+R30          !
6870          LDM R20,R30            !
6880          LDMD R30,=RESDAT       !
6890          SBM R20,R30            !
6900          PUMD R20,+R12          !
6910          PUMD R30,+R12          !
6920          JSB =PLSND             !
6930          RTN                    !
6940 !
6950 P1TOT1   JSB =FILOPN            !
6960          LDM R34,R14            !
6970          ADM R34,=GP1X          !
6980 FTOT1    LDM R30,R14            !
6990          ADM R30,=PLTMP1        !
7000 FTT1     LDM R32,=32D,0         !
7010          JSB =COPY              !
7020 L651B    RTN                    !
7030 !
7040 PLTOSC   BIN                    !
7050          LDM R34,R14            !
7060          ADM R34,=PLTMP1        !
7070          LDM R30,R14            !
7080          ADM R30,=GXBUSR        !
7090          JMP FTT1               !
7100 !
7110 TMP4-2   LDMD R50,X14,PLTMP4    !
7120          LDMD R40,X14,PLTMP2    !
7130          JMP COMFLT             !
7140 !
7150 TMP3-1   LDMD R50,X14,PLTMP3    !
7160          LDMD R40,X14,PLTMP1    !
7170 COMFLT   PUMD R40,+R12          !
7180          PUMD R50,+R12          !
7190          JSB =SUB10             !
7200          POMD R70,-R12          !
7210          BIN                    !
7220 CMF+     JSB =LT.               !
7230          STM R70,R50            !
7240          CLE                    !
7250          POMD R40,-R12          !
7260          TSM R40                !
7270          JZR L651B              !
7280          ICE                    !
7290 L6558    RTN                    !
7300 !
7310 ORDER    JSB =TMP3-1            !
7320          JEN XORDOK             !
7330          LDMD R50,X14,PLTMP3    !
7340          LDMD R40,X14,PLTMP1    !
7350          JSB =STO1-3            !
7360 XORDOK   JSB =TMP4-2            !
7370          JEN L6558              !
7380          LDMD R50,X14,PLTMP4    !
7390          LDMD R40,X14,PLTMP2    !
7400          STMD R40,X14,PLTMP4    !
7410          STMD R50,X14,PLTMP2    !
7420          RTN                    !
7430 !
7440 PUTSM    LDB R32,=73            !
7450 PUT+     PUBD R#,+R30           !
7460          DRP R40                !
7470          RTN                    !
7480 !
7490 PUT+CM   POMD R40,+R0           !
7500          JSB =PUTFI             !
7510 PUTCM    LDB R32,=54            !
7520          JMP PUT+               !
7530 !
7540 HPILLM   JSB =GETBUF            !
7550          PUMD R76,+R30          !
7560          LDM R0,R14             !
7570          ADM R0,=PLTMP1         !
7580          JSB =PUT+CM            !
7590          JSB =PUT+CM            !
7600          JSB =PUT+CM            !
7610          POMD R#,+R0            !
7620 PUTFI    PUMD R#,+R12           !
7630 PUTFI+   JSB =ONEI              !
7640          PUMD R40,+R12          !
7650          JSB =ONER              !
7660 PUTFI-   CLM R54                !
7670          BIN                    !
7680          PUMD R0,+R6            !
7690          JSB =CVNUM             !
7700          POMD R0,-R6            !
7710          BIN                    !
7720          RTN                    !
7730 !
7740 PUTFDC   BCD                    !
7750          TSM R40                !
7760          JZR PUTFI-             !
7770          CLB R32                !
7780          JSB =SEP10             !
7790          ADM R36,=3,0           !
7800          JLZ TESTBG             !
7810          CLM R40                !
7820          JMP CALCV              !
7830 !
7840 TESTBG   CMM R#,=6,0            !
7850          JCY SETBG              !
7860          LDM R34,=5,0           !
7870          SBM R34,R36            !
7880          JZR SHFDN              !
7890 SHFLP    LRM R47                !
7900          DCM R34                !
7910          JNZ SHFLP              !
7920 SHFDN    CLM R53                !
7930          STM R53,R40            !
7940 !
7950          BYT 145,311            ! CMM R45,=
7960 C127.9   BYT 231,171,22         ! 127.99
7970 !
7980          JNC VALOK              !
7990 SETBG    CLM R40                !
8000          LDMD R45,=C127.9       !
8010 VALOK    LDM R36,=2,0           !
8020          JSB =SHRONF            !
8030          POMD R40,-R12          !
8040 CALCV    JMP PUTFI-             !
8050 !
8060 GETPF    JSB =FILOPN            !
8070          LDMD R32,X14,GFLAG     !
8080 C2       BIN                    !
8090          RTN                    !
8100 !
8110 PUDVPO   DRP R40                !
8120 PUDVP+   PUMD R#,+R12           !
8130 DV&PO    JSB =PLDIVR            !
8140          POMD R#,-R#            !
8150          RTN                    !
8160 !
8170 PUDIVR   PUMD R40,+R12          !
8180 PLDIVR   BCD                    !
8190          JSB =DIV2              !
8200 PLD-     DRP R40                !
8210          ARP R12                !
8220          RTN                    !
8230 !
8240 GETXY    JSB =TWOR              !
8250 GETXY+   STMD R40,X14,PLTMP2    !
8260          STMD R50,X14,PLTMP1    !
8270 GETCL1   JSB =GETPF             !
8280          LDB R#,R33             !
8290          ANM R#,=200,0          !
8300          LRB R#                 !
8310          LRB R#                 !
8320          STMD R#,X14,PLTMP6     !
8330          RTN                    !
8340 !
8350 CLXAX    JSB =GENADR            !
8360          LDMD R#,X#,GXAGDU      !
8370          LDMD R50,X14,PLTMP1    !
8380          JMP PLMULT             !
8390 !
8400 CLYAY    JSB =GENADR            !
8410          LDMD R#,X#,GYAGDU      !
8420          LDMD R50,X14,PLTMP2    !
8430 PLMULT   JSB =PUSH              !
8440 PLMPYR   BCD                    !
8450          PUMD R0,+R6            !
8460          JSB =MPYROI            !
8470          POMD R0,-R6            !
8480          JMP PLD-               !
8490 !
8500 SCALUT   JSB =PLMPYR            !
8510 SUBPOP   JSB =SUBROI            !
8520          POMD R#,-R#            !
8530          RTN                    !
8540 !
8550 GETBUF   JSB =FILOPN            !
8560          LDMD R30,=RESDAT       !
8570          RTN                    !
8580 !
8590 ABSDPY   JSB =CALDPY            !
8600 ABSCOM   LRB R51                !
8610          LLB R51                !
8620          DRP R50                !
8630          ARP R12                !
8640          RTN                    !
8650 !
8660 ABSDPX   JSB =CALDPX            !
8670          JMP ABSCOM             !
8680 !
8690 CALDPX   LDMD R50,X14,GP2X      !
8700          LDMD R40,X14,GP1X      !
8710          JMP SUB#               !
8720 !
8730 CALDPY   LDMD R50,X14,GP2Y      !
8740          LDMD R40,X14,GP1Y      !
8750 SUB#     PUMD R50,+R12          !
8760          PUMD R40,+R12          !
8770          JSB =SUBROI            !
8780          POMD R50,-R12          !
8790          RTN                    !
8800 !
8810 T3-1     LDMD R50,X14,PLTMP3    !
8820          LDMD R40,X14,PLTMP1    !
8830          JMP SUB#               !
8840 !
8850 T4-2     LDMD R50,X14,PLTMP4    !
8860          LDMD R40,X14,PLTMP2    !
8870          JMP SUB#               !
8880 !
8890          BYT 241                !
8900 LOCAT.   JSB =BEGIN             !
8910 LOCAT+   JSB =GFOUR             !
8920          JEN NOVARL             !
8930          CLM R20                !
8940          STMD R20,X14,PLTMP6    !
8950          JSB =CLXY4             !
8960 SELO1    LDM R30,R14            !
8970          ADM R30,=GP1X          !
8980          JSB =MT1.40            !
8990          JSB =SECL1             !
9000 SETNPU   JSB =ABSDPY            !
9010          STMD R50,X14,PLTMP2    !
9020          PUMD R50,+R12          !
9030          JSB =ABSDPX            !
9040          STMD R50,X14,PLTMP1    !
9050          PUMD R50,+R12          !
9060          JSB =CMF+              !
9070          JEZ PY>PX              !
9080          LDMD R40,X14,PLTMP2    !
9090          LDMD R50,X14,PLTMP1    !
9100          JMP PY/PX              !
9110 !
9120 PY>PX    LDMD R40,X14,PLTMP1    !
9130          LDMD R50,X14,PLTMP2    !
9140 PY/PX    STMD R40,X14,GNPUS     !
9150          RTN                    !
9160 !
9170 NOVARL   DCE                    !
9180          JEZ SELO1              !
9190          RTN                    !
9200 !
9210 GFOUR    JSB =STACK             !
9220          JZR DIGI2              !
9230 G4PARM   JSB =TWOR              !
9240          STMD R50,X14,PLTMP2    !
9250          STMD R40,X14,PLTMP4    !
9260          JSB =TWOR              !
9270 STO1-3   STMD R50,X14,PLTMP1    !
9280          STMD R40,X14,PLTMP3    !
9290          CLE                    !
9300          RTN                    !
9310 !
9320 DIGI2    JSB =DONEP+            !
9330          JEZ NOVARL             !
9340          JSB =STBEEP            !
9350          LDM R30,R14            !
9360          ADM R30,=PLTMP6        !
9370          JSB =FROMT1            !
9380          JSB =DONEP+            !
9390          JEZ NOVARL             !
9400          JSB =STBEEP            !
9410          JSB =MVTMP3            !
9420          LDM R34,R14            !
9430          ADM R34,=PLTMP6        !
9440          JSB =TOTMP1            !
9450          CLE                    !
9460          ICE                    !
9470          RTN                    !
9480 !
9490 ONE.     CLM R40                !
9500          LDB R47,=10C           !
9510 ERPUSH   PUMD R40,+R12          !
9520          RTN                    !
9530 !
9540 GETCM    LDB R32,=54            !
9550 GET+     BIN                    !
9560          POMD R26,-R12          !
9570          POMD R24,-R12          !
9580          LDM R30,R26            !
9590 CMALOP   POBD R33,+R30          !
9600          CMB R33,R32            !
9610          JNZ CMALOP             !
9620          STM R26,R20            !
9630          STM R30,R32            !
9640          SBM R32,R20            !
9650          SBM R24,R32            !
9660          PUMD R24,+R12          !
9670          PUMD R30,+R12          !
9680          PUMD R32,+R12          !
9690          PUMD R26,+R12          !
9700 GETLST   BIN                    !
9710          PUMD R14,+R6           !
9720          JSB =VAL.              !
9730          JSB =ONER              !
9740          BIN                    !
9750          POMD R14,-R6           !
9760          ARP R40                !
9770          DRP R60                !
9780          RTN                    !
9790 !
9800 MVTMP3   LDM R30,R14            !
9810          ADM R30,=PLTMP3        !
9820 FROMT1   LDM R34,R14            !
9830          ADM R34,=PLTMP1        !
9840          JMP MOVE20             !
9850 !
9860 UPDOR    LDM R30,R14            !
9870          ADM R30,=GOXLOC        !
9880          JMP FROMT1             !
9890 !
9900 UPDAT    LDM R30,R14            !
9910          ADM R30,=GPXLOC        !
9920          JMP FROMT1             !
9930 !
9940 MOVCL-   JSB =GETCL             !
9950          ADM R#,=GXHCL-         !
9960 MOVCL+   STM R#,R34             !
9970 TOTMP1   LDM R30,R14            !
9980          ADM R30,=PLTMP1        !
9990          JMP MOVE20             !
10000 !
10010 MOVP1X   LDM R34,R14           !
10020          ADM R34,=GP1X         !
10030 MOVE20   LDM R32,=16D,0        !
10040 MV20+    JSB =COPY             !
10050          RTN                   !
10060 !
10070 MT1.40   LDM R34,R14           !
10080          ADM R34,=PLTMP1       !
10090          LDM R32,=32D,0        !
10100          JMP MV20+             !
10110 !
10120          BYT 241               !
10130 SCALE.   JSB =BEGIN            !
10140 SCAL+    JSB =GFOUR            !
10150 SCAL1    LDMD R40,X14,GP1X     !
10160          PUMD R40,+R12         !
10170          LDMD R40,X14,PLTMP1   !
10180          PUMD R40,+R12         !
10190          JSB =CALDPX           !
10200          PUMD R#,+R12          !
10210          JSB =T3-1             !
10220          JSB =PUDVP+           !
10230          PUMD R#,+R12          !
10240          STMD R#,X14,PLTMP3    !
10250          JSB =SCALUT           !
10260          STMD R#,X14,PLTMP1    !
10270          LDMD R#,X14,GP1Y      !
10280          PUMD R#,+R12          !
10290          LDMD R#,X14,PLTMP2    !
10300          PUMD R#,+R12          !
10310          JSB =CALDPY           !
10320          PUMD R#,+R12          !
10330          JSB =T4-2             !
10340          JSB =PUDVP+           !
10350          PUMD R#,+R#           !
10360          STMD R#,X14,PLTMP4    !
10370          JSB =SCALUT           !
10380          STMD R#,X14,PLTMP2    !
10390          JSB =PLTOSC           !
10400          JMP SETU.             !
10410 !
10420          BYT 241               !
10430 SETGU.   JSB =BEGIN            !
10440 SETG.    JSB =GETPF            !
10450          ANM R32,=377,177      !
10460          JMP STFLAG            !
10470 !
10480          BYT 241               !
10490 SETUU.   JSB =BEGIN            !
10500 SETU.    JSB =GETPF            !
10510          JNG SETUEX            !
10520          ADM R#,=0,200         !
10530 STFLAG   STMD R#,X14,GFLAG     !
10540 SETUEX   RTN                   !
10550 !
10560          BYT 241               !
10570 CLIP.    JSB =BEGIN            !
10580 CLIP+    JSB =GFOUR            !
10590          JEN NOVARC            !
10600          JSB =GETCL1           !
10610          JSB =CLXY4            !
10620 SECL1    JSB =BOUND+           !
10630 SETSCL   JSB =ORDER            !
10640          JSB =FIXRND           !
10650          BIN                   !
10660          LDM R34,R14           !
10670          ADM R34,=PLTMP3       !
10680          LDM R30,R14           !
10690          ADM R30,=GXSCL+       !
10700          JSB =MOVE20           !
10710          LDM R30,R14           !
10720          ADM R30,=GXSCL-       !
10730          JSB =FROMT1           !
10740          RTN                   !
10750 !
10760 NOVARC   DCE                   !
10770          JEZ SECL1             !
10780          RTN                   !
10790 !
10800 FIXRND   BIN                   !
10810          LDM R20,R14           !
10820          ADM R20,=PLTMP1       !
10830          JSB =FIXR+            !
10840          JSB =FIXR+            !
10850 FIXR-    JSB =FIXR+            !
10860 FIXR+    LDMD R40,R20          !
10870          CLM R70               !
10880          LDB R76,=10           !
10890          ICB R74               !
10900          JSB =SEPRND           !
10910          ICM R36               !
10920          JSB =INFR4            !
10930          JSB =UT210            !
10940          JSB =SHF10            !
10950          LDM R36,R34           !
10960          DCM R36               !
10970          JSB =NFR              !
10980          POMD R#,-R#           !
10990          PUMD R#,+R20          !
11000          RTN                   !
11010 !
11020 SEPRND   BCD                   !
11030          JSB =SEP10            !
11040          JSB =ROUND            !
11050          RTN                   !
11060 !
11070 PLTRST   JSB =HANDI0           !
11080          VAL V.REC             !
11090          RTN                   !
11100 !
11110 PLTINP   JSB =FILOPN           !
11120          LDBD R30,R14          !
11130          JNG PLTRST            !
11140          LDB R2,=1             !
11150          STBD R2,=NOATTN       !
11160          JSB =TADPLT           !
11170          JSB =GETBUF           !
11180          LDM R26,R30           !
11190          CLM R24               !
11200          LDM R56,=SDA          !
11210          JSB =RDYSND           !
11220          ANM R56,=340,377      !
11230          CMM R56,=SDA          !
11240          JNZ PLloop1           !
11250 BADDEV   JSB =OK+              !
11260 !
11270          JSB =ERROR            !
11280          BYT 57D               !
11290 !
11300          GTO BAIL              !
11310 !
11320 PLloop1  STB R56,R3            !
11330          CMM R56,=ETO          !
11340          JZR OKEND             !
11350          CMM R56,=ETE          !
11360          JZR BADDEV            !
11370          CMB R57,=12           !
11380          JNZ LOOP1             !
11390          PUMD R56,+R6          !
11400          LDM R56,=NRD          !
11410          JSB =RDYSND           !
11420          POMD R56,-R6          !
11430          JSB =DTSND+           !
11440          JMP OKEND             !
11450 !
11460 LOOP1    CMB R57,=0            !
11470          JZR BADDEV            !
11480          JSB =TOOBIG           !
11490          JSB =DTSND+           !
11500          JMP PLloop1           !
11510 !
11520 TOOBIG   SAD                   !
11530          ICM R24               !
11540          CMM R24,=ONEHUND      !
11550          JCY J6933             !
11560          PAD                   !
11570          PUBD R#,+R26          !
11580          RTN                   !
11590 !
11600 J6933    PAD                   !
11610          PUMD R56,+R6          !
11620          LDM R56,=NRD          !
11630          JSB =RDYSND           !
11640          POMD R56,-R6          !
11650          JSB =DTSND+           !
11660          JMP BADDEV            !
11670 !
11680 OKEND    TSM R24               !
11690          JZR BADDEV            !
11700          PUMD R24,+R12         !
11710          PUMD R30,+R12         !
11720 OK+      JSB =UNTREP           !
11730          CLB R2                !
11740          STBD R2,=NOATTN       !
11750          RTN                   !
11760 !
11770 DTSND+   JSB =MELJSB           !
11780          DEF DATSD-            !
11790          RTN                   !
11800 !
11810 LADPLT   JSB =UNTREP           !
11820          JSB =UNLREP           !
11830          JSB =THERE!           !
11840          LDB R32,=40           !
11850          JSB =LADDEV           !
11860 L696B    RTN                   !
11870 !
11880 TADPLT   JSB =UNLREP           !
11890          JSB =THERE!           !
11900          CLE                   !
11910          JSB =CHKEND           !
11920 J6976    JZR L696B             !
11930          LDBD R3,X36,SETUP     !
11940          ANM R3,=40            !
11950          JZR J6985             !
11960          JSB =TADREP           !
11970          RTN                   !
11980 !
11990 J6985    JSB =SKPCHK           !
12000          JMP J6976             !
12010 !
12020          BYT 241               !
12030 CSIZE.   JSB =BEGIN            !
12040 CSIZE    JSB =ONER             !
12050 CSIZE1   PUMD R40,+R6          !
12060          JSB =STACK            !
12070          POMD R40,-R6          !
12080          TSB R26               !
12090          JNZ P>1               !
12100 CSIZE2   JSB =CHIGH            !
12110          JSB =DEFW+S           !
12120          JMP CSIZUP            !
12130 !
12140 P=2      JSB =DEFSL            !
12150          JMP DOH+W             !
12160 !
12170 P>1      SBM R#,=10,0          !
12180          JZR P=2               !
12190          PUMD R40,+R12         !
12200          JSB =TAN10            !
12210          BIN                   !
12220          POMD R#,-R#           !
12230          JSB =STGSLT           !
12240          JSB =ONER             !
12250 DOH+W    PUMD R40,+R6          !
12260          JSB =ONER             !
12270          JSB =CHIGH            !
12280          POMD R40,-R6          !
12290          JSB =CWIDE            !
12300 CSIZUP   JSB =P26              !
12310          RTN                   !
12320 !
12330 DEFW+S   JSB =C16              !
12340          LDM R46,=0,140        ! = .6
12350          JSB =CWIDE            !
12360 DEFSL    CLM R50               !
12370 STGSLT   STMD R#,X14,GSLANT    !
12380          RTN                   !
12390 !
12400 CHIGH    PUMD R40,+R12         !
12410 CHIGHP   CLM R#                !
12420          LDB R47,=40           !
12430          PUMD R40,+R12         !
12440          JSB =PLDIVR           !
12450          POMD R#,-R#           !
12460          LDMD R50,X14,GNPUS    !
12470          JSB =PLMULT           !
12480          POMD R#,-R#           !
12490          PUMD R#,+R#           !
12500          PUMD R#,+R6           !
12510          JSB =ABSDPY           !
12520          PUMD R#,+R12          !
12530          JSB =PLDIVR           !
12540 CHCOM    POMD R40,-R12         !
12550          STMD R40,X14,GCHITE   !
12560          POMD R50,-R6          !
12570          RTN                   !
12580 !
12590 CWIDE    JSB =PLMULT           !
12600          JSB =ABSDPX           !
12610          PUMD R#,+R#           !
12620          JSB =PLDIVR           !
12630          POMD R#,-R#           !
12640          STMD R#,X14,GCWIDE    !
12650          RTN                   !
12660 !
12670          BYT 241               !
12680 LDIR.    JSB =BEGIN            !
12690 LDIR     JSB =GSICO            !
12700 LDIR+    LDM R30,R14           !
12710          ADM R30,=GSINLD       !
12720          JSB =FROMT1           !
12730          JSB =P30              !
12740          RTN                   !
12750 !
12760          BYT 241               !
12770 LINET.   JSB =BEGIN            !
12780 LINET    JSB =STACK            !
12790          JLN LIN2P             !
12800          CLM R40               !
12810          LDB R47,=100          !
12820 STL2P    STMD R40,X14,PLTMP2   !
12830          JMP LIN1P             !
12840 !
12850 LIN2P    JSB =ONER             !
12860          JMP STL2P             !
12870 !
12880 LIN1P    CLM R#                !
12890          ICB R#                !
12900          LDB R47,=11           !
12910          PUMD R40,+R12         !
12920          BCD                   !
12930          JSB =MELJSB           !
12940          DEF MOD10.            !
12950          JSB =ONEB             !
12960          TSM R46               !
12970          JPS LT+               !
12980          CLM R46               !
12990 LT+      STBD R#,X14,PLTMP1    !
13000          STB R#,R47            !
13010          LRM R47               !
13020          LDMD R32,X14,GFLAG    !
13030          ANM R32,=177,370      !
13040          ORM R32,R46           !
13050          STMD R32,X14,GFLAG    !
13060          JSB =P12              !
13070          JSB =CLEERR           !
13080          RTN                   !
13090 !
13100          BYT 241               !
13110 LORG.    JSB =BEGIN            !
13120 LORG0    JSB =ONEB             !
13130          JZR LORG1             !
13140          CMM R#,=12,0          !
13150          JNC LORG2             !
13160 LORG1    JSB =GETBUF           !
13170          CLB R76               !
13180          ICB R76               !
13190 LORG2    BIN                   !
13200          LLB R#                !
13210          LLB R#                !
13220          LLB R#                !
13230          LDMD R32,X14,GFLAG    !
13240          ANM R32,=207,377      !
13250          ORB R32,R76           !
13260          STBD R32,X14,GFLAG    !
13270          RTN                   !
13280 !
13290          BYT 241               !
13300 PEN.     JSB =BEGIN            !
13310          JSB =PEN              !
13320          JSB =CLEERR           !
13330          RTN                   !
13340 !
13350 PEN      JSB =GETBUF           !
13360          LDM R46,=123,120      !
13370          PUMD R46,+R30         !
13380          PUMD R14,+R6          !
13390          JSB =PUTFI+           !
13400          POMD R14,-R6          !
13410          GTO OUTB              !
13420 !
13430          BYT 241               !
13440 PENUP.   JSB =BEGIN            !
13450 PENUP    JSB =GETBUF           !
13460          LDMD R32,X14,GFLAG    !
13470          ANM R32,=377,367      !
13480          STMD R32,X14,GFLAG    !
13490          JSB =P20              !
13500          RTN                   !
13510 !
13520 P14      JSB =GETBUF           !
13530          LDMD R32,X14,GFLAG    !
13540          ERB R32               !
13550          JEV DOPLOT            !
13560          ELB R32               !
13570          ANM R32,=375,377      !
13580          STMD R32,X14,GFLAG    !
13590          LDBD R32,X14,CLPAB    !
13600          LDB R33,=200          !
13610          ORB R33,R32           !
13620          STBD R33,X14,CLPAB    !
13630 DOPLOT   LDBD R20,X14,CLPAB    !
13640          JPS NOCLPA            !
13650          LDM R45,=120,125,73   !
13660          PUMD R45,+R30         !
13670          LDMD R20,X14,PCNTRL   !
13680          LRB R20               !
13690          JEV NOCLPA            !
13700          LDM R46,=120,101      !
13710          PUMD R46,+R30         !
13720          LDMD R40,X14,PLTMP3   !
13730          JSB =PUTFI            !
13740          JSB =PUTCM            !
13750          LDMD R40,X14,PLTMP4   !
13760          JSB =PUTFI            !
13770          JSB =PUTSM            !
13780          LDM R45,=120,104,73   !
13790          PUMD R45,+R30         !
13800 NOCLPA   LDMD R22,X14,PCNTRL   !
13810          JPS CTLEND            !
13820          JSB =CTPEN            !
13830          JSB =PUTSM            !
13840 CTLEND   LDM R46,=120,101      !
13850          PUMD R46,+R30         !
13860          LDMD R40,X14,PLTMP1   !
13870          JSB =PUTFI            !
13880          JSB =PUTCM            !
13890          LDMD R40,X14,PLTMP2   !
13900          JSB =PUTFI            !
13910          LDMD R22,X14,PCNTRL   !
13920          LDBD R20,X14,CLPAB    !
13930          JEV NOCLPB            !
13940          CLM R22               !
13950 NOCLPB   TSM R22               !
13960          JNG OUTB              !
13970          JSB =PUTSM            !
13980 CTP      JSB =CTPEN            !
13990          JMP OUTB              !
14000 !
14010 P20      CLM R22               !
14020          JMP CTP               !
14030 !
14040 CTPEN    LDM R46,=120,125      !
14050          TSM R22               !
14060          JEV PUPU              !
14070          LDB R47,=104          !
14080 PUPU     PUMD R46,+R30         !
14090          RTN                   !
14100 !
14110 P26      JSB =GETBUF           !
14120          LDM R46,=123,114      !
14130          PUMD R46,+R30         !
14140          LDMD R40,X14,GSLANT   !
14150          JSB =PUTFDC           !
14160          LDM R55,=73,123,122   !
14170          PUMD R55,+R30         !
14180          LDMD R40,X14,GCWIDE   !
14190          JSB =PUTFDC           !
14200          JSB =PUTCM            !
14210          LDMD R#,X14,GCHITE    !
14220 P30OUT   JSB =PUTFDC           !
14230 OUTB     GTO OUTBF             !
14240 !
14250 OUTB22   PUMD R#,+R30          !
14260          JMP OUTB              !
14270 !
14280 P6       JSB =GETBUF           !
14290          LDM R46,=120,107      !
14300          PUMD R46,+R30         !
14310          JMP OUTB              !
14320 !
14330 P30      JSB =GETBUF           !
14340          LDM R46,=104,111      !
14350          PUMD R46,+R30         !
14360          LDMD R40,X14,GCOSLD   !
14370          JSB =PUTFDC           !
14380          JSB =PUTCM            !
14390          LDMD R40,X14,GSINLD   !
14400          JMP P30OUT            !
14410 !
14420 P12      JSB =GETBUF           !
14430          LDM R46,=114,124      !
14440          PUMD R46,+R30         !
14450          LDBD R46,X14,PLTMP1   !
14460          CMB R46,=2            !
14470          JNC OUTB              !
14480          ADB R46,=56           !
14490          PUBD R46,+R30         !
14500          JSB =PUTCM            !
14510          LDMD R40,X14,PLTMP2   !
14520          JMP P30OUT            !
14530 !
14540 P22      JSB =GETPF            !
14550          LDB R33,=2            !
14560          ORB R33,R32           !
14570          JSB =STFLAG           !
14580          JSB =GETBUF           !
14590          LDM R22,=104,120      !
14600          JSB =OUTB22           !
14610 P22+     JSB =GETBUF           !
14620          LDM R22,=117,123      !
14630          JSB =OUTB22           !
14640          JSB =PLTINP           !
14650          JSB =GETLST           !
14660          PUMD R#,+R12          !
14670          JSB =ONEB             !
14680          ANM R46,=4,0          !
14690          JNZ DIGTOK            !
14700          LDBD R46,=SVCWRD      !
14710          JEV P22+              !
14720          JSB =GETBUF           !
14730          LDM R22,=104,103      !
14740          JSB =OUTB22           !
14750 C22      CLE                   !
14760          RTN                   !
14770 !
14780 DIGTOK   JSB =GETBUF           !
14790          LDM R22,=117,104      !
14800 SPCUR    JSB =OUTB22           !
14810          JSB =PLTINP           !
14820          JSB =GETCM            !
14830          STMD R#,X14,PLTMP1    !
14840          JSB =GETCM            !
14850          STMD R#,X14,PLTMP2    !
14860          JSB =MVCURS           !
14870          JSB =GETLST           !
14880          CLM R26               !
14890          TSM R40               !
14900          JZR RTNUP             !
14910          LDB R27,=10           !
14920 RTNUP    JSB =GETPF            !
14930          ANM R#,=377,367       !
14940          ADM R#,R26            !
14950          JSB =STFLAG           !
14960          CLE                   !
14970          ICE                   !
14980          RTN                   !
14990 !
15000 P24      JSB =GETBUF           !
15010          LDM R22,=117,103      !
15020          JMP SPCUR             !
15030 !
15040 GENADR   BIN                   !
15050          LDMD R22,X14,PLTMP6   !
15060          ADM R22,R14           !
15070          DRP R40               !
15080          ARP R22               !
15090          RTN                   !
15100 !
15110 BEGIN    JSB =FILOPN           !
15120          LDBD R40,R14          !
15130          TSB R40               !
15140          JNZ BGN+              !
15150          JSB =ROMERR           !
15160          POMD R30,-R6          !
15170 !
15180          JSB =ERR1+            !
15190          BYT 202D              !
15200 !
15210 BGN+     LDM R56,=ONEHUND      !
15220          JSB =RSMEM-           !
15230          JEZ J6CAA             !
15240          POMD R30,-R6          !
15250          RTN                   !
15260 !
15270 J6CAA    STMD R26,=RESDAT      !
15280          BIN                   !
15290          LDM R30,R6            !
15300          DCM R30               !
15310          DCM R30               !
15320          STMD R30,=SUBPNT      !
15330          LDM R30,R26           !
15340          RTN                   !
15350 !
15360 BEGIN+   JSB =FILOPN           !
15370          JMP BGN+              !
15380 !
15390 STACK    BIN                   !
15400          JSB =GETBUF           !
15410          LDM R26,R12           !
15420          SBMD R26,=TOS         !
15430          TSB R26               !
15440          RTN                   !
15450 !
15460 GSICO    JSB =STACK            !
15470          JLN GSICO2            !
15480 GSICO1   JSB =ONER             !
15490          PUMD R#,+R12          !
15500          PUMD R#,+R12          !
15510          JSB =SIN10            !
15520          POMD R#,-R#           !
15530          STMD R#,X14,PLTMP1    !
15540          JSB =COS10            !
15550          POMD R#,-R#           !
15560          STMD R#,X14,PLTMP2    !
15570          BIN                   !
15580          RTN                   !
15590 !
15600 GSICO2   JSB =GETXY            !
15610          JSB =CLXAX            !
15620          JSB =CLYAY            !
15630          JSB =MELJSB           !
15640          DEF ATN2.             !
15650          JMP GSICO1            !
15660 !
15670 PUSH     PUMD R50,+R12         !
15680          PUMD R40,+R12         !
15690          RTN                   !
15700 !
15710 C16      LDM R40,=231,220,0,0,0,0,20,70 ! =.381
15720          RTN                   !
15730 !
15740 DONEP+   JSB =P22              !
15750          JEZ DRTN              !
15760 MVCURS   BIN                   !
15770          LDM R30,R14           !
15780          ADM R30,=GXCURS       !
15790          JSB =FROMT1           !
15800          RTN                   !
15810 !
15820 DRTN     JSB =ROMERR           !
15830          JSB =ERROR            !
15840          BYT 201D              !
15850          CLE                   !
15860          RTN                   !
15870 !
15880 ROMERR   LDBD R46,=ERRORS      !
15890          JNZ ERMESS            !
15900          LDM R46,=MYROM        !
15910          STBD R46,=ERROM#      !
15920 ERMESS   RTN                   !
15930 !
15940 CLPFRO   JSB =FROMT1           !
15950          RTN                   !
15960 !
15970 BOUND+   LDM R20,R14           !
15980          ADM R20,=PLTMP3       !
15990          JSB =CHK              !
16000 BOUND1   LDM R20,R14           !
16010          ADM R20,=PLTMP1       !
16020 CHK      LDMD R40,R20          !
16030          CLM R22               !
16040          JSB =CHKXYB           !
16050          LDMD R#,R#            !
16060          LDM R22,=10,0         !
16070 CHKXYB   BIN                   !
16080          ADM R#,R14            !
16090          PUMD R40,+R6          !
16100          LDMD R50,X22,GXHCL-   !
16110          JSB =COMFLT           !
16120          POMD R40,-R6          !
16130          JEZ P1<40             !
16140          LDMD R40,X22,GXHCL-   !
16150 P1<40    PUMD R#,+R6           !
16160          LDMD R50,X22,GXHCL+   !
16170          JSB =COMFLT           !
16180          POMD R40,-R6          !
16190          JEN P2>40             !
16200          LDMD R40,X22,GXHCL+   !
16210 P2>40    PUMD R#,+R20          !
16220          BIN                   !
16230          RTN                   !
16240 !
16250 CLEERR   JSB =GETBUF           !
16260          LDM R46,=117,105      !
16270          PUMD R46,+R30         !
16280          JSB =OUTBF            !
16290          JSB =PLTINP           !
16300          POMD R44,-R12         !
16310          RTN                   !
16320 !
16330          BYT 241               !
16340 FRAME.   JSB =BEGIN            !
16350 FR+      JSB =MOVCL-           !
16360          JSB =SEMO1            !
16370          JSB =GETCL            !
16380          LDMD R40,X32,GXHCL-   !
16390          STMD R40,X14,PLTMP1   !
16400          LDMD R40,X32,GYHCL+   !
16410          STMD R40,X14,PLTMP2   !
16420          JSB =SEDR1            !
16430          JSB =GETCL            !
16440          ADM R#,=GXHCL+        !
16450          JSB =MOVCL+           !
16460          JSB =SEDR1            !
16470          JSB =GETCL            !
16480          LDMD R40,X#,GXHCL+    !
16490          LDMD R50,X#,GYHCL-    !
16500          STMD R40,X14,PLTMP1   !
16510          STMD R50,X14,PLTMP2   !
16520          JSB =SEDR1            !
16530          JSB =MOVCL-           !
16540          LDM R46,=2,0          !
16550          JSB =DRAW2            !
16560          RTN                   !
16570 !
16580 GETCL    JSB =GETCL1           !
16590          ADM R#,R14            !
16600          ARP R32               !
16610 L6DE5    RTN                   !
16620 !
16630          BYT 241               !
16640 MOVE.    JSB =BEGIN            !
16650 MOVE+    JSB =GETXY            !
16660 SEMO0    JSB =CLXY2            !
16670 SEMO1    JSB =PR3637           !
16680          JSB =UPDOR            !
16690          JMP SEPL3             !
16700 !
16710          BYT 241               !
16720 DRAW.    JSB =BEGIN            !
16730 DRAW+    JSB =GETXY            !
16740 SEDR0    JSB =CLXY2            !
16750 SEDR1    LDM R30,=377,377      !
16760 DRAW2    STMD R#,X14,PCNTRL    !
16770          JMP SEPL1             !
16780 !
16790          BYT 241               !
16800 PLOT.    JSB =BEGIN            !
16810 PLOT+    JSB =GETPC            !
16820          JSB =GETXY            !
16830          JSB =CLXY2            !
16840 SEPL1    JSB =UPDOR            !
16850 SEPL2    JSB =PRCPC            !
16860 SEPL3    JSB =CLPXY            !
16870          JEN L6DE5             !
16880 SEPL4    JSB =P14              !
16890          RTN                   !
16900 !
16910          BYT 241               !
16920 IPLOT.   JSB =BEGIN            !
16930 IPLOT+   LDM R20,R14           !
16940          ADM R20,=GPXLOC       !
16950          JSB =ROTXY            !
16960          JMP SEPL1             !
16970 !
16980          BYT 241               !
16990 IMOVE.   JSB =BEGIN            !
17000 IMOV+    CLM R40               !
17010          LDB R47,=20C          !
17020 CHS40    LDB R41,=11           !
17030          PUMD R40,+R12         !
17040          JMP IPLOT+            !
17050 !
17060          BYT 241               !
17070 RPLOT.   JSB =BEGIN            !
17080 RPLOT+   LDM R20,R14           !
17090          ADM R20,=GOXLOC       !
17100          JSB =ROTXY            !
17110          JMP SEPL2             !
17120 !
17130          BYT 241               !
17140 IDRAW.   JSB =BEGIN            !
17150 IDRAW+   JSB =ONE.             !
17160          POMD R#,-R#           !
17170          JMP CHS40             !
17180 !
17190 CLXY4    BIN                   !
17200          LDM R34,R14           !
17210          ADM R34,=PLTMP1       !
17220          POMD R40,+R34         !
17230          PUMD R40,+R6          !
17240          POMD R40,+R34         !
17250          PUMD R40,+R6          !
17260          JSB =TOTMP1           !
17270          JSB =CLXY2            !
17280          JSB =MVTMP3           !
17290          POMD R40,-R6          !
17300          STMD R40,X14,PLTMP2   !
17310          POMD R40,-R6          !
17320          STMD R40,X14,PLTMP1   !
17330 CLXY2    JSB =CLXAX            !
17340          LDMD R#,X22,GXBGDU    !
17350          JSB =PUADPO           !
17360          STMD R#,X14,PLTMP1    !
17370 CALY     JSB =CLYAY            !
17380          LDMD R#,X22,GYBGDU    !
17390          JSB =PUADPO           !
17400          STMD R#,X14,PLTMP2    !
17410          RTN                   !
17420 !
17430 PUADPO   PUMD R#,+R12          !
17440 ADDRPO   JSB =PLADDR           !
17450          POMD R#,-R#           !
17460          RTN                   !
17470 !
17480 PLADD    JSB =PUSH             !
17490 PLADDR   BCD                   !
17500          JSB =ADDROI           !
17510          BIN                   !
17520          RTN                   !
17530 !
17540 GETPC    JSB =STACK            !
17550          CMB R#,=30            !
17560          JZR PCN               !
17570 GETPC1   CLM R46               !
17580          ICM R46               !
17590          JMP SCNTRL            !
17600 !
17610 PCN      JSB =ONEB             !
17620 SCNTRL   STMD R#,X14,PCNTRL    !
17630          RTN                   !
17640 !
17650 PR3637   LDM R30,=376,377      !
17660          JMP PRCP1             !
17670 !
17680 PRCPC    LDMD R32,X14,GFLAG    !
17690          ANM R32,=200,7        !
17700          CMM R32,=0,1          !
17710          JNZ PRCP1-            !
17720          PUMD R14,+R12         !
17730          JSB =PENUP            !
17740          POMD R14,-R12         !
17750          JSB =GETPC1           !
17760 PRCP1-   LDMD R30,X14,PCNTRL   !
17770 PRCP1    LDMD R32,X14,GFLAG    !
17780          STM R32,R34           !
17790          ANM R32,=0,10         !
17800          ANM R34,=377,367      !
17810          ANM R30,=1,200        !
17820          DRP R34               !
17830          JEV NTUDM             !
17840          ADM R34,=0,10         !
17850 NTUDM    JSB =STFLAG           !
17860          ORM R30,R32           !
17870          JPS DN?               !
17880          JEV PRCP2+            !
17890 PRCP2    LDM R32,=2,0          !
17900          ORM R30,R32           !
17910          JMP PRCP2+            !
17920 !
17930 DN?      TSB R31               !
17940          JRN PRCP2             !
17950 PRCP2+   STMD R30,X14,PCNTRL   !
17960          RTN                   !
17970 !
17980 CLPXY    LDM R34,R14           !
17990          ADM R34,=GPXLOC       !
18000          LDM R30,R14           !
18010          ADM R30,=PLTMP3       !
18020          JSB =MOVE20           !
18030          JSB =UPDAT            !
18040          JSB =FIXRND           !
18050          BIN                   !
18060          LDM R20,=10,0         !
18070          STBD R20,X14,CLPAB    !
18080 NXTSID   STM R20,R22           !
18090          ANM R22,=10,0         !
18100          ADM R22,R14           !
18110          LDMD R50,X22,PLTMP1   !
18120          JSB =FETVAL           !
18130          JSB =COMFLT           !
18140          TSB R20               !
18150          JNG MAXCOM            !
18160          TSM R50               !
18170          JZR GTOS5             !
18180          JEZ NOTS5             !
18190 GTOS5    GTO S5                !
18200 !
18210 MAXCOM   JEZ GTOS5             !
18220 NOTS5    LDMD R50,X22,PLTMP3   !
18230          JSB =FETVAL           !
18240          JSB =COMFLT           !
18250          TSB R20               !
18260          JNG MAXCM2            !
18270          TSM R50               !
18280          JZR S4                !
18290          JEN S4                !
18300 SEXIT    CLE                   !
18310          ICE                   !
18320          RTN                   !
18330 !
18340 MAXCM2   JEN SEXIT             !
18350 S4       BIN                   !
18360          STM R22,R24           !
18370          SBM R22,R14           !
18380 C.AORB   BCD                   !
18390          LDMD R40,X14,PLTMP2   !
18400          LDMD R50,X14,PLTMP3   !
18410          JSB =PLMULT           !
18420          LDMD R40,X14,PLTMP1   !
18430          LDMD R50,X14,PLTMP4   !
18440          JSB =PLMULT           !
18450          JSB =SUBROI           !
18460          BIN                   !
18470          LDM R26,R22           !
18480          ADM R26,R22           !
18490          ADM R26,R22           !
18500          TCM R26               !
18510          ADM R26,R14           !
18520          ADM R22,R14           !
18530          LDMD R50,X22,PLTMP2   !
18540          LDMD R40,X26,PLTMP4   !
18550          BCD                   !
18560          JSB =SUB10            !
18570          JSB =FETVAL           !
18580          PUMD R#,+R12          !
18590          JSB =PLMPYR           !
18600          JSB =SUBROI           !
18610          BIN                   !
18620          SBM R26,R14           !
18630          SBM R22,R14           !
18640          TCM R22               !
18650          TCM R26               !
18660          ADM R26,R14           !
18670          ADM R22,R14           !
18680          LDMD R50,X22,PLTMP3   !
18690          LDMD R40,X26,PLTMP1   !
18700          BCD                   !
18710          JSB =SUB10            !
18720          POMD R40,-R12         !
18730          JZR VALKNO            !
18740          PUMD R40,+R12         !
18750          JSB =PLDIVR           !
18760          POMD R40,-R12         !
18770 STPRIM   PUMD R#,+R6           !
18780          JSB =FETVAL           !
18790          STMD R#,X24,PLTMP1    !
18800          LDM R22,=10,0         !
18810          BIN                   !
18820          SBM R24,R14           !
18830          XRM R24,R22           !
18840          ADM R24,R14           !
18850          POMD R40,-R6          !
18860          STMD R40,X24,PLTMP1   !
18870          SBM R24,R14           !
18880          LDB R25,=200          !
18890          CMB R24,=20           !
18900          JCY SETMSB            !
18910          NCB R25               !
18920 SETMSB   LDBD R24,X14,CLPAB    !
18930          ORB R24,R25           !
18940          STBD R24,X14,CLPAB    !
18950 S6       BIN                   !
18960          SBM R20,=10,0         !
18970          CMB R20,=350          !
18980          JZR DRAWGO            !
18990          GTO NXTSID            !
19000 !
19010 VALKNO   POMD R#,-R#           !
19020          JSB =FETVAL           !
19030          JMP STPRIM            !
19040 !
19050 S5       LDMD R50,X22,PLTMP3   !
19060          JSB =FETVAL           !
19070          JSB =COMFLT           !
19080          TSB R20               !
19090          JNG MAXCM3            !
19100          TSM R50               !
19110          JZR S6                !
19120          JEN S6                !
19130 COMPB    LDM R24,R22           !
19140          BIN                   !
19150          ADM R24,=20,0         !
19160          SBM R22,R14           !
19170          GTO C.AORB            !
19180 !
19190 MAXCM3   JEZ S6                !
19200          JMP COMPB             !
19210 !
19220 DRAWGO   CLE                   !
19230          LDBD R47,X14,CLPAB    !
19240          ANM R47,=201          !
19250          STBD R47,X14,CLPAB    !
19260          RTN                   !
19270 !
19280 FETVAL   BIN                   !
19290          LDMD R46,X14,PLTMP6   !
19300          ADM R46,R14           !
19310          ADM R46,=GXHCL-       !
19320          ADM R46,R20           !
19330          LDMD R40,R46          !
19340          RTN                   !
19350 !
19360 SUB10    PUMD R50,+R12         !
19370          PUMD R40,+R12         !
19380          JSB =SUBROI           !
19390          RTN                   !
19400 !
19410          BYT 0,55              !
19420 RATIO.   JSB =BEGIN            !
19430          LDMD R40,X14,GXHCL-   !
19440          LDMD R50,X14,GXHCL+   !
19450          JSB =SUB10            !
19460          LDMD R40,X14,GYHCL-   !
19470          LDMD R50,X14,GYHCL+   !
19480          JSB =SUB10            !
19490          JSB =PLDIVR           !
19500          RTN                   !
19510 !
19520          BYT 241               !
19530 PDIR.    JSB =BEGIN            !
19540          JSB =GSICO            !
19550          LDM R30,R14           !
19560          ADM R30,=GSINPD       !
19570          JSB =FROMT1           !
19580 L70AC    RTN                   !
19590 !
19600 P4       LDM R76,=111,120      !
19610          JSB =HPILLM           !
19620          LDM R45,=73,117,105   !
19630          PUMD R45,+R30         !
19640          JSB =OUTBF            !
19650          JSB =PLTINP           !
19660          PUMD R14,+R6          !
19670          JSB =GETLST           !
19680          POMD R14,-R6          !
19690          TSM R40               !
19700          JNZ L70AC             !
19710          JSB =SEGP1X           !
19720          JSB =SENDIW           !
19730          CLE                   !
19740          ICE                   !
19750          RTN                   !
19760 !
19770 SEGP1X   LDM R30,R14           !
19780          ADM R30,=GP1X         !
19790          JSB =MT1.40           !
19800          RTN                   !
19810 !
19820 ROTXY    JSB =GETPC            !
19830          JSB =GETXY            !
19840          JSB =INCXY            !
19850          LDMD R#,X14,PLTMP1    !
19860          LDMD R50,X14,GCOSPD   !
19870          PUMD R50,+R6          !
19880          JSB =PLMULT           !
19890          LDMD R#,X14,PLTMP2    !
19900          LDMD R50,X14,GSINPD   !
19910          PUMD R50,+R6          !
19920          JSB =PLMULT           !
19930          JSB =SUBROI           !
19940          LDMD R#,X14,PLTMP1    !
19950          POMD R50,-R12         !
19960          STMD R50,X14,PLTMP1   !
19970          POMD R50,-R6          !
19980          JSB =PLMULT           !
19990          LDMD R#,X14,PLTMP2    !
20000          POMD R50,-R6          !
20010          JSB =PLMULT           !
20020          JSB =ADDRPO           !
20030          STMD R#,X14,PLTMP2    !
20040 ADDXY    LDM R0,R14            !
20050          ADM R0,=PLTMP1        !
20060          JSB =ADDCOM           !
20070 ADDCOM   POMD R40,+R20         !
20080          PUMD R40,+R12         !
20090          LDMD R40,R0           !
20100          JSB =PUADPO           !
20110          PUMD R#,+R0           !
20120          RTN                   !
20130 !
20140 INCXY    JSB =CLXAX            !
20150          POMD R#,-R#           !
20160          STMD R#,X14,PLTMP1    !
20170          JSB =CLYAY            !
20180          POMD R#,-R#           !
20190          STMD R#,X14,PLTMP2    !
20200          RTN                   !
20210 !
20220 PX2TM1   LDM R34,R14           !
20230          ADM R34,=GPXLOC       !
20240          JSB =TOTMP1           !
20250          RTN                   !
20260 !
20270 PX2USR   JSB =PX2TM1           !
20280 PX2US+   JSB =USERX            !
20290 USERY    JSB =GETCL            !
20300          LDMD R40,X#,GYBGDU    !
20310          LDMD R50,X14,PLTMP2   !
20320          LDM R0,=10,0          !
20330 USC      BCD                   !
20340          JSB =SUB10            !
20350          PUMD R0,+R6           !
20360          JSB =GETCL            !
20370          POMD R0,-R6           !
20380          ADM R32,R0            !
20390          LDMD R40,X32,GXAGDU   !
20400          JSB =PUDIVR           !
20410          RTN                   !
20420 !
20430 USERX    JSB =GETCL            !
20440          LDMD R40,X#,GXBGDU    !
20450          LDMD R50,X14,PLTMP1   !
20460          CLM R0                !
20470          JMP USC               !
20480 !
20490          BYT 241               !
20500 MSCAL.   JSB =BEGIN            !
20510          JSB =TWOR             !
20520          LDB R20,=11           !
20530          XRB R41,R20           !
20540          XRB R51,R20           !
20550          STMD R40,X14,PLTMP2   !
20560          STMD R50,X14,PLTMP1   !
20570          JSB =ABSDPY           !
20580          LDM R40,=230,220,0,0,0,0,0,45 ! =.025
20590          STMD R40,X14,PLTMP5   !
20600          JSB =PLMULT           !
20610          LDMD R#,X14,PLTMP2    !
20620          JSB =PUADPO           !
20630          STMD R#,X14,PLTMP4    !
20640          JSB =ABSDPX           !
20650          LDMD R40,X14,PLTMP5   !
20660          JSB =PLMULT           !
20670          LDMD R#,X14,PLTMP1    !
20680          JSB =PUADPO           !
20690          STMD R#,X14,PLTMP3    !
20700          JSB =SCAL1            !
20710          RTN                   !
20720 !
20730          BYT 241               !
20740 GCLER.   JSB =BEGIN            !
20750          JSB =P6               !
20760          RTN                   !
20770 !
20780          BYT 241               !
20790 UNCLP.   JSB =BEGIN            !
20800          LDM R34,R14           !
20810          ADM R34,=GXHCL+       !
20820          JSB =FTOT1            !
20830          JSB =FIXRND           !
20840          BIN                   !
20850          LDM R30,R14           !
20860          ADM R30,=GXSCL+       !
20870          JSB =MT1.40           !
20880          RTN                   !
20890 !
20900          BYT 241               !
20910 SHOW.    JSB =BEGIN            !
20920          JSB =GFOUR            !
20930          JSB =CALDPX           !
20940          STMD R#,X14,GXBUSR    !
20950          PUMD R#,+R12          !
20960          JSB =T3-1             !
20970          STMD R#,X14,GXAUSR    !
20980          JSB =SHOWUT           !
20990          STMD R#,X14,PLTMP6    !
21000          PUMD R#,+R12          !
21010          JSB =CALDPY           !
21020          STMD R#,X14,GYBUSR    !
21030          PUMD R#,+R12          !
21040          JSB =T4-2             !
21050          STMD R#,X14,GYAUSR    !
21060          JSB =SHOWUT           !
21070          STMD R#,X14,PLTMP5    !
21080          POMD R50,-R12         !
21090          JSB =COMFLT           !
21100          CLM R20               !
21110          JEN X>Y               !
21120          LDB R20,=10           !
21130 X>Y      BIN                   !
21140          STM R#,R22            !
21150          ADM R22,R14           !
21160          BCD                   !
21170          LDMD R50,X22,PLTMP1   !
21180          PUMD R50,+R12         !
21190          LDMD R50,X22,PLTMP3   !
21200          PUMD R50,+R12         !
21210          LDMD R50,X22,GXBUSR   !
21220          LDMD R40,X22,GXAUSR   !
21230          LRB R51               !
21240          ERB R41               !
21250          ELB R51               !
21260          LDMD R40,X22,PLTMP5   !
21270          JSB =DIV10            !
21280          LDMD R40,X22,GXAUSR   !
21290          PUMD R40,+R12         !
21300          JSB =SUBROI           !
21310          CLM R#                !
21320          LDB R47,=40           !
21330          JSB =PUDVPO           !
21340          STMD R#,X14,PLTMP5    !
21350          JSB =PUADPO           !
21360          STMD R#,X22,PLTMP3    !
21370          LDMD R#,X14,PLTMP5    !
21380          PUMD R#,+R12          !
21390          JSB =SUBPOP           !
21400          STMD R#,X22,PLTMP1    !
21410          JSB =SCAL1            !
21420          RTN                   !
21430 !
21440 SHOWUT   JSB =PUDVP+           !
21450          LRB R41               !
21460          LLB R41               !
21470          DRP R40               !
21480          RTN                   !
21490 !
21500          BYT 241               !
21510 CURSR.   JSB =BEGIN            !
21520          JSB =P24              !
21530          LDM R34,R14           !
21540          ADM R34,=GXCURS       !
21550          JMP SEWH1             !
21560 !
21570          BYT 241               !
21580 WHERE.   JSB =BEGIN            !
21590          LDM R34,R14           !
21600          ADM R34,=GPXLOC       !
21610 SEWH1    JSB =TOTMP1           !
21620 TRANV    JSB =STACK            !
21630          CMB R#,=10            !
21640          JZR NOPENT            !
21650          CMB R#,=15            !
21660          JZR NOPENT            !
21670          CMB R#,=22            !
21680          JZR NOPENT            !
21690          JSB =GETPF            !
21700          ANM R#,=0,10          !
21710          JZR ZEROT             !
21720          JSB =ONE.             !
21730          JMP CALSTO            !
21740 !
21750 ZEROT    CLM R40               !
21760          PUMD R40,+R12         !
21770 CALSTO   JSB =STOSV            !
21780 NOPENT   JSB =USERY            !
21790          JSB =STOSV            !
21800          JSB =USERX            !
21810          JSB =STOSV            !
21820          RTN                   !
21830 !
21840          BYT 241               !
21850 DIGIT.   JSB =BEGIN            !
21860          JSB =DONEP+           !
21870          JEN TRANV             !
21880          RTN                   !
21890 !
21900          BYT 241               !
21910 FXD.     JSB =BEGIN            !
21920          JSB =FXD1             !
21930          JSB =STACK            !
21940          JZR FXD0              !
21950          ICM R14               !
21960          JSB =FXD1             !
21970 FXD0     RTN                   !
21980 !
21990 FXD1     JSB =ONEB             !
22000          CMM R#,=10,0          !
22010          JNC FXDOK             !
22020          CLM R#                !
22030 FXDOK    STB R#,R77            !
22040          STMD R#,X14,LAXNY     !
22050          RTN                   !
22060 !
22070          BYT 241               !
22080 VELO.    JSB =BEGIN            !
22090          JSB =STACK            !
22100          LDM R22,=126,123      !
22110          PUMD R22,+R30         !
22120          TSB R26               !
22130          JZR VELD              !
22140          JSB =ONER             !
22150          JSB =PUTFDC           !
22160 VELD     JSB =OUTBF            !
22170          JSB =CLEERR           !
22180 L7342    RTN                   !
22190 !
22200          BYT 241               !
22210 LABEL.   JSB =BEGIN            !
22220          LDM R56,=255D,0       !
22230          JSB =RSMEM-           !
22240          JEN L7342             !
22250          STMD R26,X14,LBLBUF   !
22260          JSB =PRINT.           !
22270          JSB =FILOPN           !
22280          LDB R40,=3            !
22290          STBD R40,=ROUTE       !
22300          LDBD R70,=PRNTLN      !
22310          STBD R70,X14,PLTMP7   !
22320          CLM R70               !
22330          STBD R70,=PRNTLN      !
22340          STMD R74,X14,GLBADD   !
22350          RTN                   !
22360 !
22370          BYT 35                !
22380 LBEOL.   BIN                   !
22390          JSB =PRLINE           !
22400          JSB =FILOPN           !
22410          LDBD R71,X14,PLTMP7   !
22420          STBD R71,=PRNTLN      !
22430          CLB R71               !
22440          ICB R71               !
22450          STBD R71,=ROUTE       !
22460          CLB R71               !
22470 STLBLF   STBD R#,X14,GLBLFL    !
22480          RTN                   !
22490 !
22500 LBTRP1   JSB =EVIL             !
22510          DEF S20-47            !
22520          CLB R2                !
22530          STBD R2,=HANDLD       !
22540          JSB =FILOPN           !
22550          LDB R32,=12           !
22560          JSB =LBPSH            !
22570          JSB =LABOL3           !
22580          JSB =P32              !
22590          JSB =FILOPN           !
22600          LDMD R64,X14,GLBADD   !
22610          CLM R66               !
22620          LDM R30,R64           !
22630          STMD R30,X14,LBLBUF   !
22640          JSB =LABOL3           !
22650          RTN                   !
22660 !
22670 LBLTRP   PUMD R30,+R6          !
22680          JSB =FILOPN           !
22690          CLB R2                !
22700          STBD R2,=HANDLD       !
22710          CLB R24               !
22720          ICB R24               !
22730          JSB =STLBLF           !
22740          JSB =LBPSH            !
22750          CMB R66,=254D         !
22760          JZR LTRP1             !
22770 LTRP0    STMD R30,X14,LBLBUF   !
22780          POMD R30,-R6          !
22790 LABOL3   DRP R64               !
22800 STBADD   STMD R#,X14,GLBADD    !
22810          RTN                   !
22820 !
22830 LBPSH    LDMD R30,X14,LBLBUF   !
22840          LDMD R64,X14,GLBADD   !
22850          JNZ LABOL2            !
22860          STM R30,R64           !
22870 LABOL2   PUBD R32,+R30         !
22880          ICM R66               !
22890          RTN                   !
22900 !
22910 LTRP1    JSB =LBTRP1           !
22920          POMD R30,-R6          !
22930          RTN                   !
22940 !
22950          BYT 241               !
22960 GRID.    JSB =BEGIN            !
22970          LDB R26,=7            !
22980          JMP AXES.+            !
22990 !
23000          BYT 241               !
23010 LAXES.   JSB =BEGIN            !
23020          LDB R26,=203          !
23030          JMP AXES.+            !
23040 !
23050          BYT 241               !
23060 LGRID.   JSB =BEGIN            !
23070          LDB R26,=207          !
23080          JMP AXES.+            !
23090 !
23100          BYT 241               !
23110 AXES.    JSB =BEGIN            !
23120          LDB R26,=3            !
23130 AXES.+   STBD R#,=AXFLAG       !
23140          JSB =GAXBUF           !
23150          JSB =DFTIC            !
23160          JSB =STACK            !
23170          JZR DEFALL            !
23180          JRZ TFS               !
23190          JSB =ONER             !
23200          LDMD R26,=AXBUF       !
23210          STMD R40,X26,AXSIZE   !
23220          LDB R26,=60           !
23230 TFS      BIN                   !
23240          LRB R#                !
23250          JRZ EFF               !
23260          JLZ TEE               !
23270          JSB =TWOB             !
23280 YAGN     LDMD R26,=AXBUF       !
23290          STMD R46,X26,AYMAJR   !
23300          JNZ XAGN              !
23310          ICM R46               !
23320          JMP YAGN              !
23330 !
23340 XAGN     STMD R56,X26,AXMAJR   !
23350          JNZ TICOK             !
23360          ICM R56               !
23370          JMP XAGN              !
23380 !
23390 EFF      CLM R46               !
23400          CLM R56               !
23410          JMP YAGN              !
23420 !
23430 DEFALL   CLM R0                !
23440          JSB =GENSPC           !
23450          PUMD R40,+R6          !
23460          LDM R0,=YINDX         !
23470          JSB =GENSPC           !
23480          POMD R50,-R6          !
23490          JSB =PUSH             !
23500          CLM R40               !
23510          JMP TEE+              !
23520 !
23530 TEE      CLM R40               !
23540          PUMD R40,+R12         !
23550          PUMD R40,+R12         !
23560 TEE+     STM R#,R50            !
23570          JMP YAGN              !
23580 !
23590 TICOK    JSB =TWOR             !
23600          LDMD R26,=AXBUF       !
23610          STMD R40,X26,AYINTR   !
23620          STMD R50,X26,AXINTR   !
23630          JSB =TWOR             !
23640          LDBD R26,=AXFLAG      !
23650          ERB R41               !
23660          JEZ YPOS              !
23670          BIN                   !
23680          ADB R26,=20           !
23690          BCD                   !
23700 YPOS     ERB R51               !
23710          JEZ XPOS              !
23720          BIN                   !
23730          ADB R26,=10           !
23740          BCD                   !
23750 XPOS     STBD R26,=AXFLAG      !
23760          LLB R41               !
23770          LLB R51               !
23780          LDMD R26,=AXBUF       !
23790          STMD R40,X26,AYSPAC   !
23800          STMD R50,X26,AXSPAC   !
23810          CLM R0                !
23820          JSB =BGNEN-           !
23830          LDM R0,=YINDX         !
23840          JSB =BGNEN-           !
23850          JMP AXAXAX            !
23860 !
23870          BYT 241               !
23880 XAXIS.   JSB =BEGIN            !
23890          CLM R0                !
23900          LDB R30,=1            !
23910          JMP X-YAX             !
23920 !
23930          BYT 241               !
23940 YAXIS.   JSB =BEGIN            !
23950          LDM R0,=YINDX         !
23960          LDB R30,=2            !
23970 X-YAX    STBD R#,=AXFLAG       !
23980          STMD R0,=AXINDX       !
23990          JSB =GAXBUF           !
24000          JSB =STACK            !
24010          JLN TWOFOR            !
24020          CLM R40               !
24030          PUMD R40,+R12         !
24040 TWO      JSB =BGNEND           !
24050 TWO+     JSB =ONER             !
24060          STB R41,R51           !
24070          ERB R41               !
24080          LLB R41               !
24090          LDMD R26,=AXBUF       !
24100          BIN                   !
24110          ADM R26,R0            !
24120          STMD R40,X26,AXSPAC   !
24130          LDMD R40,X26,AXSTRT   !
24140          TSB R51               !
24150          JRZ L751D             !
24160          LDMD R40,X26,AXEND    !
24170 L751D    LDM R30,=YINDX        !
24180          XRM R30,R0            !
24190          LDMD R32,=AXBUF       !
24200          ADM R30,R32           !
24210          STMD R40,X30,AYINTR   !
24220          LDM R30,=1,0          !
24230          STMD R30,X26,AXMAJR   !
24240          PUMD R26,+R6          !
24250          JSB =DFTIC            !
24260          JSB =ONER             !
24270          POMD R26,-R6          !
24280          STMD R40,X26,AYINTR   !
24290 AXAXAX   GTO AXMAIN            !
24300 !
24310 DFTIC    CLM R40               !
24320          LDB R47,=40           !
24330          LDMD R26,=AXBUF       !
24340          STMD R40,X26,AXSIZE   !
24350          RTN                   !
24360 !
24370 TWOFOR   CMB R#,=20            !
24380          JZR TWO               !
24390          JSB =TWOR             !
24400          BIN                   !
24410          LDMD R0,=AXINDX       !
24420          LDMD R26,=AXBUF       !
24430          ADM R26,R0            !
24440          STMD R40,X26,AXEND    !
24450          STMD R50,X26,AXSTRT   !
24460          JSB =COMFLT           !
24470          JEZ TWO+              !
24480 !
24490          JSB =ERR1+            !
24500          BYT 89D               !
24510 !
24520 BGNEN-   STMD R0,=AXINDX       !
24530 BGNEND   JSB =GETCL            !
24540          LDMD R0,=AXINDX       !
24550          TSM R0                !
24560          JZR XSETUP            !
24570          ADM R32,=10,0         !
24580 XSETUP   LDMD R40,X32,GXHCL+   !
24590          POMI R40,-R6          !
24600          LDMD R40,X32,GXHCL-   !
24610          JSB =USER             !
24620          LDMD R26,=AXBUF       !
24630          BIN                   !
24640          ADM R26,R0            !
24650          STMD R40,X26,AXSTRT   !
24660          POMD R40,-R6          !
24670          JSB =USER             !
24680          BIN                   !
24690          LDMD R26,=AXBUF       !
24700          ADM R26,R0            !
24710          STMD R40,X26,AXEND    !
24720          RTN                   !
24730 !
24740 USER     STMD R#,X14,PLTMP1    !
24750          STMD R#,X14,PLTMP2    !
24760          TSM R0                !
24770          JZR USERXS            !
24780          JSB =USERY            !
24790 USERC    LDMD R0,=AXINDX       !
24800          POMD R40,-R12         !
24810          ARP R0                !
24820 L75D3    RTN                   !
24830 !
24840 USERXS   JSB =USERX            !
24850          JMP USERC             !
24860 !
24870 AXMAIN   BIN                   !
24880          CLM R0                !
24890          LDBD R30,=AXFLAG      !
24900          JEV TRYYAX            !
24910          JSB =AXISG-           !
24920 TRYYAX   BIN                   !
24930          JSB =FILOPN           !
24940          LDBD R30,=AXFLAG      !
24950          LRB R30               !
24960          JEV L75D3             !
24970          LDM R0,=YINDX         !
24980 AXISG-   STMD R0,=AXINDX       !
24990 AXISGN   LDMD R26,=AXBUF       !
25000          ADM R26,R0            !
25010          LDMD R40,X26,AXSTRT   !
25020          LDMD R50,X26,AXEND    !
25030          PUMD R26,+R6          !
25040          JSB =COMFLT           !
25050          POMD R26,-R6          !
25060          DRP R50               !
25070          JEN AXORDR            !
25080          LDMD R50,X26,AXSTRT   !
25090          LDMD R40,X26,AXEND    !
25100          STMD R40,X26,AXSTRT   !
25110          STMD R50,X26,AXEND    !
25120 AXORDR   LDMD R40,X26,AXSPAC   !
25130          JNZ SET1ST            !
25140          LDMD R40,X26,AXEND    !
25150          STMD R40,X26,AXTIC1   !
25160          JMP GOGEN             !
25170 !
25180 SET1ST   LDMD R36,X26,AXMAJR   !
25190          JSB =CMPAX1           !
25200          CLM R36               !
25210          ICM R36               !
25220          JSB =CMPAX1           !
25230          STMD R#,X26,AXTIC1    !
25240          JSB =SUBROI           !
25250          LDMD R#,X26,AXSPAC    !
25260          PUMD R#,+R12          !
25270          JSB =PLDIVR           !
25280          JSB =ONEB             !
25290          STMD R#,=ATICNT       !
25300 GOGEN    LDMD R50,X26,AXSTRT   !
25310          LDMD R40,X26,AYINTR   !
25320          JSB =SWITCH           !
25330          JSB =PUSH             !
25340          JSB =FILOPN           !
25350          JSB =MOVE+            !
25360          JSB =FILOPN           !
25370          LDMD R0,=AXINDX       !
25380          CLM R50               !
25390          JMP CKOUTB            !
25400 !
25410 AXLP     LDMD R0,=AXINDX       !
25420          BIN                   !
25430          LDMD R26,=AXBUF       !
25440          ADM R26,R0            !
25450          LDMD R50,X26,AXSPAC   !
25460 CKOUTB   BIN                   !
25470          LDMD R26,=AXBUF       !
25480          ADM R26,R0            !
25490          LDMD R40,X26,AXTIC1   !
25500          JSB =PLADD            !
25510          JSB =STOP?            !
25520          JEN EZOUT             !
25530          JSB =FILOPN           !
25540          POMD R40,-R12         !
25550          PUMD R40,+R12         !
25560          STMD R40,X14,PLTMP3   !
25570          STMD R40,X14,PLTMP4   !
25580          LDMD R40,X26,AXEND    !
25590          STMD R40,X14,PLTMP1   !
25600          STMD R40,X14,PLTMP2   !
25610          JSB =CLXY4            !
25620          JSB =FIXRND           !
25630          LDMD R0,=AXINDX       !
25640          JZR ITSXAX            !
25650          JSB =TMP4-2           !
25660          JMP ITWASY            !
25670 !
25680 EZOUT    JMP EXMAIN            !
25690 !
25700 ITSXAX   JSB =TMP3-1           !
25710 ITWASY   POMD R40,-R12         !
25720          STMD R40,X26,AXTIC1   !
25730          JEN OFFAX             !
25740          JSB =AXDSUB           !
25750          JSB =FILOPN           !
25760          LDMD R0,=AXINDX       !
25770          BIN                   !
25780          LDMD R26,=AXBUF       !
25790          ADM R26,R0            !
25800          LDMD R40,X26,AXSPAC   !
25810          JZR EXMAIN            !
25820          LDBD R40,=AXFLAG      !
25830          LRB R40               !
25840          LRB R40               !
25850          LDMD R30,=ATICNT      !
25860          JZR MAJORT            !
25870          DCM R30               !
25880          STMD R30,=ATICNT      !
25890          JSB =TICMIN           !
25900 AXLP1    GTO AXLP              !
25910 !
25920 MAJORT   LDMD R#,X26,AXMAJR    !
25930          DCM R#                !
25940          STMD R#,=ATICNT       !
25950          JSB =TICMAJ           !
25960          LDMD R0,=AXINDX       !
25970          LDBD R30,=AXFLAG      !
25980          JPS AXLP1             !
25990          JSB =LAX              !
26000          JMP AXLP1             !
26010 !
26020 OFFAX    LDMD R#,X26,AXEND     !
26030          JSB =AXDSUB           !
26040 EXMAIN   JSB =PENUP            !
26050 L7723    RTN                   !
26060 !
26070 SWITCH   TSM R0                !
26080          JZR L7723             !
26090 SWITC+   PUMD R40,+R12         !
26100          LDM R40,R50           !
26110          POMD R50,-R12         !
26120          RTN                   !
26130 !
26140 CMPAX1   JSB =CONBIN           !
26150          LDMD R50,X26,AXSPAC   !
26160          JSB =PLMULT           !
26170          POMD R#,-R#           !
26180          STMD R#,X14,PLTMP2    !
26190          BIN                   !
26200          LDM R30,=YINDX        !
26210          XRM R30,R0            !
26220          LDMD R32,=AXBUF       !
26230          ADM R30,R32           !
26240          LDMD R40,X30,AYINTR   !
26250          STMD R40,X14,PLTMP1   !
26260          LDMD R40,X26,AXSTRT   !
26270          JSB =RNDOFF           !
26280          STMD R#,X14,PLTMP3    !
26290          JSB =O-S^T^           !
26300          JSB =MELJSB           !
26310          DEF REM10.            !
26320          JSB =SUBROI           !
26330          JSB =NOT2FR           !
26340          POMD R#,-R#           !
26350          PUMD R#,+R#           !
26360          STMD R#,X14,PLTMP1    !
26370          JSB =O-S^T^           !
26380          JSB =ADDRPO           !
26390          JNZ NOT2FR            !
26400          LDMD R#,X14,PLTMP2    !
26410          PUMD R#,+R12          !
26420          JSB =SUBROI           !
26430 NOT2FR   LDMD R50,X14,PLTMP3   !
26440          LDMD R40,X14,PLTMP1   !
26450          JSB =PUSH             !
26460          JSB =GR.              !
26470          LDMD R#,X14,PLTMP2    !
26480          PUMD R#,+R12          !
26490          JSB =PLMPYR           !
26500          JSB =PLADDR           !
26510          RTN                   !
26520 !
26530 O-S^T^   JSB =T3-1             !
26540          PUMD R#,+R12          !
26550          LDMD R#,X14,PLTMP2    !
26560          PUMD R#,+R12          !
26570          RTN                   !
26580 !
26590 TICMAJ   TSB R40               !
26600          JEV GEN2              !
26610          CLM R40               !
26620          LDB R47,=20           !
26630          LDB R40,=231          !
26640          PUMD R40,+R12         !
26650          JMP PUSHR#            !
26660 !
26670 GEN2     CLM R#                !
26680          LDB R47,=40           !
26690          JMP TICCOM            !
26700 !
26710 TICMIN   TSB R40               !
26720          JOD GEN2              !
26730          CLM R40               !
26740          LDB R47,=100          !
26750 TICCOM   LDMD R26,=AXBUF       !
26760          LDMD R50,X26,AXSIZE   !
26770          BCD                   !
26780          JSB =DIV10            !
26790 PUSHR#   POMD R#,-R#           !
26800          PUMD R#,+R#           !
26810          PUMD R#,+R#           !
26820          JSB =TIC              !
26830          BCD                   !
26840          JSB =CHSROI           !
26850 TIC      JSB =FILOPN           !
26860          LDMD R0,=AXINDX       !
26870          POMD R50,-R12         !
26880          CLM R40               !
26890          JSB =SWITCH           !
26900          STMD R40,X14,PLTMP1   !
26910          STMD R50,X14,PLTMP2   !
26920          CLM R32               !
26930          STMD R32,X14,PLTMP6   !
26940          JSB =INCXY            !
26950          LDM R20,R14           !
26960          BIN                   !
26970          ADM R20,=GPXLOC       !
26980          JSB =ADDXY            !
26990          JSB =GETCL1           !
27000          CLM R30               !
27010          DCM R30               !
27020          STMD R30,X14,PCNTRL   !
27030          JSB =SEPL2            !
27040 BACKAX   JSB =FILOPN           !
27050          LDMD R26,=AXBUF       !
27060          LDMD R50,X26,AX       !
27070          LDMD R40,X26,AY       !
27080          JSB =PUSH             !
27090          JSB =MOVE+            !
27100          RTN                   !
27110 !
27120 LAX      JSB =GETCL            !
27130          JSB =EDGE             !
27140          STMD R#,X14,PLTMP1    !
27150          JSB =GETCL            !
27160          ADM R#,=10,0          !
27170          JSB =EDGE             !
27180          STMD R#,X14,PLTMP2    !
27190          JSB =PX2US+           !
27200          JSB =GETXY            !
27210          JSB =XORY             !
27220          TSM R0                !
27230          DRP R40               !
27240          JNZ LAY               !
27250          STMD R40,X14,PLTMP1   !
27260          JMP LMOVE             !
27270 !
27280 LAY      STMD R#,X14,PLTMP2    !
27290 LMOVE    JSB =SEMO0            !
27300          JSB =FILOPN           !
27310          JSB =XORY             !
27320          CLM R70               !
27330          LDB R74,=10C          !
27340          JSB =SEPRND           !
27350          LDM R55,=2,1,56       !
27360          STM R55,R70           !
27370          CLM R54               !
27380          LDB R54,=9D           !
27390          ARP R14               !
27400          LDMD R20,=AXINDX      !
27410          JNZ LDNY              !
27420          LDBD R20,X14,LAXN     !
27430          JMP LAXNNN            !
27440 !
27450 LDNY     LDBD R#,X#,LAXNY      !
27460 LAXNNN   STB R#,R74            !
27470          ADM R#,R36            !
27480          JLN EFMT              !
27490          CMM R#,=7,0           !
27500          JCY EFMT              !
27510          LDB R76,=7            !
27520          SBB R76,R74           !
27530          TSB R74               !
27540          JNZ FORMNC            !
27550          CLB R71               !
27560          JMP CL72              !
27570 !
27580 EFMT     ICB R73               !
27590          CLM R74               !
27600          ICB R76               !
27610          DCB R54               !
27620 CL72     DCB R54               !
27630          CLB R72               !
27640 FORMNC   JSB =XORY             !
27650          LDM R26,=ERRBUF       !
27660          JSB =FORMN+           !
27670          STM R54,R56           !
27680          LDM R36,=ERRBUF       !
27690          BIN                   !
27700 POPLP    POBD R54,+R36         !
27710          CMB R54,=40           !
27720          JNZ GCH               !
27730          DCB R56               !
27740          JMP POPLP             !
27750 !
27760 GCH      PUBD R#,-R#           !
27770          STM R36,R54           !
27780          CLB R57               !
27790          ADM R36,R56           !
27800          LDB R50,=40           !
27810          PUBD R50,+R36         !
27820          ICB R56               !
27830          STMD R54,X14,GLBADD   !
27840          JSB =GETPF            !
27850          PUMD R#,+R6           !
27860          LDM R#,=10,0          !
27870          LDMD R40,X14,GSINLD   !
27880          PUMD R40,+R6          !
27890          LDMD R40,X14,GCOSLD   !
27900          PUMD R40,+R6          !
27910          JSB =ONE.             !
27920          POMD R#,-R#           !
27930          CLM R50               !
27940          LDBD R20,=AXFLAG      !
27950          LRB R20               !
27960          LRB R20               !
27970          LRB R20               !
27980          LDMD R0,=AXINDX       !
27990          JZR XL                !
28000          JSB =SWITC+           !
28010          LRB R20               !
28020 XL       TSB R20               !
28030          JEV EVEN              !
28040          JSB =SWITC+           !
28050          DCB R32               !
28060          DCB R32               !
28070 EVEN     JSB =ORGDIR           !
28080          JSB =P32              !
28090          POMD R50,-R6          !
28100          POMD R40,-R6          !
28110          CLM R32               !
28120          JSB =ORGDIR           !
28130          POMD R32,-R6          !
28140          JSB =STFLAG           !
28150          JSB =BACKAX           !
28160 L7932    RTN                   !
28170 !
28180 XORY     LDMD R26,=AXBUF       !
28190          LDMD R40,X26,AX       !
28200          LDMD R0,=AXINDX       !
28210          JZR L7932             !
28220          LDMD R40,X26,AY       !
28230          RTN                   !
28240 !
28250 GENSPC   JSB =BGNEN-           !
28260          STM R#,R50            !
28270          LDMD R#,X26,AXSTRT    !
28280          PUMD R#,+R6           !
28290          BCD                   !
28300          JSB =SUB10            !
28310          JSB =ONE.             !
28320          POMD R#,-R#           !
28330          ICB R#                !
28340          PUMD R#,+R#           !
28350          JSB =DIV2             !
28360          POMD R#,-R#           !
28370          CLB R42               !
28380          CLB R43               !
28390          CLB R44               !
28400          PUMD R40,+R#          !
28410          POMD R40,-R6          !
28420          JSB =RNDOFF           !
28430          POMD R40,-R12         !
28440          RTN                   !
28450 !
28460 EDGE     LDMD R40,X#,GXHCL-    !
28470          PUMD R40,+R12         !
28480          LDMD R50,X32,GXHCL+   !
28490          BCD                   !
28500          JSB =SUB10            !
28510          CLM R#                !
28520          ICB R#                !
28530          LDB R47,=140          !
28540          PUMD R40,+R#          !
28550          JSB =DIV2             !
28560          JSB =SUBPOP           !
28570          RTN                   !
28580 !
28590 GAXBUF   LDM R56,=160D,0       !
28600          JSB =RSMEM-           !
28610          STMD R26,=AXBUF       !
28620          JEZ L799D             !
28630          POMD R26,-R6          !
28640 L799D    RTN                   !
28650 !
28660 AXDSUB   LDM R50,R40           !
28670          LDMD R40,X26,AYINTR   !
28680          JSB =SWITCH           !
28690          BIN                   !
28700          SBM R26,R0            !
28710          STMD R40,X26,AY       !
28720          STMD R50,X26,AX       !
28730          JSB =PUSH             !
28740          JSB =FILOPN           !
28750          JSB =DRAW+            !
28760          RTN                   !
28770 !
28780 RNDOFF   BCD                   !
28790          JSB =SEP10            !
28800          LRM R47               !
28810          LRM R47               !
28820 !
28830 ! NOTE: In the source code listing, ROU10 is DAD'd at the
28840 ! front of file PO6 as being 36271, and that's the address
28850 ! that is shown in the symbol table at the end of PO6 (as
28860 ! it's hex value, 3CB9).  HOWEVER...
28870 !
28880 ! The GLOBALS file shows a value of 36270 for ROU10 (it's
28890 ! in the system ROMs), ONE LESS, and that IS where the
28900 ! routine is located, in both the rev 'a' listing and in
28910 ! the rev 'd' listing.
28920 !
28930 ! In the PLOTTER ROM source listing, the ROU10 routine is
28940 ! called from the RNDOFF routine on PG 18 of file PO6,
28950 ! which is on page 55 of 57 of the .PDF I'm using.  The
28960 ! ROU10 DAD statement is on PG 1 of the same file, on page
28970 ! 51 of 57 of the .PDF file.
28980 !
28990 ! One possibility that occurred to me is that the PLOTTER
29000 ! ROM programmer was being cute and jumping INTO the ROU10
29010 ! routine PAST the first byte, which would probably be a
29020 ! DRP instruction (and, indeed, it is, DRP 40, as the ROU10
29030 ! routine starts with STM R40,R50).  So, maybe, he was
29040 ! using a different register than R40 and setting the DRP
29050 ! before jumping into ROU10.  But no, ROU10 is ONLY called
29060 ! from right here (below) in the RNDOFF routine, and the
29070 ! RNDOFF routine is only called from two other places,
29080 ! both of which are loading R40 with a number.  And here
29090 ! in the RNDOFF rouine, the DRP is left at R47 before
29100 ! calling ROU10, so the effect of jumping into ROU10 past
29110 ! the first byte would be to do STM R47,R50, which makes
29120 ! no sense, given what ROU10 is supposed to be doing.
29130 !
29140 ! There's a note in the PLOTTER ROM source code, right above
29150 ! the call to ROU10, "need to have Gary Cutler make this an
29160 ! entry point," and why would he use the same LABEL as the
29170 ! actual system routine, but change the address by ONE, so
29180 ! that the same label is floating around referring to TWO
29190 ! different entry points???
29200 !
29210 ! Makes no sense.  Therefore, I posit that the typing of the
29220 ! address in the PLOTTER ROM source code was mistaken and
29230 ! was a bug that was never found/caught, because the project
29240 ! was cancelled before it was released. Based upon all of the
29250 ! above reasoning, I'm going to use the ACTUAL address of
29260 ! ROU10 in the system ROMs for this call rather than the
29270 ! 'erroneous' one specified in the PLOTTER ROM source code.
29280 !
29290 ! This has the chance to affect the callers of RNDOFF, which
29300 ! are CMPAX1 and GENSPC.  CMPAX1 is only called from SET1ST,
29310 ! and GENSPC is only called from DEFALL.  SET1ST appears to
29320 ! only be called from the XAXIS and YAXIS statements, and
29330 ! DEFALL appears to only be called from the AXES, LAXES,
29340 ! GRID, and LGRID statements.  This makes sense, since the
29350 ! "section header" where the RNDOFF routine is located is
29360 ! named, "AXES Subroutines."
29370 !
29380 ! So, to verify whether I guessed right on the correct address
29390 ! or not, these statements need thorough testing:
29400 !
29410 ! XAXIS, YAXIS, AXES, LAXES, GRID, LGRID
29420 !
29430 ! And in reality, probably they'll all work or they'll all
29440 ! fail, depending upon the values provided for drawing the
29450 ! axes/grids, as this is doing floating point math to
29460 ! calculate where to draw lines and tic marks, so scaling
29470 ! might potentially affect the testing as well.
29480 !
29490          JSB =ROU10            !
29500          LLM R40               !
29510          JLZ NOCARY            !
29520          ICM R36               !
29530          JMP DONFRA            !
29540 !
29550 NOCARY   LLM R#                !
29560 DONFRA   JSB =NFR              !
29570          RTN                   !
29580 !
29590 ORGDIR   STMD R40,X14,PLTMP1   !
29600          STMD R50,X14,PLTMP2   !
29610          LDM R76,R32           !
29620          JSB =LORG2            !
29630          JSB =LDIR+            !
29640          JSB =FILOPN           !
29650          RTN                   !
29660 !
29670 P32      JSB =PX2USR           !
29680          JSB =GETXY            !
29690          JSB =CLXY2            !
29700          JSB =PR3637           !
29710          JSB =SEPL4            !
29720          JSB =FILOPN           !
29730          JSB =GTORG            !
29740          JEZ NOORG             !
29750          JSB =PUCPPO           !
29760          JSB =PUTFDC           !
29770          JSB =PUTCM            !
29780          POMD R#,-R12          !
29790          JSB =P30OUT           !
29800 NOORG    LDM R26,=LB           !
29810          JSB =FXBUF-           !
29820          JSB =GTSTR            !
29830          JZR OUTETX            !
29840          JSB =FXBUF0           !
29850 OUTETX   LDM R26,=ETX+         !
29860          JSB =FXBUF-           !
29870          JSB =GTORG            !
29880          JEZ JSBP24            !
29890          JSB =PUCPPO           !
29900          CLM R#                !
29910          JSB =PUTFDC           !
29920          JSB =PUTCM            !
29930          BCD                   !
29940          JSB =CHSROI           !
29950          POMD R#,-R#           !
29960          JSB =P30OUT           !
29970 JSBP24   JSB =P24              !
29980          GTO C34EX             !
29990 !
30000 FXBUF-   LDM R36,=2,0          !
30010 FXBUF0   PUMD R#,+R12          !
30020          PUMD R26,+R12         !
30030          JSB =PLSND            !
30040          JSB =FILOPN           !
30050          RTN                   !
30060 !
30070 PUCPPO   JSB =ROMRES           !
30080          LDM R53,=120,125,73,103,120 !
30090          PUMD R53,+R30         !
30100          POMD R40,-R12         !
30110 L7A64    RTN                   !
30120 !
30130 GTORG    BIN                   !
30140          JSB =GTSTR            !
30150          LDBD R23,=ROUTE       !
30160          CMB R23,=3            !
30170          JNZ GTRGO             !
30180          DCM R36               !
30190 GTRGO    CLE                   !
30200          LDBD R23,X#,GFLAG     !
30210          LRB R23               !
30220          LRB R23               !
30230          LRB R23               !
30240          ANM R23,=17           !
30250          DCB R23               !
30260          JZR L7A64             !
30270          CLM R40               !
30280          LDB R22,R23           !
30290 GTYLUP   SBB R#,=3             !
30300          TSB R#                !
30310          JPS GTYLUP            !
30320          ADB R#,=3             !
30330          JZR GOTY              !
30340          LDB R40,=231          !
30350          STB R40,R41           !
30360          LDB R47,=45           !
30370          DCB R22               !
30380          JZR GOTY              !
30390          LDB R47,=120          !
30400 GOTY     PUMD R40,+R12         !
30410          CLM R40               !
30420          CMB R23,=3            !
30430          JNC GOTX+             !
30440          TCM R36               !
30450          JSB =CONBIN           !
30460          PUMD R40,+R12         !
30470          BIN                   !
30480          CMB R23,=6            !
30490          DRP R40               !
30500          JNC GOTX-             !
30510          JSB =ADD1/6           !
30520          JMP ADD1/6            !
30530 !
30540 GOTX-    CLM R#                !
30550          LDB R47,=40           !
30560          JSB =PUDIVR           !
30570 ADD1/6   LDM R#,=231,220,147,146,146,146,146,26 !
30580          JSB =PUADPO           !
30590 GOTX+    PUMD R40,+R#          !
30600          CLE                   !
30610          ICE                   !
30620          RTN                   !
30630 !
30640 LB       ASC "LB"              !
30650 !
30660 ETX+     BYT 15,3              ! CR, ETX
30670 !
30680 GTSTR    LDMD R26,X14,GLBADD   !
30690          LDMD R36,X14,GLBLEN   !
30700          RTN                   !
30710 !
30720 C34EX    JSB =UPDAT            !
30730          JSB =UPDOR            !
30740          RTN                   !
30750 !
30760 ROMRES   BIN                   !
30770          LDMD R30,=RESDAT      !
30780          DRP R46               !
30790          RTN                   !
30800 !
30830          FIN 
