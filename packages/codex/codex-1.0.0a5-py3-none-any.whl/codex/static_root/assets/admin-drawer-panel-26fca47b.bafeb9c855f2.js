import{m as I,u as m,a as S,_ as h,o as s,c as p,V as T,b as _,d as L,e as c,f as B,g as a,w as t,h as y,i as V,j as f,k as o,t as d,F as C,r as $,l as b,n as O,p as g,q as k,s as P,v as w,x as F,y as M,z as N,A as j,B as x,C as z,D,E}from"./admin-bb5000e7.js";const U={name:"AdminSettingsButtonProgress",computed:{...I(m,["librarianStatuses"]),progressEnabled:function(){return this.librarianStatuses.length>0},progress:function(){let e=0,r=0;if(!(!this.librarianStatuses||this.librarianStatuses.length===0)){for(const i of this.librarianStatuses){if(i.total===null||i.total===void 0||i.complete===void 0)return;e+=+i.complete,r+=+i.total}if(!(r<=0))return 100*e/r}}},created(){this.loadTable("LibrarianStatus")},methods:{...S(m,["loadTable"])}};function q(e,r,i,v,u,l){return l.progressEnabled?(s(),p(T,{key:0,indeterminate:l.progress==null,"model-value":l.progress,class:"progress",size:"36","aria-label":"`Librarian tasks in progress ${Math.round(progress)}%`"},null,8,["indeterminate","model-value"])):_("",!0)}const G=h(U,[["render",q],["__scopeId","data-v-8db54809"]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));const R={name:"AdminStatusList",data(){return{mdiCloseCircleOutline:L}},computed:{...I(m,{librarianStatuses:e=>e.librarianStatuses,show:e=>e.librarianStatuses.length>0})},created(){this.load()},methods:{...S(m,["loadTable","librarianTask"]),indeterminate:e=>!e.preactive&&+e.total==0,progress(e){return e.preactive||+e.total==0?0:100*+e.complete/+e.total},load(){this.loadTable("LibrarianStatus")},clear(){this.librarianTask("librarian_clear_status","")}}},W=e=>(P("data-v-89ffc8fa"),e=e(),w(),e),H={key:0},J=W(()=>b("h4",null,"Librarian Tasks",-1)),K={nav:"",class:"statusItem"},Q={class:"statusItemTitle"},X={key:0};function Y(e,r,i,v,u,l){return s(),c(C,null,[e.show?(s(),p(B,{key:0})):_("",!0),a(k,{onClick:l.load},{default:t(()=>[a(y,null,{default:t(()=>[e.show?(s(),c("div",H,[a(V,{id:"clearButton",size:"small",icon:"",title:"Clear Librarian Statuses",onClick:l.clear},{default:t(()=>[a(f,null,{default:t(()=>[o(d(u.mdiCloseCircleOutline),1)]),_:1})]),_:1},8,["onClick"]),J,(s(!0),c(C,null,$(e.librarianStatuses,n=>(s(),p(y,{key:`${n.type} ${n.name}`},{default:t(()=>[b("div",K,[b("div",Q,[o(d(n.type)+" "+d(n.name)+" ",1),+n.total?(s(),c("span",X,d(n.complete)+"/"+d(n.total),1)):_("",!0)]),a(O,{indeterminate:l.indeterminate(n),"model-value":l.progress(n),bottom:""},null,8,["indeterminate","model-value"])])]),_:2},1024))),128))])):(s(),p(g,{key:1,id:"noTasksRunning"},{default:t(()=>[o(" No librarian tasks running ")]),_:1}))]),_:1})]),_:1},8,["onClick"])],64)}const Z=h(R,[["render",Y],["__scopeId","data-v-89ffc8fa"]]);const ee={name:"AdminMenu",components:{AdminStatusList:Z},props:{menu:{type:Boolean,default:!0}},data(){return{mdiBookAlert:F,mdiOpenInNew:M,mdiDatabaseClockOutline:N,mdiCogOutline:j}},computed:{...x(z,["isUserAdmin"]),...D(m,{unseenFailedImports:e=>e.unseenFailedImports})},methods:{...S(m,["clearFailedImports","librarianTask"])}},te={key:0},ae={key:0};function ne(e,r,i,v,u,l){const n=E("AdminStatusList");return e.isUserAdmin?(s(),c("div",te,[i.menu?(s(),c("div",ae,[a(k,{onClick:r[0]||(r[0]=A=>e.librarianTask("poll"))},{default:t(()=>[a(g,null,{default:t(()=>[a(f,null,{default:t(()=>[o(d(u.mdiDatabaseClockOutline),1)]),_:1}),o("Poll All Libraries")]),_:1})]),_:1}),a(k,{to:{name:"admin"},onClick:r[1]||(r[1]=A=>e.unseenFailedImports=!1)},{default:t(()=>[a(g,null,{default:t(()=>[a(f,null,{default:t(()=>[o(d(u.mdiCogOutline),1)]),_:1}),o("Admin Panel "),e.unseenFailedImports?(s(),p(f,{key:0,id:"failedImportsIcon",title:"New Failed Imports"},{default:t(()=>[o(d(u.mdiBookAlert),1)]),_:1})):_("",!0)]),_:1})]),_:1})])):_("",!0),a(n)])):_("",!0)}const se=h(ee,[["render",ne],["__scopeId","data-v-5a4646ff"]]),le=Object.freeze(Object.defineProperty({__proto__:null,default:se},Symbol.toStringTag,{value:"Module"}));export{G as _,ie as a,le as b};
