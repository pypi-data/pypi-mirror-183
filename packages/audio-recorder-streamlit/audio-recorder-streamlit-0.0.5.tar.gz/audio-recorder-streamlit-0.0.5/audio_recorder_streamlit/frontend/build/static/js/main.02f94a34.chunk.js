/*! For license information please see main.02f94a34.chunk.js.LICENSE.txt */
(this.webpackJsonpstreamlit_component_template=this.webpackJsonpstreamlit_component_template||[]).push([[0],{15:function(t,e,r){t.exports=r(22)},22:function(t,e,r){"use strict";r.r(e);var n=r(6),o=r.n(n),a=r(13),i=r.n(a),c=r(4),u=r(0),s=r(1),l=r(7),f=r(2),h=r(3),p=r(11),d=function(t){var e=t.onClick,r=t.fillColor,n=void 0===r?"white":r,a=t.color,i=void 0===a?"#6416FF":a,c=t.radius,u=void 0===c?"0":c;return o.a.createElement("svg",{width:"97",height:"97",viewBox:"0 0 97 97",fill:"none",xmlns:"http://www.w3.org/2000/svg"},o.a.createElement("circle",{cx:"48.5",cy:"48.5",r:u,fill:"#DCDCDC"}),o.a.createElement("circle",{cx:"49",cy:"49",r:"33",fill:i,onClick:e}),o.a.createElement("g",{clipPath:"url(#clip0)"},o.a.createElement("path",{onClick:e,d:"M49 57.2066C53.4997 57.2066 57.1474 53.5324 57.1474 49V35.3224C57.1474 30.7899 53.4997 27.1158 49 27.1158C44.5003 27.1158 40.8526 30.7899 40.8526 35.3224V49C40.8526 53.5324 44.5003 57.2066 49 57.2066ZM62.579 43.5289H61.2211C60.4708 43.5289 59.8632 44.141 59.8632 44.8967V49C59.8632 55.3943 54.39 60.5251 47.9145 59.8891C42.2708 59.3343 38.1369 54.224 38.1369 48.5127V44.8967C38.1369 44.141 37.5292 43.5289 36.779 43.5289H35.4211C34.6708 43.5289 34.0632 44.141 34.0632 44.8967V48.3298C34.0632 55.9927 39.4922 62.8238 46.9632 63.8616V66.7809H42.2105C41.4603 66.7809 40.8526 67.393 40.8526 68.1487V69.5164C40.8526 70.2721 41.4603 70.8842 42.2105 70.8842H55.7895C56.5397 70.8842 57.1474 70.2721 57.1474 69.5164V68.1487C57.1474 67.393 56.5397 66.7809 55.7895 66.7809H51.0369V63.8941C58.3109 62.8888 63.9369 56.5996 63.9369 49V44.8967C63.9369 44.141 63.3292 43.5289 62.579 43.5289Z",fill:n})),o.a.createElement("defs",null,o.a.createElement("clipPath",{id:"clip0"},o.a.createElement("rect",{width:"29.8737",height:"43.7684",fill:"white",transform:"translate(34.0632 27.1158)"}))))};function g(){g=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},o=n.iterator||"@@iterator",a=n.asyncIterator||"@@asyncIterator",i=n.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(O){c=function(t,e,r){return t[e]=r}}function u(t,e,r,n){var o=e&&e.prototype instanceof f?e:f,a=Object.create(o.prototype),i=new L(n||[]);return a._invoke=function(t,e,r){var n="suspendedStart";return function(o,a){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw a;return k()}for(r.method=o,r.arg=a;;){var i=r.delegate;if(i){var c=b(i,r);if(c){if(c===l)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var u=s(t,e,r);if("normal"===u.type){if(n=r.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(n="completed",r.method="throw",r.arg=u.arg)}}}(t,r,i),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(O){return{type:"throw",arg:O}}}t.wrap=u;var l={};function f(){}function h(){}function p(){}var d={};c(d,o,(function(){return this}));var v=Object.getPrototypeOf,y=v&&v(v(C([])));y&&y!==e&&r.call(y,o)&&(d=y);var m=p.prototype=f.prototype=Object.create(d);function w(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function x(t,e){var n;this._invoke=function(o,a){function i(){return new e((function(n,i){!function n(o,a,i,c){var u=s(t[o],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){n("next",t,i,c)}),(function(t){n("throw",t,i,c)})):e.resolve(f).then((function(t){l.value=t,i(l)}),(function(t){return n("throw",t,i,c)}))}c(u.arg)}(o,a,n,i)}))}return n=n?n.then(i,i):i()}}function b(t,e){var r=t.iterator[e.method];if(void 0===r){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=void 0,b(t,e),"throw"===e.method))return l;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var n=s(r,t.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,l;var o=n.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,l):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,l)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function E(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function L(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function C(t){if(t){var e=t[o];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,a=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return a.next=a}}return{next:k}}function k(){return{value:void 0,done:!0}}return h.prototype=p,c(m,"constructor",p),c(p,"constructor",h),h.displayName=c(p,i,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===h||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,c(t,i,"GeneratorFunction")),t.prototype=Object.create(m),t},t.awrap=function(t){return{__await:t}},w(x.prototype),c(x.prototype,a,(function(){return this})),t.AsyncIterator=x,t.async=function(e,r,n,o,a){void 0===a&&(a=Promise);var i=new x(u(e,r,n,o),a);return t.isGeneratorFunction(r)?i:i.next().then((function(t){return t.done?t.value:i.next()}))},w(m),c(m,i,"Generator"),c(m,o,(function(){return this})),c(m,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=[];for(var r in t)e.push(r);return e.reverse(),function r(){for(;e.length;){var n=e.pop();if(n in t)return r.value=n,r.done=!1,r}return r.done=!0,r}},t.values=C,L.prototype={constructor:L,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return i.type="throw",i.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],i=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var c=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(c&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(c){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var a=o;break}}a&&("break"===t||"continue"===t)&&a.tryLoc<=e&&e<=a.finallyLoc&&(a=null);var i=a?a.completion:{};return i.type=t,i.arg=e,a?(this.method="next",this.next=a.finallyLoc,l):this.complete(i)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),l},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),E(r),l}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;E(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:C(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),l}},t}var v=function(t){Object(f.a)(r,t);var e=Object(h.a)(r);function r(){var t;Object(s.a)(this,r);for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];return(t=e.call.apply(e,[this].concat(a))).state={color:"#303030"},t.stream=null,t.AudioContext=window.AudioContext||window.webkitAudioContext,t.type="audio/wav",t.sampleRate=null,t.phrase_buffer_count=null,t.pause_buffer_count=null,t.pause_count=0,t.pause_threshold=.8,t.energy_threshold=.01,t.stage=null,t.volume=null,t.audioInput=null,t.analyser=null,t.recorder=null,t.recording=!1,t.leftchannel=[],t.rightchannel=[],t.leftBuffer=null,t.rightBuffer=null,t.recordingLength=0,t.tested=!1,t.getStream=function(){return navigator.mediaDevices.getUserMedia({audio:!0,video:!1})},t.setupMic=Object(c.a)(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.getStream();case 3:window.stream=t.stream=e.sent,e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),console.log("Error: Issue getting mic",e.t0);case 9:t.startRecording();case 10:case"end":return e.stop()}}),e,null,[[0,6]])}))),t.closeMic=function(){t.stream.getAudioTracks().forEach((function(t){t.stop()})),t.audioInput.disconnect(0),t.analyser.disconnect(0),t.recorder.disconnect(0)},t.writeUTFBytes=function(t,e,r){for(var n=r.length,o=0;o<n;o++)t.setUint8(e+o,r.charCodeAt(o))},t.mergeBuffers=function(t,e){for(var r=new Float32Array(e),n=0,o=t.length,a=0;a<o;a++){var i=t[a];r.set(i,n),n+=i.length}return r},t.interleave=function(t,e){for(var r=t.length+e.length,n=new Float32Array(r),o=0,a=0;a<r;)n[a++]=t[o],n[a++]=e[o],o++;return n},t.startRecording=function(){t.context=new t.AudioContext,t.sampleRate=t.context.sampleRate;var e=2048/t.sampleRate;t.pause_buffer_count=Math.ceil(t.pause_threshold/e),t.pause_count=0,t.stage="start",t.volume=t.context.createGain(),t.audioInput=t.context.createMediaStreamSource(t.stream),t.analyser=t.context.createAnalyser(),t.audioInput.connect(t.analyser),t.recorder=t.context.createScriptProcessor(2048,2,2),t.analyser.connect(t.recorder),t.recorder.connect(t.context.destination);var r=Object(l.a)(t);t.recorder.onaudioprocess=function(t){if(r.recording){var e=t.inputBuffer.getChannelData(0),n=t.inputBuffer.getChannelData(1);r.tested||(r.tested=!0,e.reduce((function(t,e){return t+e}))||(console.log("Error: There seems to be an issue with your Mic"),r.stop(),r.stream.getTracks().forEach((function(t){t.stop()})),r.context.close()));var o=Math.sqrt(e.map((function(t){return t*t})).reduce((function(t,e){return t+e}))/e.length);"start"===r.stage&&o>r.energy_threshold?r.stage="speaking":"speaking"===r.stage&&(o>r.energy_threshold?r.pause_count=0:(r.pause_count+=1,r.pause_count>r.pause_buffer_count&&r.stop())),r.leftchannel.push(new Float32Array(e)),r.rightchannel.push(new Float32Array(n)),r.recordingLength+=2048}}},t.start=Object(c.a)(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.recording=!0,t.setState({color:"#de1212"}),e.next=4,t.setupMic();case 4:t.leftchannel.length=t.rightchannel.length=0,t.recordingLength=0;case 6:case"end":return e.stop()}}),e)}))),t.stop=Object(c.a)(g().mark((function e(){var r,n,o,a,i,c,u,s;return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t.recording=!1,t.setState({color:"#303030"}),t.closeMic(),console.log(t.recordingLength),t.leftBuffer=t.mergeBuffers(t.leftchannel,t.recordingLength),t.rightBuffer=t.mergeBuffers(t.rightchannel,t.recordingLength),r=t.interleave(t.leftBuffer,t.rightBuffer),n=new ArrayBuffer(44+2*r.length),o=new DataView(n),t.writeUTFBytes(o,0,"RIFF"),o.setUint32(4,44+2*r.length,!0),t.writeUTFBytes(o,8,"WAVE"),t.writeUTFBytes(o,12,"fmt "),o.setUint32(16,16,!0),o.setUint16(20,1,!0),o.setUint16(22,2,!0),o.setUint32(24,t.sampleRate,!0),o.setUint32(28,4*t.sampleRate,!0),o.setUint16(32,4,!0),o.setUint16(34,16,!0),t.writeUTFBytes(o,36,"data"),o.setUint32(40,2*r.length,!0),a=r.length,i=44,1,c=0;c<a;c++)o.setInt16(i,32767*r[c],!0),i+=2;return u=new Blob([o],{type:t.type}),s=URL.createObjectURL(u),e.next=30,t.onStop({blob:u,url:s,type:t.type});case 30:case"end":return e.stop()}}),e)}))),t.render=function(){t.props.theme;var e=t.props.args.text;return t.pause_threshold=t.props.args.pause_threshold,t.energy_threshold=t.props.args.energy_threshold,o.a.createElement("span",null,e," \xa0",o.a.createElement(d,{onClick:t.onClicked,color:"white",fillColor:t.state.color}))},t.onClicked=Object(c.a)(g().mark((function e(){return g().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.recording){e.next=5;break}return e.next=3,t.start();case 3:e.next=7;break;case 5:return e.next=7,t.stop();case 7:case"end":return e.stop()}}),e)}))),t.onStop=function(){var t=Object(c.a)(g().mark((function t(e){var r,n;return g().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.blob.arrayBuffer();case 2:r=t.sent,n=JSON.stringify(Array.from(new Uint8Array(r))),p.a.setComponentValue(n);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),t}return Object(u.a)(r)}(p.b),y=Object(p.c)(v);i.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(y,null)),document.getElementById("root"))}},[[15,1,2]]]);
//# sourceMappingURL=main.02f94a34.chunk.js.map