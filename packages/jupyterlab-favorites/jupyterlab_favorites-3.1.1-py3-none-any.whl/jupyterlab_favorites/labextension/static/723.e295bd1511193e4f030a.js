"use strict";(self.webpackChunk_jlab_enhanced_favorites=self.webpackChunk_jlab_enhanced_favorites||[]).push([[723],{723:(e,t,i)=>{i.r(t),i.d(t,{default:()=>x});var a=i(813),s=i(634),r=i(600),o=i(918),n=i(740),l=i(544),c=i(840),v=i(271);const h=new l.LabIcon({name:"jupyterlab-favorites:filledStar",svgstr:'<svg\n  xmlns="http://www.w3.org/2000/svg"\n  viewBox="0 0 24 24"\n>\n  <path\n    d="M0 0h24v24H0z"\n    fill="none"\n  />\n  \x3c!-- The "fill" property has been modified from the original --\x3e\n  <path class="jp-icon3"  fill="rgb(97,97,97)"\n    d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"\n  />\n  <path\n    d="M0 0h24v24H0z"\n    fill="none"\n  />\n</svg>'}),d=new l.LabIcon({name:"jupyterlab-favorites:star",svgstr:'<svg\n  xmlns="http://www.w3.org/2000/svg"\n  viewBox="0 0 24 24"\n>\n  \x3c!-- The "fill" property has been modified from the original --\x3e\n  <path class="jp-icon3"  fill="rgb(97,97,97)"\n    d="M22 9.24l-7.19-.62L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21 12 17.27 18.18 21l-1.63-7.03L22 9.24zM12 15.4l-3.76 2.27 1-4.28-3.32-2.88 4.38-.38L12 6.1l1.71 4.04 4.38.38-3.32 2.88 1 4.28L12 15.4z"\n  />\n  <path\n    d="M0 0h24v24H0z"\n    fill="none"\n  />\n</svg>'});function g(e){return e?h:d}function m(e){let t="";const i=e.split("/");return i.length>0&&(t=i[i.length-1]),t}function f(e){return(e?"Remove":"Add")+" Favorite"}function u(e,t){return e.endsWith("/")&&(e=e.slice(0,-1)),t.endsWith("/")&&(t=t.slice(1)),`${e}/${t}`}const p=e=>{const{favorite:t,handleClick:i}=e;let a,s=m(t.path);return t.name&&(s=t.name),a=t.iconLabel?l.LabIcon.resolve({icon:t.iconLabel}):"directory"===t.contentType?l.folderIcon:l.fileIcon,v.createElement("div",{className:"jp-Favorites-item",title:u(t.root,t.path),onClick:e=>{i(t)}},v.createElement(a.react,{className:"jp-Favorites-itemIcon",tag:"span"}),v.createElement("span",{className:"jp-Favorites-itemText"},s))},F=e=>{if(e.currentPath){const t=g(e.manager.hasFavorite(e.currentPath));return v.createElement("div",{className:"jp-Favorites-pinner",title:f(e.manager.hasFavorite(e.currentPath)),onClick:t=>e.handleClick(e.currentPath)},v.createElement(t.react,{className:"jp-Favorites-BreadCrumbs-Icon",tag:"span"}))}return null};class b extends n.ReactWidget{constructor(e,t){super(),this.pathChanged=new c.Signal(this),this.manager=e,this.filebrowser=t,this.addClass("jp-Favorites"),this.filebrowser.model.pathChanged.connect(((e,t)=>{const i=t.newValue;this.pathChanged.emit(i)}))}handlePinnerClick(e){if(this.manager.hasFavorite(e))this.manager.removeFavorite(e);else{const t={root:this.manager.serverRoot,contentType:"directory",iconLabel:l.folderIcon.name,path:e};this.manager.addFavorite(t)}}render(){return v.createElement(n.UseSignal,{signal:this.manager.favoritesChanged,initialSender:this.manager,initialArgs:this.manager.visibleFavorites()},((e,t)=>v.createElement("div",null,v.createElement(n.UseSignal,{signal:e.visibilityChanged,initialSender:e,initialArgs:e.isVisible()},((e,i)=>i&&v.createElement(v.Fragment,null,v.createElement("div",{className:"jp-Favorites-header"},"Favorites"),v.createElement("div",{className:"jp-Favorites-container"},t.map((t=>v.createElement(p,{key:`favorites-item-${t.path}`,favorite:t,handleClick:e.handleClick.bind(e)})))),v.createElement("div",{className:"jp-FileBrowser-header"},"File Browser")))),v.createElement(n.UseSignal,{signal:this.pathChanged,initialSender:this,initialArgs:this.filebrowser.model.path},((e,t)=>v.createElement(F,{currentPath:t,handleClick:e.handlePinnerClick,manager:e.manager}))))))}}var y,w,C,R=i(992);!function(e){e.favorites="jupyterlab-favorites"}(y||(y={})),function(e){e.addOrRemoveFavorite=`${y.favorites}:add-or-remove-favorite`,e.removeFavorite=`${y.favorites}:remove-favorite`,e.openFavorite=`${y.favorites}:open-favorite`,e.toggleFavoritesWidget=`${y.favorites}:toggle-favorites-widget`,e.restoreDefaults=`${y.favorites}:restore-defaults`,e.clearFavorites=`${y.favorites}:clear-favorites`}(w||(w={})),function(e){e.themes="@jupyterlab/apputils-extension:themes",e.favorites="@jlab-enhanced/favorites:favorites"}(C||(C={}));class _{constructor(e,t,i,a){this.favoritesChanged=new c.Signal(this),this.visibilityChanged=new c.Signal(this),this._showWidget=!0,this._serverRoot=e,this._commandRegistry=t,this._settingsRegistry=i,this._contentsManager=a,this.favoritesMenu=new R.Menu({commands:this._commandRegistry}),this.favoritesMenu.title.label="Favorites",this._settingsRegistry.pluginChanged.connect((async(e,t)=>{t===C.favorites&&this.loadFavorites()})),this.favoritesChanged.connect((async e=>{this._showWidget=await this.loadShowWidget(),this.syncFavoritesMenu(),this.visibilityChanged.emit(this.isVisible())}))}get serverRoot(){return this._serverRoot}get favorites(){return(this._favorites||[]).filter((e=>e.root===this.serverRoot))}set favorites(e){this._favorites=e,this.favoritesChanged.emit(this.visibleFavorites())}async addFavorite(e){const t=this._favorites.slice(),i=t.findIndex((t=>t.root===this.serverRoot&&t.path===e.path)),a=t[i];a?a.hidden&&(a.hidden=!1,this.saveSettings({favorites:t})):this.saveSettings({favorites:t.concat([e])})}clearFavorites(){this.clearFavoritesOrRestoreDefaults(!0)}init(){this.loadFavorites()}isVisible(){return this._showWidget&&this.visibleFavorites().length>0}hasFavorite(e){return this.visibleFavorites().findIndex((t=>t.path===e))>=0}handleClick(e){this._commandRegistry.execute(w.openFavorite,{favorite:e})}async overwriteSettings(e){const t=JSON.stringify(e,null,4);this._settingsRegistry.upload(C.favorites,t)}async removeFavorite(e){const t=this._favorites.slice(),i=t.findIndex((t=>t.root===this.serverRoot&&t.path===e)),a=t[i];a&&(a.default?a.hidden=!0:t.splice(i,1),this.saveSettings({favorites:t}))}async removeFavoriteIfInvalid(e){this._contentsManager.get(e.path,{content:!1}).catch((t=>{404===t.response.status&&this.removeFavorite(e.path)}))}restoreDefaults(){this.clearFavoritesOrRestoreDefaults(!1)}async saveSettings(e){void 0!==e.favorites&&await this._settingsRegistry.set(C.favorites,"favorites",e.favorites),void 0!==e.showWidget&&this._settingsRegistry.set(C.favorites,"showWidget",e.showWidget)}visibleFavorites(){return this.favorites.filter((e=>!e.hidden)).sort(((e,t)=>e.contentType===t.contentType?m(e.path)<=m(t.path)?-1:1:e.contentType<t.contentType?-1:1))}clearFavoritesOrRestoreDefaults(e){const t=this._favorites,i=[];t.forEach((t=>{t.default&&(t.hidden=e,i.push(t))})),this.overwriteSettings({favorites:i})}async loadFavorites(){const e=await this._settingsRegistry.get(C.favorites,"favorites");this.favorites=e.composite}async loadShowWidget(){return(await this._settingsRegistry.get(C.favorites,"showWidget")).composite}syncFavoritesMenu(){this.favoritesMenu.clearItems();const e=this.visibleFavorites();e.length>0&&(e.forEach((e=>{this.favoritesMenu.addItem({command:w.openFavorite,args:{favorite:e}})})),this.favoritesMenu.addItem({type:"separator"}));const t=this._showWidget;this.favoritesMenu.addItem({command:w.toggleFavoritesWidget,args:{showWidget:t}}),this.favoritesMenu.addItem({command:w.restoreDefaults}),this.favoritesMenu.addItem({command:w.clearFavorites})}}var M=i(15);const x={id:y.favorites,autoStart:!0,requires:[a.IFileBrowserFactory,r.ISettingRegistry],optional:[s.IMainMenu],activate:async(e,t,i,a)=>{console.log("JupyterLab extension jupyterlab-favorites is activated!");const s=e.docRegistry,r=t.defaultBrowser,n=r.layout,{commands:l,serviceManager:c}=e,v=new _(M.PageConfig.getOption("serverRoot")||"Jupyter Server Root",l,i,c.contents);v.init();const h=new b(v,r);let m=0;n.widgets.forEach(((e,t)=>{e.node.className.includes("jp-FileBrowser-toolbar")&&(m=t+1)})),n.insertWidget(m,h);const p=()=>{const e=F.currentWidget;return e?(0,o.toArray)(e.selectedItems()):[]},{tracker:F}=t;l.addCommand(w.addOrRemoveFavorite,{execute:()=>{const e=p();if(e.length>0){const t=e[0];if(v.hasFavorite(t.path))v.removeFavorite(t.path);else{const e=s.getFileTypeForModel(t);v.addFavorite({root:v.serverRoot,path:t.path,contentType:e.contentType,iconLabel:e.icon.name})}}},isVisible:()=>1===p().length,icon:()=>{const e=p()[0];return g(!v.hasFavorite(e.path))},label:()=>{const e=p()[0];return f(v.hasFavorite(e.path))}}),e.contextMenu.addItem({command:w.addOrRemoveFavorite,selector:".jp-DirListing-item[data-isdir]",rank:3}),l.addCommand(w.removeFavorite,{execute:()=>{let t=e.contextMenuHitTest((e=>e.classList.contains("jp-Favorites-item"))).getAttribute("title").replace(v.serverRoot,"");t.startsWith("/")&&(t=t.slice(1)),v.removeFavorite(t)},icon:d,label:"Remove Favorite"}),e.contextMenu.addItem({command:w.removeFavorite,selector:".jp-Favorites-item",rank:0}),a&&a.fileMenu.addGroup([{type:"submenu",submenu:v.favoritesMenu}],1);try{const e=a.fileMenu._groups;let t=0,i=-1;for(let a=0;a<e.length;a++)1===e[a].rank&&(t+=1,i<0&&(i=a));if(2===t){const t=e[i];t.size=t.size+1,e.splice(i+1,1);const s=a.fileMenu.menu,r=s._items;let o=!1;for(let e=r.length-1;e>0;e--){const t=r[e];if("filebrowser:open-path"===t.command)break;o&&"separator"===t.type?s.removeItemAt(e):"submenu"===t.type&&"Favorites"===t.submenu.title.label&&(o=!0)}}}catch(e){console.log(e)}l.addCommand(w.openFavorite,{execute:async e=>{const t=e.favorite,i=""===t.path?"/":t.path;await l.execute("filebrowser:open-path",{path:i})},label:e=>{const t=e.favorite;return u(t.root,t.path)}}),l.addCommand(w.toggleFavoritesWidget,{execute:async e=>{const t=e.showWidget;v.saveSettings({showWidget:!t})},label:e=>(e.showWidget?"Hide":"Show")+" Favorites Widget",isVisible:()=>v.visibleFavorites().length>0}),l.addCommand(w.restoreDefaults,{execute:()=>v.restoreDefaults(),label:"Restore Defaults"}),l.addCommand(w.clearFavorites,{execute:()=>v.clearFavorites(),label:"Clear Favorites"})}}}}]);